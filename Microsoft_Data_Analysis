{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "![example](images/director_shot.jpeg)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Microsoft Movie Studio Data Analysis and Recommendations\n",
    "\n",
    "**Author:** Alexis Kedo\n",
    "***"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Overview\n",
    "\n",
    "This project analyzes selected characteristics of movies produced from 2010 onward, in order to provide a set of recommendations to guide the actions of a corporation, Microsoft, in its goal to open a movie production studio. The data comes from the [Internet Movie Database (IMDB)](https://www.imdb.com/interfaces/), [The Numbers](https://www.the-numbers.com/), [Box Office Mojo](https://www.boxofficemojo.com/), [The Movie Database](https://www.themoviedb.org/?language=en-US), and [Rotten Tomatoes](https://www.rottentomatoes.com/), courtesy of [Flatiron School](https://flatironschool.com/). Descriptive analysis of film release and earnings data shows that a film's popularity varies seasonally and that Microsoft should limit its production efforts to a few genres in order to maximize profitability. Furthermore, a sampling and analysis of most popular actors shows that Microsoft should concentrate their hiring on a select pool of actors who are relatively likely to maximize return on investment. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Business Problem\n",
    "\n",
    "As a novice entree into the film production industry, Microsoft faces steep competition from a host of more established firms, includng Netflix, Amazon, and Hulu. In addition, Microsoft's primary software competitor, Apple, has been producing its own feature-length content since [2019](https://www.nytimes.com/2019/09/27/business/media/apple-movie-theaters.html). In order to produce movies that can stand up to the output of its competitors, Microsoft will likely need to expend billions in start-up costs, which makes its initial investment decisions especially important. Amazon spent [5 billion dollars](https://www.nasdaq.com/articles/does-amazon-profit-its-original-tv-shows-movies-2018-03-15) on \"original programming\" \n",
    "in 2018, while Netflix spend $8 billion. \n",
    "\n",
    "While most pre-production costs (e.g. insurance, equipment rental, crew staffing costs) are more or less fixed, \"above-the-line\"  (i.e. creative) costs can vary widely. As actor salaries constitute [a significant](https://www.forbes.com/sites/schuylermoore/2019/04/13/the-importance-of-film-budgets/?sh=2df1507727f5) portion, it makes sense to concentrate part of this analysis on on-screen talent. Release month is also a major decision point around which there has been [some](https://www.newyorker.com/magazine/2015/02/23/rethinking-seasonal-strategy) questioning of the traditional strategy of releasing blockbusters over the summer and prestige films prior to awards season. Finally, the all-important question of what genres will generate the most return on investment is a debate that [continues](https://grayll.medium.com/the-most-profitable-film-genres-e91d5fb4cfa5) to [rage](https://www.mentalfloss.com/article/68552/20-most-profitable-movies-all-time-based-return-investment). For these reasons, I have concentrated my analysis on these three major areas. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Data Understanding\n",
    "As stated above, datasets were pulled from a variety of online sources. IMDB datasets were the most used files in this analysis and provide unique IDs for both movies and actors. IMDB files also supply various characteristics about movies (start year, genre) and actors (birth year, death year, average ratings per movie). The \"budgets\" dataset from The Numbers was also used to provide gross worldwide earnings information. The sample included movies released after 2010. Actor data was narrowed to include only actors born after 1940. \n",
    "\n",
    "The three main decision-making areas addressed by this project were release month, genre, and available actors. The target variables for anlysis were average popularity (used for both seasonality and actor analysis), average worldwide gross earnings (used for genre analysis), average ratings per movie (used for actor analysis), and net worth (used to create a scale to represent the approximate 'cost ' of hiring a particular actor). "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Import standard packages\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "sns.set()\n",
    "\n",
    "%matplotlib inline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Import and explore data. \n",
    "imdb_names = pd.read_csv('data/zippedData/imdb.name.basics.csv.gz')\n",
    "imdb_titles_basics = pd.read_csv('data/zippedData/imdb.title.basics.csv.gz')\n",
    "imdb_ratings = pd.read_csv('data/zippedData/imdb.title.ratings.csv.gz')\n",
    "budgets = pd.read_csv('data/zippedData/tn.movie_budgets.csv.gz')\n",
    "imdb_principals = pd.read_csv('data/zippedData/imdb.title.principals.csv.gz')\n",
    "moviedb_movies = pd.read_csv('data/zippedData/tmdb.movies.csv.gz')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>genre_ids</th>\n",
       "      <th>id</th>\n",
       "      <th>original_language</th>\n",
       "      <th>original_title</th>\n",
       "      <th>popularity</th>\n",
       "      <th>release_date</th>\n",
       "      <th>title</th>\n",
       "      <th>vote_average</th>\n",
       "      <th>vote_count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>[12, 14, 10751]</td>\n",
       "      <td>12444</td>\n",
       "      <td>en</td>\n",
       "      <td>Harry Potter and the Deathly Hallows: Part 1</td>\n",
       "      <td>33.533</td>\n",
       "      <td>2010-11-19</td>\n",
       "      <td>Harry Potter and the Deathly Hallows: Part 1</td>\n",
       "      <td>7.7</td>\n",
       "      <td>10788</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>[14, 12, 16, 10751]</td>\n",
       "      <td>10191</td>\n",
       "      <td>en</td>\n",
       "      <td>How to Train Your Dragon</td>\n",
       "      <td>28.734</td>\n",
       "      <td>2010-03-26</td>\n",
       "      <td>How to Train Your Dragon</td>\n",
       "      <td>7.7</td>\n",
       "      <td>7610</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>[12, 28, 878]</td>\n",
       "      <td>10138</td>\n",
       "      <td>en</td>\n",
       "      <td>Iron Man 2</td>\n",
       "      <td>28.515</td>\n",
       "      <td>2010-05-07</td>\n",
       "      <td>Iron Man 2</td>\n",
       "      <td>6.8</td>\n",
       "      <td>12368</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>[16, 35, 10751]</td>\n",
       "      <td>862</td>\n",
       "      <td>en</td>\n",
       "      <td>Toy Story</td>\n",
       "      <td>28.005</td>\n",
       "      <td>1995-11-22</td>\n",
       "      <td>Toy Story</td>\n",
       "      <td>7.9</td>\n",
       "      <td>10174</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>[28, 878, 12]</td>\n",
       "      <td>27205</td>\n",
       "      <td>en</td>\n",
       "      <td>Inception</td>\n",
       "      <td>27.920</td>\n",
       "      <td>2010-07-16</td>\n",
       "      <td>Inception</td>\n",
       "      <td>8.3</td>\n",
       "      <td>22186</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26512</th>\n",
       "      <td>26512</td>\n",
       "      <td>[27, 18]</td>\n",
       "      <td>488143</td>\n",
       "      <td>en</td>\n",
       "      <td>Laboratory Conditions</td>\n",
       "      <td>0.600</td>\n",
       "      <td>2018-10-13</td>\n",
       "      <td>Laboratory Conditions</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26513</th>\n",
       "      <td>26513</td>\n",
       "      <td>[18, 53]</td>\n",
       "      <td>485975</td>\n",
       "      <td>en</td>\n",
       "      <td>_EXHIBIT_84xxx_</td>\n",
       "      <td>0.600</td>\n",
       "      <td>2018-05-01</td>\n",
       "      <td>_EXHIBIT_84xxx_</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26514</th>\n",
       "      <td>26514</td>\n",
       "      <td>[14, 28, 12]</td>\n",
       "      <td>381231</td>\n",
       "      <td>en</td>\n",
       "      <td>The Last One</td>\n",
       "      <td>0.600</td>\n",
       "      <td>2018-10-01</td>\n",
       "      <td>The Last One</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26515</th>\n",
       "      <td>26515</td>\n",
       "      <td>[10751, 12, 28]</td>\n",
       "      <td>366854</td>\n",
       "      <td>en</td>\n",
       "      <td>Trailer Made</td>\n",
       "      <td>0.600</td>\n",
       "      <td>2018-06-22</td>\n",
       "      <td>Trailer Made</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26516</th>\n",
       "      <td>26516</td>\n",
       "      <td>[53, 27]</td>\n",
       "      <td>309885</td>\n",
       "      <td>en</td>\n",
       "      <td>The Church</td>\n",
       "      <td>0.600</td>\n",
       "      <td>2018-10-05</td>\n",
       "      <td>The Church</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>26517 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Unnamed: 0            genre_ids      id original_language  \\\n",
       "0               0      [12, 14, 10751]   12444                en   \n",
       "1               1  [14, 12, 16, 10751]   10191                en   \n",
       "2               2        [12, 28, 878]   10138                en   \n",
       "3               3      [16, 35, 10751]     862                en   \n",
       "4               4        [28, 878, 12]   27205                en   \n",
       "...           ...                  ...     ...               ...   \n",
       "26512       26512             [27, 18]  488143                en   \n",
       "26513       26513             [18, 53]  485975                en   \n",
       "26514       26514         [14, 28, 12]  381231                en   \n",
       "26515       26515      [10751, 12, 28]  366854                en   \n",
       "26516       26516             [53, 27]  309885                en   \n",
       "\n",
       "                                     original_title  popularity release_date  \\\n",
       "0      Harry Potter and the Deathly Hallows: Part 1      33.533   2010-11-19   \n",
       "1                          How to Train Your Dragon      28.734   2010-03-26   \n",
       "2                                        Iron Man 2      28.515   2010-05-07   \n",
       "3                                         Toy Story      28.005   1995-11-22   \n",
       "4                                         Inception      27.920   2010-07-16   \n",
       "...                                             ...         ...          ...   \n",
       "26512                         Laboratory Conditions       0.600   2018-10-13   \n",
       "26513                               _EXHIBIT_84xxx_       0.600   2018-05-01   \n",
       "26514                                  The Last One       0.600   2018-10-01   \n",
       "26515                                  Trailer Made       0.600   2018-06-22   \n",
       "26516                                    The Church       0.600   2018-10-05   \n",
       "\n",
       "                                              title  vote_average  vote_count  \n",
       "0      Harry Potter and the Deathly Hallows: Part 1           7.7       10788  \n",
       "1                          How to Train Your Dragon           7.7        7610  \n",
       "2                                        Iron Man 2           6.8       12368  \n",
       "3                                         Toy Story           7.9       10174  \n",
       "4                                         Inception           8.3       22186  \n",
       "...                                             ...           ...         ...  \n",
       "26512                         Laboratory Conditions           0.0           1  \n",
       "26513                               _EXHIBIT_84xxx_           0.0           1  \n",
       "26514                                  The Last One           0.0           1  \n",
       "26515                                  Trailer Made           0.0           1  \n",
       "26516                                    The Church           0.0           1  \n",
       "\n",
       "[26517 rows x 10 columns]"
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "moviedb_movies\n",
    "#This dataset, from the Movie Database, will be the foundation of the seasonality analysis for Analysis 1. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>primary_title</th>\n",
       "      <th>original_title</th>\n",
       "      <th>start_year</th>\n",
       "      <th>runtime_minutes</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>9599</th>\n",
       "      <td>tt1566491</td>\n",
       "      <td>Brainiacs in La La Land</td>\n",
       "      <td>Brainiacs in La La Land</td>\n",
       "      <td>2010</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43264</th>\n",
       "      <td>tt2578092</td>\n",
       "      <td>Fireplace for your Home: Crackling Fireplace w...</td>\n",
       "      <td>Fireplace for your Home: Crackling Fireplace w...</td>\n",
       "      <td>2010</td>\n",
       "      <td>61.0</td>\n",
       "      <td>Music</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11550</th>\n",
       "      <td>tt1634300</td>\n",
       "      <td>Role/Play</td>\n",
       "      <td>Role/Play</td>\n",
       "      <td>2010</td>\n",
       "      <td>85.0</td>\n",
       "      <td>Drama,Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11551</th>\n",
       "      <td>tt1634332</td>\n",
       "      <td>Johan1</td>\n",
       "      <td>Johan Primero</td>\n",
       "      <td>2010</td>\n",
       "      <td>78.0</td>\n",
       "      <td>Comedy,Drama,Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11552</th>\n",
       "      <td>tt1634334</td>\n",
       "      <td>Hands Up</td>\n",
       "      <td>Les mains en l'air</td>\n",
       "      <td>2010</td>\n",
       "      <td>90.0</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2948</th>\n",
       "      <td>tt10300396</td>\n",
       "      <td>Untitled Star Wars Film</td>\n",
       "      <td>Untitled Star Wars Film</td>\n",
       "      <td>2024</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52213</th>\n",
       "      <td>tt3095356</td>\n",
       "      <td>Avatar 4</td>\n",
       "      <td>Avatar 4</td>\n",
       "      <td>2025</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Action,Adventure,Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2949</th>\n",
       "      <td>tt10300398</td>\n",
       "      <td>Untitled Star Wars Film</td>\n",
       "      <td>Untitled Star Wars Film</td>\n",
       "      <td>2026</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96592</th>\n",
       "      <td>tt5637536</td>\n",
       "      <td>Avatar 5</td>\n",
       "      <td>Avatar 5</td>\n",
       "      <td>2027</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Action,Adventure,Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>89506</th>\n",
       "      <td>tt5174640</td>\n",
       "      <td>100 Years</td>\n",
       "      <td>100 Years</td>\n",
       "      <td>2115</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>146144 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           tconst                                      primary_title  \\\n",
       "9599    tt1566491                            Brainiacs in La La Land   \n",
       "43264   tt2578092  Fireplace for your Home: Crackling Fireplace w...   \n",
       "11550   tt1634300                                          Role/Play   \n",
       "11551   tt1634332                                             Johan1   \n",
       "11552   tt1634334                                           Hands Up   \n",
       "...           ...                                                ...   \n",
       "2948   tt10300396                            Untitled Star Wars Film   \n",
       "52213   tt3095356                                           Avatar 4   \n",
       "2949   tt10300398                            Untitled Star Wars Film   \n",
       "96592   tt5637536                                           Avatar 5   \n",
       "89506   tt5174640                                          100 Years   \n",
       "\n",
       "                                          original_title  start_year  \\\n",
       "9599                             Brainiacs in La La Land        2010   \n",
       "43264  Fireplace for your Home: Crackling Fireplace w...        2010   \n",
       "11550                                          Role/Play        2010   \n",
       "11551                                      Johan Primero        2010   \n",
       "11552                                 Les mains en l'air        2010   \n",
       "...                                                  ...         ...   \n",
       "2948                             Untitled Star Wars Film        2024   \n",
       "52213                                           Avatar 4        2025   \n",
       "2949                             Untitled Star Wars Film        2026   \n",
       "96592                                           Avatar 5        2027   \n",
       "89506                                          100 Years        2115   \n",
       "\n",
       "       runtime_minutes                    genres  \n",
       "9599               NaN                    Comedy  \n",
       "43264             61.0                     Music  \n",
       "11550             85.0             Drama,Romance  \n",
       "11551             78.0      Comedy,Drama,Romance  \n",
       "11552             90.0                     Drama  \n",
       "...                ...                       ...  \n",
       "2948               NaN                       NaN  \n",
       "52213              NaN  Action,Adventure,Fantasy  \n",
       "2949               NaN                   Fantasy  \n",
       "96592              NaN  Action,Adventure,Fantasy  \n",
       "89506              NaN                     Drama  \n",
       "\n",
       "[146144 rows x 6 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "imdb_titles_basics.sort_values(by=['start_year'],ascending=True)\n",
    "#This titles dataset will be the basis for the genre/profitability analysis (Analysis 2), \n",
    "#and is a mid-size dataset with 146,144 unique movies. \n",
    "#It includes only movies that started production after 2010. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>release_date</th>\n",
       "      <th>movie</th>\n",
       "      <th>production_budget</th>\n",
       "      <th>domestic_gross</th>\n",
       "      <th>worldwide_gross</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Dec 18, 2009</td>\n",
       "      <td>Avatar</td>\n",
       "      <td>$425,000,000</td>\n",
       "      <td>$760,507,625</td>\n",
       "      <td>$2,776,345,279</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>May 20, 2011</td>\n",
       "      <td>Pirates of the Caribbean: On Stranger Tides</td>\n",
       "      <td>$410,600,000</td>\n",
       "      <td>$241,063,875</td>\n",
       "      <td>$1,045,663,875</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Jun 7, 2019</td>\n",
       "      <td>Dark Phoenix</td>\n",
       "      <td>$350,000,000</td>\n",
       "      <td>$42,762,350</td>\n",
       "      <td>$149,762,350</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>May 1, 2015</td>\n",
       "      <td>Avengers: Age of Ultron</td>\n",
       "      <td>$330,600,000</td>\n",
       "      <td>$459,005,868</td>\n",
       "      <td>$1,403,013,963</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Dec 15, 2017</td>\n",
       "      <td>Star Wars Ep. VIII: The Last Jedi</td>\n",
       "      <td>$317,000,000</td>\n",
       "      <td>$620,181,382</td>\n",
       "      <td>$1,316,721,747</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5777</th>\n",
       "      <td>78</td>\n",
       "      <td>Dec 31, 2018</td>\n",
       "      <td>Red 11</td>\n",
       "      <td>$7,000</td>\n",
       "      <td>$0</td>\n",
       "      <td>$0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5778</th>\n",
       "      <td>79</td>\n",
       "      <td>Apr 2, 1999</td>\n",
       "      <td>Following</td>\n",
       "      <td>$6,000</td>\n",
       "      <td>$48,482</td>\n",
       "      <td>$240,495</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5779</th>\n",
       "      <td>80</td>\n",
       "      <td>Jul 13, 2005</td>\n",
       "      <td>Return to the Land of Wonders</td>\n",
       "      <td>$5,000</td>\n",
       "      <td>$1,338</td>\n",
       "      <td>$1,338</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5780</th>\n",
       "      <td>81</td>\n",
       "      <td>Sep 29, 2015</td>\n",
       "      <td>A Plague So Pleasant</td>\n",
       "      <td>$1,400</td>\n",
       "      <td>$0</td>\n",
       "      <td>$0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5781</th>\n",
       "      <td>82</td>\n",
       "      <td>Aug 5, 2005</td>\n",
       "      <td>My Date With Drew</td>\n",
       "      <td>$1,100</td>\n",
       "      <td>$181,041</td>\n",
       "      <td>$181,041</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5782 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      id  release_date                                        movie  \\\n",
       "0      1  Dec 18, 2009                                       Avatar   \n",
       "1      2  May 20, 2011  Pirates of the Caribbean: On Stranger Tides   \n",
       "2      3   Jun 7, 2019                                 Dark Phoenix   \n",
       "3      4   May 1, 2015                      Avengers: Age of Ultron   \n",
       "4      5  Dec 15, 2017            Star Wars Ep. VIII: The Last Jedi   \n",
       "...   ..           ...                                          ...   \n",
       "5777  78  Dec 31, 2018                                       Red 11   \n",
       "5778  79   Apr 2, 1999                                    Following   \n",
       "5779  80  Jul 13, 2005                Return to the Land of Wonders   \n",
       "5780  81  Sep 29, 2015                         A Plague So Pleasant   \n",
       "5781  82   Aug 5, 2005                            My Date With Drew   \n",
       "\n",
       "     production_budget domestic_gross worldwide_gross  \n",
       "0         $425,000,000   $760,507,625  $2,776,345,279  \n",
       "1         $410,600,000   $241,063,875  $1,045,663,875  \n",
       "2         $350,000,000    $42,762,350    $149,762,350  \n",
       "3         $330,600,000   $459,005,868  $1,403,013,963  \n",
       "4         $317,000,000   $620,181,382  $1,316,721,747  \n",
       "...                ...            ...             ...  \n",
       "5777            $7,000             $0              $0  \n",
       "5778            $6,000        $48,482        $240,495  \n",
       "5779            $5,000         $1,338          $1,338  \n",
       "5780            $1,400             $0              $0  \n",
       "5781            $1,100       $181,041        $181,041  \n",
       "\n",
       "[5782 rows x 6 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "budgets\n",
    "#This relatively small dataset will be merged with the IMDB titles dataset \n",
    "#to display financial attributes of unique movies when conducting a genre analysis in Analysis 2. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>averagerating</th>\n",
       "      <th>numvotes</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt10356526</td>\n",
       "      <td>8.3</td>\n",
       "      <td>31</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt10384606</td>\n",
       "      <td>8.9</td>\n",
       "      <td>559</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt1042974</td>\n",
       "      <td>6.4</td>\n",
       "      <td>20</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt1043726</td>\n",
       "      <td>4.2</td>\n",
       "      <td>50352</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt1060240</td>\n",
       "      <td>6.5</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>73851</th>\n",
       "      <td>tt9805820</td>\n",
       "      <td>8.1</td>\n",
       "      <td>25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>73852</th>\n",
       "      <td>tt9844256</td>\n",
       "      <td>7.5</td>\n",
       "      <td>24</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>73853</th>\n",
       "      <td>tt9851050</td>\n",
       "      <td>4.7</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>73854</th>\n",
       "      <td>tt9886934</td>\n",
       "      <td>7.0</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>73855</th>\n",
       "      <td>tt9894098</td>\n",
       "      <td>6.3</td>\n",
       "      <td>128</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>73856 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           tconst  averagerating  numvotes\n",
       "0      tt10356526            8.3        31\n",
       "1      tt10384606            8.9       559\n",
       "2       tt1042974            6.4        20\n",
       "3       tt1043726            4.2     50352\n",
       "4       tt1060240            6.5        21\n",
       "...           ...            ...       ...\n",
       "73851   tt9805820            8.1        25\n",
       "73852   tt9844256            7.5        24\n",
       "73853   tt9851050            4.7        14\n",
       "73854   tt9886934            7.0         5\n",
       "73855   tt9894098            6.3       128\n",
       "\n",
       "[73856 rows x 3 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "imdb_ratings\n",
    "#This dataframe shows average ratings and number of votes for each unique movie ID (\"tconst\"), and will\n",
    "#be important to our analysis of actor performance (Analysis 3) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>ordering</th>\n",
       "      <th>nconst</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt0111414</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0246005</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"The Man\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt0111414</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0398271</td>\n",
       "      <td>director</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt0111414</td>\n",
       "      <td>3</td>\n",
       "      <td>nm3739909</td>\n",
       "      <td>producer</td>\n",
       "      <td>producer</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt0323808</td>\n",
       "      <td>10</td>\n",
       "      <td>nm0059247</td>\n",
       "      <td>editor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt0323808</td>\n",
       "      <td>1</td>\n",
       "      <td>nm3579312</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Beth Boothby\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1028181</th>\n",
       "      <td>tt9692684</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0186469</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Ebenezer Scrooge\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1028182</th>\n",
       "      <td>tt9692684</td>\n",
       "      <td>2</td>\n",
       "      <td>nm4929530</td>\n",
       "      <td>self</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\",\"Regan\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1028183</th>\n",
       "      <td>tt9692684</td>\n",
       "      <td>3</td>\n",
       "      <td>nm10441594</td>\n",
       "      <td>director</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1028184</th>\n",
       "      <td>tt9692684</td>\n",
       "      <td>4</td>\n",
       "      <td>nm6009913</td>\n",
       "      <td>writer</td>\n",
       "      <td>writer</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1028185</th>\n",
       "      <td>tt9692684</td>\n",
       "      <td>5</td>\n",
       "      <td>nm10441595</td>\n",
       "      <td>producer</td>\n",
       "      <td>producer</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1028186 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            tconst  ordering      nconst  category       job  \\\n",
       "0        tt0111414         1   nm0246005     actor       NaN   \n",
       "1        tt0111414         2   nm0398271  director       NaN   \n",
       "2        tt0111414         3   nm3739909  producer  producer   \n",
       "3        tt0323808        10   nm0059247    editor       NaN   \n",
       "4        tt0323808         1   nm3579312   actress       NaN   \n",
       "...            ...       ...         ...       ...       ...   \n",
       "1028181  tt9692684         1   nm0186469     actor       NaN   \n",
       "1028182  tt9692684         2   nm4929530      self       NaN   \n",
       "1028183  tt9692684         3  nm10441594  director       NaN   \n",
       "1028184  tt9692684         4   nm6009913    writer    writer   \n",
       "1028185  tt9692684         5  nm10441595  producer  producer   \n",
       "\n",
       "                   characters  \n",
       "0                 [\"The Man\"]  \n",
       "1                         NaN  \n",
       "2                         NaN  \n",
       "3                         NaN  \n",
       "4            [\"Beth Boothby\"]  \n",
       "...                       ...  \n",
       "1028181  [\"Ebenezer Scrooge\"]  \n",
       "1028182   [\"Herself\",\"Regan\"]  \n",
       "1028183                   NaN  \n",
       "1028184                   NaN  \n",
       "1028185                   NaN  \n",
       "\n",
       "[1028186 rows x 6 columns]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "imdb_principals\n",
    "#This dataframe shows unique IDS for all \"principals\" (generally those that appear in title credits). \n",
    "#This will be important in the actor analysis (Analysis 3). "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>nconst</th>\n",
       "      <th>primary_name</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>death_year</th>\n",
       "      <th>primary_profession</th>\n",
       "      <th>known_for_titles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>nm0061671</td>\n",
       "      <td>Mary Ellen Bauder</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>miscellaneous,production_manager,producer</td>\n",
       "      <td>tt0837562,tt2398241,tt0844471,tt0118553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>nm0061865</td>\n",
       "      <td>Joseph Bauer</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>composer,music_department,sound_department</td>\n",
       "      <td>tt0896534,tt6791238,tt0287072,tt1682940</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>nm0062070</td>\n",
       "      <td>Bruce Baum</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>miscellaneous,actor,writer</td>\n",
       "      <td>tt1470654,tt0363631,tt0104030,tt0102898</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>nm0062195</td>\n",
       "      <td>Axel Baumann</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>camera_department,cinematographer,art_department</td>\n",
       "      <td>tt0114371,tt2004304,tt1618448,tt1224387</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>nm0062798</td>\n",
       "      <td>Pete Baxter</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>production_designer,art_department,set_decorator</td>\n",
       "      <td>tt0452644,tt0452692,tt3458030,tt2178256</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>606643</th>\n",
       "      <td>nm9990381</td>\n",
       "      <td>Susan Grobes</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>606644</th>\n",
       "      <td>nm9990690</td>\n",
       "      <td>Joo Yeon So</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress</td>\n",
       "      <td>tt9090932,tt8737130</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>606645</th>\n",
       "      <td>nm9991320</td>\n",
       "      <td>Madeline Smith</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress</td>\n",
       "      <td>tt8734436,tt9615610</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>606646</th>\n",
       "      <td>nm9991786</td>\n",
       "      <td>Michelle Modigliani</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>producer</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>606647</th>\n",
       "      <td>nm9993380</td>\n",
       "      <td>Pegasus Envoyé</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>director,actor,writer</td>\n",
       "      <td>tt8743182</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>606648 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           nconst         primary_name  birth_year  death_year  \\\n",
       "0       nm0061671    Mary Ellen Bauder         NaN         NaN   \n",
       "1       nm0061865         Joseph Bauer         NaN         NaN   \n",
       "2       nm0062070           Bruce Baum         NaN         NaN   \n",
       "3       nm0062195         Axel Baumann         NaN         NaN   \n",
       "4       nm0062798          Pete Baxter         NaN         NaN   \n",
       "...           ...                  ...         ...         ...   \n",
       "606643  nm9990381         Susan Grobes         NaN         NaN   \n",
       "606644  nm9990690          Joo Yeon So         NaN         NaN   \n",
       "606645  nm9991320       Madeline Smith         NaN         NaN   \n",
       "606646  nm9991786  Michelle Modigliani         NaN         NaN   \n",
       "606647  nm9993380       Pegasus Envoyé         NaN         NaN   \n",
       "\n",
       "                                      primary_profession  \\\n",
       "0              miscellaneous,production_manager,producer   \n",
       "1             composer,music_department,sound_department   \n",
       "2                             miscellaneous,actor,writer   \n",
       "3       camera_department,cinematographer,art_department   \n",
       "4       production_designer,art_department,set_decorator   \n",
       "...                                                  ...   \n",
       "606643                                           actress   \n",
       "606644                                           actress   \n",
       "606645                                           actress   \n",
       "606646                                          producer   \n",
       "606647                             director,actor,writer   \n",
       "\n",
       "                               known_for_titles  \n",
       "0       tt0837562,tt2398241,tt0844471,tt0118553  \n",
       "1       tt0896534,tt6791238,tt0287072,tt1682940  \n",
       "2       tt1470654,tt0363631,tt0104030,tt0102898  \n",
       "3       tt0114371,tt2004304,tt1618448,tt1224387  \n",
       "4       tt0452644,tt0452692,tt3458030,tt2178256  \n",
       "...                                         ...  \n",
       "606643                                      NaN  \n",
       "606644                      tt9090932,tt8737130  \n",
       "606645                      tt8734436,tt9615610  \n",
       "606646                                      NaN  \n",
       "606647                                tt8743182  \n",
       "\n",
       "[606648 rows x 6 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "imdb_names\n",
    "#This dataset is critical to identifying names of all actors based on their unique identifier (\"nconst\"), \n",
    "#in Analysis 3. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Analysis 1: In which months should Microsoft schedule their film releases? \n",
    "For this analysis, the Movie Database dataframe was used to create a model that will be useful in determining the optimal release month. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Data Cleaning\n",
    "This dataframe contained 26,527 movies, 2,027 of which were duplicated movies. Data cleaning actions included re-formatting the column titles in the dataframe, aggregating and dropping duplicates, and converting release data data to a DateTime object. \n",
    "\n",
    "Here, I also work on cleaning the \"Budgets\" dataframe, which will be used in Analysis #2. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>release_date</th>\n",
       "      <th>movie</th>\n",
       "      <th>production_budget</th>\n",
       "      <th>domestic_gross</th>\n",
       "      <th>worldwide_gross</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Dec 18, 2009</td>\n",
       "      <td>avatar</td>\n",
       "      <td>$425,000,000</td>\n",
       "      <td>$760,507,625</td>\n",
       "      <td>$2,776,345,279</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>May 20, 2011</td>\n",
       "      <td>pirates_of_the_caribbean_on_stranger_tides</td>\n",
       "      <td>$410,600,000</td>\n",
       "      <td>$241,063,875</td>\n",
       "      <td>$1,045,663,875</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Jun 7, 2019</td>\n",
       "      <td>dark_phoenix</td>\n",
       "      <td>$350,000,000</td>\n",
       "      <td>$42,762,350</td>\n",
       "      <td>$149,762,350</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>May 1, 2015</td>\n",
       "      <td>avengers_age_of_ultron</td>\n",
       "      <td>$330,600,000</td>\n",
       "      <td>$459,005,868</td>\n",
       "      <td>$1,403,013,963</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Dec 15, 2017</td>\n",
       "      <td>star_wars_ep_viii_the_last_jedi</td>\n",
       "      <td>$317,000,000</td>\n",
       "      <td>$620,181,382</td>\n",
       "      <td>$1,316,721,747</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id  release_date                                       movie  \\\n",
       "0   1  Dec 18, 2009                                      avatar   \n",
       "1   2  May 20, 2011  pirates_of_the_caribbean_on_stranger_tides   \n",
       "2   3   Jun 7, 2019                                dark_phoenix   \n",
       "3   4   May 1, 2015                      avengers_age_of_ultron   \n",
       "4   5  Dec 15, 2017             star_wars_ep_viii_the_last_jedi   \n",
       "\n",
       "  production_budget domestic_gross worldwide_gross  \n",
       "0      $425,000,000   $760,507,625  $2,776,345,279  \n",
       "1      $410,600,000   $241,063,875  $1,045,663,875  \n",
       "2      $350,000,000    $42,762,350    $149,762,350  \n",
       "3      $330,600,000   $459,005,868  $1,403,013,963  \n",
       "4      $317,000,000   $620,181,382  $1,316,721,747  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Standardize movie titles across dataframes. \n",
    "budgets['movie'] = budgets['movie'].str.replace(' ', '_').str.lower().str.replace('[^\\w\\s]','')\n",
    "budgets.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>genre_ids</th>\n",
       "      <th>id</th>\n",
       "      <th>original_language</th>\n",
       "      <th>original_title</th>\n",
       "      <th>popularity</th>\n",
       "      <th>release_date</th>\n",
       "      <th>title</th>\n",
       "      <th>vote_average</th>\n",
       "      <th>vote_count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>[12, 14, 10751]</td>\n",
       "      <td>12444</td>\n",
       "      <td>en</td>\n",
       "      <td>Harry Potter and the Deathly Hallows: Part 1</td>\n",
       "      <td>33.533</td>\n",
       "      <td>2010-11-19</td>\n",
       "      <td>harry_potter_and_the_deathly_hallows_part_1</td>\n",
       "      <td>7.7</td>\n",
       "      <td>10788</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>[14, 12, 16, 10751]</td>\n",
       "      <td>10191</td>\n",
       "      <td>en</td>\n",
       "      <td>How to Train Your Dragon</td>\n",
       "      <td>28.734</td>\n",
       "      <td>2010-03-26</td>\n",
       "      <td>how_to_train_your_dragon</td>\n",
       "      <td>7.7</td>\n",
       "      <td>7610</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>[12, 28, 878]</td>\n",
       "      <td>10138</td>\n",
       "      <td>en</td>\n",
       "      <td>Iron Man 2</td>\n",
       "      <td>28.515</td>\n",
       "      <td>2010-05-07</td>\n",
       "      <td>iron_man_2</td>\n",
       "      <td>6.8</td>\n",
       "      <td>12368</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>[16, 35, 10751]</td>\n",
       "      <td>862</td>\n",
       "      <td>en</td>\n",
       "      <td>Toy Story</td>\n",
       "      <td>28.005</td>\n",
       "      <td>1995-11-22</td>\n",
       "      <td>toy_story</td>\n",
       "      <td>7.9</td>\n",
       "      <td>10174</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>[28, 878, 12]</td>\n",
       "      <td>27205</td>\n",
       "      <td>en</td>\n",
       "      <td>Inception</td>\n",
       "      <td>27.920</td>\n",
       "      <td>2010-07-16</td>\n",
       "      <td>inception</td>\n",
       "      <td>8.3</td>\n",
       "      <td>22186</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Unnamed: 0            genre_ids     id original_language  \\\n",
       "0           0      [12, 14, 10751]  12444                en   \n",
       "1           1  [14, 12, 16, 10751]  10191                en   \n",
       "2           2        [12, 28, 878]  10138                en   \n",
       "3           3      [16, 35, 10751]    862                en   \n",
       "4           4        [28, 878, 12]  27205                en   \n",
       "\n",
       "                                 original_title  popularity release_date  \\\n",
       "0  Harry Potter and the Deathly Hallows: Part 1      33.533   2010-11-19   \n",
       "1                      How to Train Your Dragon      28.734   2010-03-26   \n",
       "2                                    Iron Man 2      28.515   2010-05-07   \n",
       "3                                     Toy Story      28.005   1995-11-22   \n",
       "4                                     Inception      27.920   2010-07-16   \n",
       "\n",
       "                                         title  vote_average  vote_count  \n",
       "0  harry_potter_and_the_deathly_hallows_part_1           7.7       10788  \n",
       "1                     how_to_train_your_dragon           7.7        7610  \n",
       "2                                   iron_man_2           6.8       12368  \n",
       "3                                    toy_story           7.9       10174  \n",
       "4                                    inception           8.3       22186  "
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "moviedb_movies['title'] = moviedb_movies['title'].str.replace(' ', '_').str.lower().str.replace('[^\\w\\s]','')\n",
    "moviedb_movies.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "id                   0\n",
       "release_date         0\n",
       "movie                0\n",
       "production_budget    0\n",
       "domestic_gross       0\n",
       "worldwide_gross      0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "budgets.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Unnamed: 0           0\n",
       "genre_ids            0\n",
       "id                   0\n",
       "original_language    0\n",
       "original_title       0\n",
       "popularity           0\n",
       "release_date         0\n",
       "title                0\n",
       "vote_average         0\n",
       "vote_count           0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "moviedb_movies.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>genre_ids</th>\n",
       "      <th>id</th>\n",
       "      <th>original_language</th>\n",
       "      <th>original_title</th>\n",
       "      <th>popularity</th>\n",
       "      <th>release_date</th>\n",
       "      <th>title</th>\n",
       "      <th>vote_average</th>\n",
       "      <th>vote_count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>14850</th>\n",
       "      <td>14850</td>\n",
       "      <td>[18, 10749]</td>\n",
       "      <td>253251</td>\n",
       "      <td>en</td>\n",
       "      <td>10.000 KM</td>\n",
       "      <td>4.205</td>\n",
       "      <td>2015-07-10</td>\n",
       "      <td>10000_km</td>\n",
       "      <td>6.5</td>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21096</th>\n",
       "      <td>21096</td>\n",
       "      <td>[18]</td>\n",
       "      <td>334532</td>\n",
       "      <td>en</td>\n",
       "      <td>100 Streets</td>\n",
       "      <td>7.317</td>\n",
       "      <td>2016-06-08</td>\n",
       "      <td>100_streets</td>\n",
       "      <td>6.2</td>\n",
       "      <td>91</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22224</th>\n",
       "      <td>22224</td>\n",
       "      <td>[18, 80]</td>\n",
       "      <td>394770</td>\n",
       "      <td>en</td>\n",
       "      <td>11:55</td>\n",
       "      <td>1.400</td>\n",
       "      <td>2017-06-09</td>\n",
       "      <td>1155</td>\n",
       "      <td>5.0</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21298</th>\n",
       "      <td>21298</td>\n",
       "      <td>[18, 10749]</td>\n",
       "      <td>416691</td>\n",
       "      <td>en</td>\n",
       "      <td>1 Night</td>\n",
       "      <td>5.409</td>\n",
       "      <td>2017-02-10</td>\n",
       "      <td>1_night</td>\n",
       "      <td>6.4</td>\n",
       "      <td>107</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20839</th>\n",
       "      <td>20839</td>\n",
       "      <td>[18]</td>\n",
       "      <td>342737</td>\n",
       "      <td>en</td>\n",
       "      <td>20th Century Women</td>\n",
       "      <td>10.413</td>\n",
       "      <td>2016-12-28</td>\n",
       "      <td>20th_century_women</td>\n",
       "      <td>7.4</td>\n",
       "      <td>504</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15026</th>\n",
       "      <td>15026</td>\n",
       "      <td>[35, 18]</td>\n",
       "      <td>270886</td>\n",
       "      <td>fr</td>\n",
       "      <td>Tu dors Nicole</td>\n",
       "      <td>2.835</td>\n",
       "      <td>2014-10-09</td>\n",
       "      <td>youre_sleeping_nicole</td>\n",
       "      <td>6.7</td>\n",
       "      <td>23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21681</th>\n",
       "      <td>21681</td>\n",
       "      <td>[35, 18]</td>\n",
       "      <td>338387</td>\n",
       "      <td>en</td>\n",
       "      <td>Youth in Oregon</td>\n",
       "      <td>2.534</td>\n",
       "      <td>2017-02-03</td>\n",
       "      <td>youth_in_oregon</td>\n",
       "      <td>6.3</td>\n",
       "      <td>19</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24629</th>\n",
       "      <td>24629</td>\n",
       "      <td>[18]</td>\n",
       "      <td>326382</td>\n",
       "      <td>es</td>\n",
       "      <td>Zama</td>\n",
       "      <td>5.671</td>\n",
       "      <td>2017-09-30</td>\n",
       "      <td>zama</td>\n",
       "      <td>6.9</td>\n",
       "      <td>50</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15061</th>\n",
       "      <td>15061</td>\n",
       "      <td>[10751, 16]</td>\n",
       "      <td>94196</td>\n",
       "      <td>fr</td>\n",
       "      <td>Zarafa</td>\n",
       "      <td>2.705</td>\n",
       "      <td>2012-11-11</td>\n",
       "      <td>zarafa</td>\n",
       "      <td>6.8</td>\n",
       "      <td>39</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25188</th>\n",
       "      <td>25188</td>\n",
       "      <td>[10752, 10751, 36]</td>\n",
       "      <td>472553</td>\n",
       "      <td>en</td>\n",
       "      <td>Zoo</td>\n",
       "      <td>2.550</td>\n",
       "      <td>2018-06-08</td>\n",
       "      <td>zoo</td>\n",
       "      <td>6.6</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1027 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Unnamed: 0           genre_ids      id original_language  \\\n",
       "14850       14850         [18, 10749]  253251                en   \n",
       "21096       21096                [18]  334532                en   \n",
       "22224       22224            [18, 80]  394770                en   \n",
       "21298       21298         [18, 10749]  416691                en   \n",
       "20839       20839                [18]  342737                en   \n",
       "...           ...                 ...     ...               ...   \n",
       "15026       15026            [35, 18]  270886                fr   \n",
       "21681       21681            [35, 18]  338387                en   \n",
       "24629       24629                [18]  326382                es   \n",
       "15061       15061         [10751, 16]   94196                fr   \n",
       "25188       25188  [10752, 10751, 36]  472553                en   \n",
       "\n",
       "           original_title  popularity release_date                  title  \\\n",
       "14850           10.000 KM       4.205   2015-07-10               10000_km   \n",
       "21096         100 Streets       7.317   2016-06-08            100_streets   \n",
       "22224               11:55       1.400   2017-06-09                   1155   \n",
       "21298             1 Night       5.409   2017-02-10                1_night   \n",
       "20839  20th Century Women      10.413   2016-12-28     20th_century_women   \n",
       "...                   ...         ...          ...                    ...   \n",
       "15026      Tu dors Nicole       2.835   2014-10-09  youre_sleeping_nicole   \n",
       "21681     Youth in Oregon       2.534   2017-02-03        youth_in_oregon   \n",
       "24629                Zama       5.671   2017-09-30                   zama   \n",
       "15061              Zarafa       2.705   2012-11-11                 zarafa   \n",
       "25188                 Zoo       2.550   2018-06-08                    zoo   \n",
       "\n",
       "       vote_average  vote_count  \n",
       "14850           6.5          49  \n",
       "21096           6.2          91  \n",
       "22224           5.0           8  \n",
       "21298           6.4         107  \n",
       "20839           7.4         504  \n",
       "...             ...         ...  \n",
       "15026           6.7          23  \n",
       "21681           6.3          19  \n",
       "24629           6.9          50  \n",
       "15061           6.8          39  \n",
       "25188           6.6          17  \n",
       "\n",
       "[1027 rows x 10 columns]"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "moviedb_dupes = moviedb_movies.loc[moviedb_movies.duplicated(subset=['title', 'release_date'], keep='first') == True]\n",
    "moviedb_dupes.sort_values(by=['title'],ascending=True)\n",
    "#Duplicated values account for less than 4% of data, so I will leave these be. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>release_date</th>\n",
       "      <th>movie</th>\n",
       "      <th>production_budget</th>\n",
       "      <th>domestic_gross</th>\n",
       "      <th>worldwide_gross</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>2009-12-18</td>\n",
       "      <td>avatar</td>\n",
       "      <td>$425,000,000</td>\n",
       "      <td>$760,507,625</td>\n",
       "      <td>$2,776,345,279</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>2011-05-20</td>\n",
       "      <td>pirates_of_the_caribbean_on_stranger_tides</td>\n",
       "      <td>$410,600,000</td>\n",
       "      <td>$241,063,875</td>\n",
       "      <td>$1,045,663,875</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id release_date                                       movie  \\\n",
       "0   1   2009-12-18                                      avatar   \n",
       "1   2   2011-05-20  pirates_of_the_caribbean_on_stranger_tides   \n",
       "\n",
       "  production_budget domestic_gross worldwide_gross  \n",
       "0      $425,000,000   $760,507,625  $2,776,345,279  \n",
       "1      $410,600,000   $241,063,875  $1,045,663,875  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Change release date column into DateTime format. \n",
    "budgets['release_date'] = pd.to_datetime(budgets['release_date'])\n",
    "budgets.head(2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>genre_ids</th>\n",
       "      <th>id</th>\n",
       "      <th>original_language</th>\n",
       "      <th>original_title</th>\n",
       "      <th>popularity</th>\n",
       "      <th>release_date</th>\n",
       "      <th>title</th>\n",
       "      <th>vote_average</th>\n",
       "      <th>vote_count</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>[12, 14, 10751]</td>\n",
       "      <td>12444</td>\n",
       "      <td>en</td>\n",
       "      <td>Harry Potter and the Deathly Hallows: Part 1</td>\n",
       "      <td>33.533</td>\n",
       "      <td>2010-11-19</td>\n",
       "      <td>harry_potter_and_the_deathly_hallows_part_1</td>\n",
       "      <td>7.7</td>\n",
       "      <td>10788</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>[14, 12, 16, 10751]</td>\n",
       "      <td>10191</td>\n",
       "      <td>en</td>\n",
       "      <td>How to Train Your Dragon</td>\n",
       "      <td>28.734</td>\n",
       "      <td>2010-03-26</td>\n",
       "      <td>how_to_train_your_dragon</td>\n",
       "      <td>7.7</td>\n",
       "      <td>7610</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Unnamed: 0            genre_ids     id original_language  \\\n",
       "0           0      [12, 14, 10751]  12444                en   \n",
       "1           1  [14, 12, 16, 10751]  10191                en   \n",
       "\n",
       "                                 original_title  popularity release_date  \\\n",
       "0  Harry Potter and the Deathly Hallows: Part 1      33.533   2010-11-19   \n",
       "1                      How to Train Your Dragon      28.734   2010-03-26   \n",
       "\n",
       "                                         title  vote_average  vote_count  \n",
       "0  harry_potter_and_the_deathly_hallows_part_1           7.7       10788  \n",
       "1                     how_to_train_your_dragon           7.7        7610  "
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "moviedb_movies['release_date'] = pd.to_datetime(moviedb_movies['release_date'])\n",
    "moviedb_movies.head(2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Data Modeling"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# Make another column (\"month\") containing just the month from the \"release_date\" column. \n",
    "moviedb_movies[\"month\"] = moviedb_movies[\"release_date\"].dt.month\n",
    "moviedb_movies.head()\n",
    "\n",
    "clean_moviedb = moviedb_movies.drop(columns = ['Unnamed: 0', 'id', 'original_language', 'original_title'], axis = 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-17-4611ba133348>:28: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  clean_moviedb['month'][i] = 'November'\n",
      "<ipython-input-17-4611ba133348>:12: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  clean_moviedb['month'][i] = 'March'\n",
      "<ipython-input-17-4611ba133348>:16: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  clean_moviedb['month'][i] = 'May'\n",
      "<ipython-input-17-4611ba133348>:20: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  clean_moviedb['month'][i] = 'July'\n",
      "<ipython-input-17-4611ba133348>:10: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  clean_moviedb['month'][i] = 'February'\n",
      "<ipython-input-17-4611ba133348>:30: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  clean_moviedb['month'][i] = 'December'\n",
      "<ipython-input-17-4611ba133348>:18: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  clean_moviedb['month'][i] = 'June'\n",
      "<ipython-input-17-4611ba133348>:22: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  clean_moviedb['month'][i] = 'August'\n",
      "<ipython-input-17-4611ba133348>:26: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  clean_moviedb['month'][i] = 'October'\n",
      "<ipython-input-17-4611ba133348>:8: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  clean_moviedb['month'][i] = 'January'\n",
      "<ipython-input-17-4611ba133348>:24: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  clean_moviedb['month'][i] = 'September'\n",
      "<ipython-input-17-4611ba133348>:14: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  clean_moviedb['month'][i] = 'April'\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>genre_ids</th>\n",
       "      <th>popularity</th>\n",
       "      <th>release_date</th>\n",
       "      <th>title</th>\n",
       "      <th>vote_average</th>\n",
       "      <th>vote_count</th>\n",
       "      <th>month</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>[12, 14, 10751]</td>\n",
       "      <td>33.533</td>\n",
       "      <td>2010-11-19</td>\n",
       "      <td>harry_potter_and_the_deathly_hallows_part_1</td>\n",
       "      <td>7.7</td>\n",
       "      <td>10788</td>\n",
       "      <td>November</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>[14, 12, 16, 10751]</td>\n",
       "      <td>28.734</td>\n",
       "      <td>2010-03-26</td>\n",
       "      <td>how_to_train_your_dragon</td>\n",
       "      <td>7.7</td>\n",
       "      <td>7610</td>\n",
       "      <td>March</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>[12, 28, 878]</td>\n",
       "      <td>28.515</td>\n",
       "      <td>2010-05-07</td>\n",
       "      <td>iron_man_2</td>\n",
       "      <td>6.8</td>\n",
       "      <td>12368</td>\n",
       "      <td>May</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>[16, 35, 10751]</td>\n",
       "      <td>28.005</td>\n",
       "      <td>1995-11-22</td>\n",
       "      <td>toy_story</td>\n",
       "      <td>7.9</td>\n",
       "      <td>10174</td>\n",
       "      <td>November</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>[28, 878, 12]</td>\n",
       "      <td>27.920</td>\n",
       "      <td>2010-07-16</td>\n",
       "      <td>inception</td>\n",
       "      <td>8.3</td>\n",
       "      <td>22186</td>\n",
       "      <td>July</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             genre_ids  popularity release_date  \\\n",
       "0      [12, 14, 10751]      33.533   2010-11-19   \n",
       "1  [14, 12, 16, 10751]      28.734   2010-03-26   \n",
       "2        [12, 28, 878]      28.515   2010-05-07   \n",
       "3      [16, 35, 10751]      28.005   1995-11-22   \n",
       "4        [28, 878, 12]      27.920   2010-07-16   \n",
       "\n",
       "                                         title  vote_average  vote_count  \\\n",
       "0  harry_potter_and_the_deathly_hallows_part_1           7.7       10788   \n",
       "1                     how_to_train_your_dragon           7.7        7610   \n",
       "2                                   iron_man_2           6.8       12368   \n",
       "3                                    toy_story           7.9       10174   \n",
       "4                                    inception           8.3       22186   \n",
       "\n",
       "      month  \n",
       "0  November  \n",
       "1     March  \n",
       "2       May  \n",
       "3  November  \n",
       "4      July  "
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Change datatype of ['month'] column to string\n",
    "clean_moviedb['month'] = clean_moviedb['month'].astype('str')\n",
    "\n",
    "# Enumerate to replace values in ['month'] with names of months \n",
    "\n",
    "for i, element in enumerate(clean_moviedb['month']): \n",
    "    if element == '1':\n",
    "        clean_moviedb['month'][i] = 'January'\n",
    "    elif element == '2': \n",
    "        clean_moviedb['month'][i] = 'February'\n",
    "    elif '3' in element: \n",
    "        clean_moviedb['month'][i] = 'March'\n",
    "    elif '4' in element: \n",
    "        clean_moviedb['month'][i] = 'April' \n",
    "    elif '5' in element:\n",
    "        clean_moviedb['month'][i] = 'May'\n",
    "    elif '6' in element: \n",
    "        clean_moviedb['month'][i] = 'June'\n",
    "    elif '7' in element: \n",
    "        clean_moviedb['month'][i] = 'July'\n",
    "    elif '8' in element: \n",
    "        clean_moviedb['month'][i] = 'August'    \n",
    "    elif '9' in element:\n",
    "        clean_moviedb['month'][i] = 'September'\n",
    "    elif '10' in element: \n",
    "        clean_moviedb['month'][i] = 'October'\n",
    "    elif '11' in element: \n",
    "        clean_moviedb['month'][i] = 'November'\n",
    "    elif '12' in element: \n",
    "        clean_moviedb['month'][i] = 'December' \n",
    "        \n",
    "clean_moviedb.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "January      3132\n",
       "October      3035\n",
       "April        2566\n",
       "March        2406\n",
       "November     2338\n",
       "September    2264\n",
       "June         2166\n",
       "December     1929\n",
       "May          1865\n",
       "August       1698\n",
       "February     1614\n",
       "July         1504\n",
       "Name: month, dtype: int64"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "clean_moviedb['month'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "image/png": "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d9UWihegadPm3Hvvw2RmZrJ06RI2bNhAxYpbL8P99ttvcOihh1OtWrUttj/99AQyMzPJyspi6dLF7LFHowL9LR2ntOELORUBWVlZTJs2hX33PYD169czcGBfrr32ep544hk6dTqVgQP7bTp21aqVjBnzNAMG3MqQIQNYv359vtdftWol06dP4777Huapp56ndetDmTjx+U37DzmkNc888yI1auwAwG677U6nTqfQqdMptG/fmRNPbM/bb1t+wrRpU2jduu1WSgPgyCOPZvr0qQCsX7+e+fP/xz777Ltp/5AhA7j00isZM+Zprr++HwMG9AVg0qRXOPfcC3nssScZNeoh7r9/c0hr/vx53HXX/TzyyFjGjXuCf//9dytrLZrMzExGj36Ys846jebND6JWrZ22OqZbt3Po0KFzjuf+8MN8Tj65HZ9/Ppujjz4uv5/WcRxKkcURaxmke97B0qVLOO+8bgCsX7+Oxo335ZJLLmfBgl/YfvvtadzYOtyjjjqGO+4YwsqVVu2yY8eTAWjUSNhxx5r88MO8fGVVrlyFwYOH8u67b7Ngwa988smHNGokm/bvs89+eZ7frl0Hrr76Unr06MWbb75Oz545u29q1dqJypWr8PPPP7Fo0e8cdNAhm/b9999/zJ37HUOHDt60bfXq1Sxf/g+XX341n3zyEU899Tg//DCf1av/23RMs2YtKFeuHDVq7EDVqlVZtWol22+fs/82woUXXkz37ufyf/93Da+++hKdOp2S5/HR7LHHnkya9DYvvzyRAQP68tBDY+I+13FKK6VGcRQ1uY2aFy9enMPR2WzcaEUry5Ytu2nrxo3ZlC1bloyMDCIrN2ZlbV0L8s8/F3Hllb045ZTTOOSQ1uyww47Mm7d5lc2crIdo6tSpS+3adZg+fSp///0X++6bu6I58shjmDZtCr//voDTTjuT+fPnhbZupHz5Clvc8+LFf1K1ajVuuul6tt++Km3aHMrRRx/Hu+++temY8uXLb/ocfZ858csvP7Nu3VoaNRIqVqzIYYcdGZdiBYvPfPLJRxx22BEAHH98O+6//+64znWc0o67qoqY+vUbsHz5cubO/RaAKVPeYeed61C1qvnj3333bcCC1//+u4Ldd9+TatWq89NPPwIwY8a0ra75/fffUa9ePc44ozuNG+/DjBnvbVJEuVG2bFk2bNh8zEkndeTu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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Plot by Month and Average Popularity to figure out the most popular month to release movies. \n",
    "\n",
    "#Make the group of the data according to their release month, find the mean popularity related to this, and plot.\n",
    "from matplotlib import pyplot as plt\n",
    "moviedb_movies.groupby('month')['popularity'].mean().plot(kind = 'bar')\n",
    "\n",
    "#Set up the title of the graph. \n",
    "plt.title(\"Release Month vs. Popularity\",fontsize = 14)\n",
    "\n",
    "#Setup the x-axis label and y-axis label of the graph.\n",
    "plt.xlabel('Release Month',fontsize = 13)\n",
    "plt.ylabel('Average Popularity',fontsize = 13)\n",
    "axes = plt.gca()\n",
    "axes.yaxis.grid()\n",
    "\n",
    "#Insert mean popularity\n",
    "plt.hlines(y=moviedb_movies['popularity'].mean(),xmin=-.5, xmax=11.5,color='red',\n",
    "           label=f\"Popularity Mean: {moviedb_movies['popularity'].mean():.2f}\") \n",
    "\n",
    "# Change x-axis tick labels to display names (not numbers) of months. \n",
    "plt.xticks([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],rotation=45)  # Set text labels and properties.\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Analysis and Recommendations\n",
    "There is plenty in the above chart to support the traditional filmmaking calculus that the summer months between May-August, combined with the holiday months of November and December, will yield the largest audience response. \n",
    "\n",
    "This [\"clustering\"](https://www.newyorker.com/magazine/2015/02/23/rethinking-seasonal-strategy) strategy may have some truth to it; people are indeed probably more likely to go to the movies when they have more free time in the warmer months and over the winter holidays. However, the trend may also be more of a self-fulfilling prophecy than anything else. The popularity spikes apparent in July, August, November, and December may have more to do with the fact that studios are already cramming movies that executives know will draw crowds into these months. \n",
    "\n",
    "Thus, the optimal opening month may vary depending on the type of movie being released. If the client is producing a movie based on a Microsoft-owned franchise that is popular in its own right (e.g. Call of Duty, Minecraft) and that Microsoft executives believe could occupy a large market share of movies released during the film industry's \"cluster\" months, then it may indeed make sense to plan release dates during the summer holidays. \n",
    "\n",
    "However, if the film being released is an original concept and/or there is more uncertainty surrounding its reception, Microsoft should consider scheduling their release for February or September. These \"off-peak\" months have historically been deemed ['dump months'](https://en.wikipedia.org/wiki/Dump_months) in the industry. However, contrary to this belief and as shown in the above chart, movies released after 2010 have enjoyed above-average popularity for February and September. Thus, there is a likelihood that movies released during these two months would out-perform those released during other off-peak months. Moreover, movies not anticipated to be big commercial successes may fare better being released in either February or September than during the cluster months of June, July, November, or December. \n",
    "\n",
    "Further analysis would be helpful in order to understand the seasonal crowding trends by month; in particular, it would be helpful to ascertain if the increase in popularity during peak months is due simply to studios' tendency to schedule guaranteed blockbusters during these months. This could be done through comparing the count of movies released per month against the average popularity per month. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Analysis 2: Which genres should Microsoft prioritize for production? \n",
    "For this analysis, IMDB data was cleaned and combined with budgets data to identify the most profitable genres. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Documentary             32185\n",
       "Drama                   21486\n",
       "Comedy                   9177\n",
       "Horror                   4372\n",
       "Comedy,Drama             3519\n",
       "                        ...  \n",
       "Animation,Crime             1\n",
       "Drama,Short,Western         1\n",
       "Mystery,Thriller,War        1\n",
       "Comedy,Drama,Short          1\n",
       "Comedy,Music,Mystery        1\n",
       "Name: genres, Length: 1085, dtype: int64"
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Getting an idea of the most common genres. \n",
    "imdb_titles_basics['genres'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "5408"
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#There are some movies with null values, but...\n",
    "imdb_titles_basics['genres'].isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.037004598204510616"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#...They make up less than 4% of the data, so we will just fill them with \"Unknown.\"\n",
    "imdb_titles_basics['genres'].isna().sum()/len(imdb_titles_basics)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "imdb_titles_basics['genres'] = imdb_titles_basics['genres'].fillna(\"Unknown\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Get a unique genres list. \n",
    "unique_genres_list = []\n",
    "for genre_details in imdb_titles_basics['genres']: \n",
    "    genres_list = genre_details.split(\",\")\n",
    "    for genre in genres_list: \n",
    "        unique_genres_list.append(genre)\n",
    "\n",
    "unique_genres_list = sorted(list(set(unique_genres_list)))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['Action',\n",
       " 'Adult',\n",
       " 'Adventure',\n",
       " 'Animation',\n",
       " 'Biography',\n",
       " 'Comedy',\n",
       " 'Crime',\n",
       " 'Documentary',\n",
       " 'Drama',\n",
       " 'Family',\n",
       " 'Fantasy',\n",
       " 'Game-Show',\n",
       " 'History',\n",
       " 'Horror',\n",
       " 'Music',\n",
       " 'Musical',\n",
       " 'Mystery',\n",
       " 'News',\n",
       " 'Reality-TV',\n",
       " 'Romance',\n",
       " 'Sci-Fi',\n",
       " 'Short',\n",
       " 'Sport',\n",
       " 'Talk-Show',\n",
       " 'Thriller',\n",
       " 'Unknown',\n",
       " 'War',\n",
       " 'Western']"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "unique_genres_list"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create columns for each unique genre\n",
    "for genre in unique_genres_list: \n",
    "    imdb_titles_basics[genre]=0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Use a loop to populate those genre columns\n",
    "# Code courtesy of Lindsey Berlin \n",
    "for index, genre_details in enumerate(imdb_titles_basics['genres']): \n",
    "    for genre in unique_genres_list: \n",
    "        if genre in genre_details: \n",
    "            #If a genre is in te genres column for that row, it'll add a 1 to that genre's column\n",
    "            imdb_titles_basics.at[index,genre] = 1\n",
    "            # This is the same as imdb[genre][index] = 1, but pandas like .at more than using the above syntax"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>primary_title</th>\n",
       "      <th>original_title</th>\n",
       "      <th>start_year</th>\n",
       "      <th>runtime_minutes</th>\n",
       "      <th>genres</th>\n",
       "      <th>Action</th>\n",
       "      <th>Adult</th>\n",
       "      <th>Adventure</th>\n",
       "      <th>Animation</th>\n",
       "      <th>...</th>\n",
       "      <th>Reality-TV</th>\n",
       "      <th>Romance</th>\n",
       "      <th>Sci-Fi</th>\n",
       "      <th>Short</th>\n",
       "      <th>Sport</th>\n",
       "      <th>Talk-Show</th>\n",
       "      <th>Thriller</th>\n",
       "      <th>Unknown</th>\n",
       "      <th>War</th>\n",
       "      <th>Western</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt0063540</td>\n",
       "      <td>Sunghursh</td>\n",
       "      <td>Sunghursh</td>\n",
       "      <td>2013</td>\n",
       "      <td>175.0</td>\n",
       "      <td>Action,Crime,Drama</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt0066787</td>\n",
       "      <td>One Day Before the Rainy Season</td>\n",
       "      <td>Ashad Ka Ek Din</td>\n",
       "      <td>2019</td>\n",
       "      <td>114.0</td>\n",
       "      <td>Biography,Drama</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt0069049</td>\n",
       "      <td>The Other Side of the Wind</td>\n",
       "      <td>The Other Side of the Wind</td>\n",
       "      <td>2018</td>\n",
       "      <td>122.0</td>\n",
       "      <td>Drama</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt0069204</td>\n",
       "      <td>Sabse Bada Sukh</td>\n",
       "      <td>Sabse Bada Sukh</td>\n",
       "      <td>2018</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Comedy,Drama</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt0100275</td>\n",
       "      <td>The Wandering Soap Opera</td>\n",
       "      <td>La Telenovela Errante</td>\n",
       "      <td>2017</td>\n",
       "      <td>80.0</td>\n",
       "      <td>Comedy,Drama,Fantasy</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>tt0111414</td>\n",
       "      <td>A Thin Life</td>\n",
       "      <td>A Thin Life</td>\n",
       "      <td>2018</td>\n",
       "      <td>75.0</td>\n",
       "      <td>Comedy</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>tt0112502</td>\n",
       "      <td>Bigfoot</td>\n",
       "      <td>Bigfoot</td>\n",
       "      <td>2017</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Horror,Thriller</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>tt0137204</td>\n",
       "      <td>Joe Finds Grace</td>\n",
       "      <td>Joe Finds Grace</td>\n",
       "      <td>2017</td>\n",
       "      <td>83.0</td>\n",
       "      <td>Adventure,Animation,Comedy</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>tt0139613</td>\n",
       "      <td>O Silêncio</td>\n",
       "      <td>O Silêncio</td>\n",
       "      <td>2012</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Documentary,History</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>tt0144449</td>\n",
       "      <td>Nema aviona za Zagreb</td>\n",
       "      <td>Nema aviona za Zagreb</td>\n",
       "      <td>2012</td>\n",
       "      <td>82.0</td>\n",
       "      <td>Biography</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10 rows × 34 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      tconst                    primary_title              original_title  \\\n",
       "0  tt0063540                        Sunghursh                   Sunghursh   \n",
       "1  tt0066787  One Day Before the Rainy Season             Ashad Ka Ek Din   \n",
       "2  tt0069049       The Other Side of the Wind  The Other Side of the Wind   \n",
       "3  tt0069204                  Sabse Bada Sukh             Sabse Bada Sukh   \n",
       "4  tt0100275         The Wandering Soap Opera       La Telenovela Errante   \n",
       "5  tt0111414                      A Thin Life                 A Thin Life   \n",
       "6  tt0112502                          Bigfoot                     Bigfoot   \n",
       "7  tt0137204                  Joe Finds Grace             Joe Finds Grace   \n",
       "8  tt0139613                       O Silêncio                  O Silêncio   \n",
       "9  tt0144449            Nema aviona za Zagreb       Nema aviona za Zagreb   \n",
       "\n",
       "   start_year  runtime_minutes                      genres  Action  Adult  \\\n",
       "0        2013            175.0          Action,Crime,Drama       1      0   \n",
       "1        2019            114.0             Biography,Drama       0      0   \n",
       "2        2018            122.0                       Drama       0      0   \n",
       "3        2018              NaN                Comedy,Drama       0      0   \n",
       "4        2017             80.0        Comedy,Drama,Fantasy       0      0   \n",
       "5        2018             75.0                      Comedy       0      0   \n",
       "6        2017              NaN             Horror,Thriller       0      0   \n",
       "7        2017             83.0  Adventure,Animation,Comedy       0      0   \n",
       "8        2012              NaN         Documentary,History       0      0   \n",
       "9        2012             82.0                   Biography       0      0   \n",
       "\n",
       "   Adventure  Animation  ...  Reality-TV  Romance  Sci-Fi  Short  Sport  \\\n",
       "0          0          0  ...           0        0       0      0      0   \n",
       "1          0          0  ...           0        0       0      0      0   \n",
       "2          0          0  ...           0        0       0      0      0   \n",
       "3          0          0  ...           0        0       0      0      0   \n",
       "4          0          0  ...           0        0       0      0      0   \n",
       "5          0          0  ...           0        0       0      0      0   \n",
       "6          0          0  ...           0        0       0      0      0   \n",
       "7          1          1  ...           0        0       0      0      0   \n",
       "8          0          0  ...           0        0       0      0      0   \n",
       "9          0          0  ...           0        0       0      0      0   \n",
       "\n",
       "   Talk-Show  Thriller  Unknown  War  Western  \n",
       "0          0         0        0    0        0  \n",
       "1          0         0        0    0        0  \n",
       "2          0         0        0    0        0  \n",
       "3          0         0        0    0        0  \n",
       "4          0         0        0    0        0  \n",
       "5          0         0        0    0        0  \n",
       "6          0         1        0    0        0  \n",
       "7          0         0        0    0        0  \n",
       "8          0         0        0    0        0  \n",
       "9          0         0        0    0        0  \n",
       "\n",
       "[10 rows x 34 columns]"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "imdb_titles_basics.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>primary_title</th>\n",
       "      <th>original_title</th>\n",
       "      <th>start_year</th>\n",
       "      <th>runtime_minutes</th>\n",
       "      <th>genres</th>\n",
       "      <th>Action</th>\n",
       "      <th>Adult</th>\n",
       "      <th>Adventure</th>\n",
       "      <th>Animation</th>\n",
       "      <th>...</th>\n",
       "      <th>Reality-TV</th>\n",
       "      <th>Romance</th>\n",
       "      <th>Sci-Fi</th>\n",
       "      <th>Short</th>\n",
       "      <th>Sport</th>\n",
       "      <th>Talk-Show</th>\n",
       "      <th>Thriller</th>\n",
       "      <th>Unknown</th>\n",
       "      <th>War</th>\n",
       "      <th>Western</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt0063540</td>\n",
       "      <td>sunghursh</td>\n",
       "      <td>Sunghursh</td>\n",
       "      <td>2013</td>\n",
       "      <td>175.0</td>\n",
       "      <td>Action,Crime,Drama</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt0066787</td>\n",
       "      <td>one_day_before_the_rainy_season</td>\n",
       "      <td>Ashad Ka Ek Din</td>\n",
       "      <td>2019</td>\n",
       "      <td>114.0</td>\n",
       "      <td>Biography,Drama</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt0069049</td>\n",
       "      <td>the_other_side_of_the_wind</td>\n",
       "      <td>The Other Side of the Wind</td>\n",
       "      <td>2018</td>\n",
       "      <td>122.0</td>\n",
       "      <td>Drama</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt0069204</td>\n",
       "      <td>sabse_bada_sukh</td>\n",
       "      <td>Sabse Bada Sukh</td>\n",
       "      <td>2018</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Comedy,Drama</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt0100275</td>\n",
       "      <td>the_wandering_soap_opera</td>\n",
       "      <td>La Telenovela Errante</td>\n",
       "      <td>2017</td>\n",
       "      <td>80.0</td>\n",
       "      <td>Comedy,Drama,Fantasy</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 34 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      tconst                    primary_title              original_title  \\\n",
       "0  tt0063540                        sunghursh                   Sunghursh   \n",
       "1  tt0066787  one_day_before_the_rainy_season             Ashad Ka Ek Din   \n",
       "2  tt0069049       the_other_side_of_the_wind  The Other Side of the Wind   \n",
       "3  tt0069204                  sabse_bada_sukh             Sabse Bada Sukh   \n",
       "4  tt0100275         the_wandering_soap_opera       La Telenovela Errante   \n",
       "\n",
       "   start_year  runtime_minutes                genres  Action  Adult  \\\n",
       "0        2013            175.0    Action,Crime,Drama       1      0   \n",
       "1        2019            114.0       Biography,Drama       0      0   \n",
       "2        2018            122.0                 Drama       0      0   \n",
       "3        2018              NaN          Comedy,Drama       0      0   \n",
       "4        2017             80.0  Comedy,Drama,Fantasy       0      0   \n",
       "\n",
       "   Adventure  Animation  ...  Reality-TV  Romance  Sci-Fi  Short  Sport  \\\n",
       "0          0          0  ...           0        0       0      0      0   \n",
       "1          0          0  ...           0        0       0      0      0   \n",
       "2          0          0  ...           0        0       0      0      0   \n",
       "3          0          0  ...           0        0       0      0      0   \n",
       "4          0          0  ...           0        0       0      0      0   \n",
       "\n",
       "   Talk-Show  Thriller  Unknown  War  Western  \n",
       "0          0         0        0    0        0  \n",
       "1          0         0        0    0        0  \n",
       "2          0         0        0    0        0  \n",
       "3          0         0        0    0        0  \n",
       "4          0         0        0    0        0  \n",
       "\n",
       "[5 rows x 34 columns]"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Preparing to join imdb_titles_basics wtih budgets dataframe\n",
    "# Since we will join both dataframes on movie titles, we should standardize titles. \n",
    "imdb_titles_basics['primary_title'] = imdb_titles_basics['primary_title'].str.replace(' ', '_').str.lower().str.replace('[^\\w\\s]','')\n",
    "imdb_titles_basics.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>release_date</th>\n",
       "      <th>movie</th>\n",
       "      <th>production_budget</th>\n",
       "      <th>domestic_gross</th>\n",
       "      <th>worldwide_gross</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>2009-12-18</td>\n",
       "      <td>avatar</td>\n",
       "      <td>$425,000,000</td>\n",
       "      <td>$760,507,625</td>\n",
       "      <td>$2,776,345,279</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>2011-05-20</td>\n",
       "      <td>pirates_of_the_caribbean_on_stranger_tides</td>\n",
       "      <td>$410,600,000</td>\n",
       "      <td>$241,063,875</td>\n",
       "      <td>$1,045,663,875</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>2019-06-07</td>\n",
       "      <td>dark_phoenix</td>\n",
       "      <td>$350,000,000</td>\n",
       "      <td>$42,762,350</td>\n",
       "      <td>$149,762,350</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>2015-05-01</td>\n",
       "      <td>avengers_age_of_ultron</td>\n",
       "      <td>$330,600,000</td>\n",
       "      <td>$459,005,868</td>\n",
       "      <td>$1,403,013,963</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>2017-12-15</td>\n",
       "      <td>star_wars_ep_viii_the_last_jedi</td>\n",
       "      <td>$317,000,000</td>\n",
       "      <td>$620,181,382</td>\n",
       "      <td>$1,316,721,747</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   id release_date                                       movie  \\\n",
       "0   1   2009-12-18                                      avatar   \n",
       "1   2   2011-05-20  pirates_of_the_caribbean_on_stranger_tides   \n",
       "2   3   2019-06-07                                dark_phoenix   \n",
       "3   4   2015-05-01                      avengers_age_of_ultron   \n",
       "4   5   2017-12-15             star_wars_ep_viii_the_last_jedi   \n",
       "\n",
       "  production_budget domestic_gross worldwide_gross  \n",
       "0      $425,000,000   $760,507,625  $2,776,345,279  \n",
       "1      $410,600,000   $241,063,875  $1,045,663,875  \n",
       "2      $350,000,000    $42,762,350    $149,762,350  \n",
       "3      $330,600,000   $459,005,868  $1,403,013,963  \n",
       "4      $317,000,000   $620,181,382  $1,316,721,747  "
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "budgets['movie'] = budgets['movie'].str.replace(' ', '_').str.lower().str.replace('[^\\w\\s]','')\n",
    "budgets.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>primary_title</th>\n",
       "      <th>start_year</th>\n",
       "      <th>genres</th>\n",
       "      <th>Action</th>\n",
       "      <th>Adult</th>\n",
       "      <th>Adventure</th>\n",
       "      <th>Animation</th>\n",
       "      <th>Biography</th>\n",
       "      <th>Comedy</th>\n",
       "      <th>...</th>\n",
       "      <th>Reality-TV</th>\n",
       "      <th>Romance</th>\n",
       "      <th>Sci-Fi</th>\n",
       "      <th>Short</th>\n",
       "      <th>Sport</th>\n",
       "      <th>Talk-Show</th>\n",
       "      <th>Thriller</th>\n",
       "      <th>Unknown</th>\n",
       "      <th>War</th>\n",
       "      <th>Western</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt0063540</td>\n",
       "      <td>sunghursh</td>\n",
       "      <td>2013</td>\n",
       "      <td>Action,Crime,Drama</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt0066787</td>\n",
       "      <td>one_day_before_the_rainy_season</td>\n",
       "      <td>2019</td>\n",
       "      <td>Biography,Drama</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt0069049</td>\n",
       "      <td>the_other_side_of_the_wind</td>\n",
       "      <td>2018</td>\n",
       "      <td>Drama</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt0069204</td>\n",
       "      <td>sabse_bada_sukh</td>\n",
       "      <td>2018</td>\n",
       "      <td>Comedy,Drama</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt0100275</td>\n",
       "      <td>the_wandering_soap_opera</td>\n",
       "      <td>2017</td>\n",
       "      <td>Comedy,Drama,Fantasy</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 32 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      tconst                    primary_title  start_year  \\\n",
       "0  tt0063540                        sunghursh        2013   \n",
       "1  tt0066787  one_day_before_the_rainy_season        2019   \n",
       "2  tt0069049       the_other_side_of_the_wind        2018   \n",
       "3  tt0069204                  sabse_bada_sukh        2018   \n",
       "4  tt0100275         the_wandering_soap_opera        2017   \n",
       "\n",
       "                 genres  Action  Adult  Adventure  Animation  Biography  \\\n",
       "0    Action,Crime,Drama       1      0          0          0          0   \n",
       "1       Biography,Drama       0      0          0          0          1   \n",
       "2                 Drama       0      0          0          0          0   \n",
       "3          Comedy,Drama       0      0          0          0          0   \n",
       "4  Comedy,Drama,Fantasy       0      0          0          0          0   \n",
       "\n",
       "   Comedy  ...  Reality-TV  Romance  Sci-Fi  Short  Sport  Talk-Show  \\\n",
       "0       0  ...           0        0       0      0      0          0   \n",
       "1       0  ...           0        0       0      0      0          0   \n",
       "2       0  ...           0        0       0      0      0          0   \n",
       "3       1  ...           0        0       0      0      0          0   \n",
       "4       1  ...           0        0       0      0      0          0   \n",
       "\n",
       "   Thriller  Unknown  War  Western  \n",
       "0         0        0    0        0  \n",
       "1         0        0    0        0  \n",
       "2         0        0    0        0  \n",
       "3         0        0    0        0  \n",
       "4         0        0    0        0  \n",
       "\n",
       "[5 rows x 32 columns]"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Drop unneeded columns in IMDB dataframe. \n",
    "imdb = imdb_titles_basics.drop(columns = ['original_title', 'runtime_minutes'])\n",
    "imdb.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Sort by title identifier to see movies in alphabetical order\n",
    "imdb = imdb.sort_values(by=['primary_title'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Check for rows with duplicate titles and years in IMDB dataframe \n",
    "imdb_dupes = imdb.loc[imdb.duplicated(subset=['primary_title', 'start_year'], keep=False) == True]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(4290, 32)"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "imdb_dupes.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.029354609152616597"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Reminding myself the size of total dataset and calculating what % of it is duplicated data \n",
    "imdb.shape\n",
    "4290/146144"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# Duplicates account for less than 3% of data; I'm going to drop them because they are inaccurate. \n",
    "# For example the film \"88\" was researched and it is a thriller, not a family or documentary film.\n",
    "imdb_clean = imdb.drop_duplicates(subset=['primary_title','start_year'], keep=False,)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>movie</th>\n",
       "      <th>start_year</th>\n",
       "      <th>genres</th>\n",
       "      <th>Action</th>\n",
       "      <th>Adult</th>\n",
       "      <th>Adventure</th>\n",
       "      <th>Animation</th>\n",
       "      <th>Biography</th>\n",
       "      <th>Comedy</th>\n",
       "      <th>...</th>\n",
       "      <th>Reality-TV</th>\n",
       "      <th>Romance</th>\n",
       "      <th>Sci-Fi</th>\n",
       "      <th>Short</th>\n",
       "      <th>Sport</th>\n",
       "      <th>Talk-Show</th>\n",
       "      <th>Thriller</th>\n",
       "      <th>Unknown</th>\n",
       "      <th>War</th>\n",
       "      <th>Western</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4642</th>\n",
       "      <td>tt10423688</td>\n",
       "      <td></td>\n",
       "      <td>2019</td>\n",
       "      <td>Fantasy,Sci-Fi</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>107424</th>\n",
       "      <td>tt6290346</td>\n",
       "      <td></td>\n",
       "      <td>2013</td>\n",
       "      <td>Crime,Documentary</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>139783</th>\n",
       "      <td>tt9046926</td>\n",
       "      <td>0000_a_shark_odyssey</td>\n",
       "      <td>2018</td>\n",
       "      <td>Animation,Comedy,Musical</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>145395</th>\n",
       "      <td>tt9811798</td>\n",
       "      <td>0009_the_sharks_make_contact</td>\n",
       "      <td>2019</td>\n",
       "      <td>Animation,Comedy,Musical</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3174</th>\n",
       "      <td>tt10315070</td>\n",
       "      <td>0010_the_sharks_make_contact__part_2</td>\n",
       "      <td>2020</td>\n",
       "      <td>Animation,Comedy,Sci-Fi</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>143884</th>\n",
       "      <td>tt9598594</td>\n",
       "      <td>üç_harfliler_adak</td>\n",
       "      <td>2019</td>\n",
       "      <td>Horror,Thriller</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>134885</th>\n",
       "      <td>tt8514766</td>\n",
       "      <td>üç_harflilerin_musallat_oldugu_büyülü_konakta_...</td>\n",
       "      <td>2018</td>\n",
       "      <td>Comedy,Horror,Thriller</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77156</th>\n",
       "      <td>tt4422510</td>\n",
       "      <td>üç_iki_bir_kestik</td>\n",
       "      <td>2014</td>\n",
       "      <td>Comedy</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>114079</th>\n",
       "      <td>tt6735450</td>\n",
       "      <td>üçüncü_bölgeden_hücum_varyasyonlari</td>\n",
       "      <td>2017</td>\n",
       "      <td>Documentary,Sport</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>76481</th>\n",
       "      <td>tt4373884</td>\n",
       "      <td>šiška_deluxe</td>\n",
       "      <td>2015</td>\n",
       "      <td>Comedy,Drama</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>141854 rows × 32 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            tconst                                              movie  \\\n",
       "4642    tt10423688                                                      \n",
       "107424   tt6290346                                                      \n",
       "139783   tt9046926                               0000_a_shark_odyssey   \n",
       "145395   tt9811798                       0009_the_sharks_make_contact   \n",
       "3174    tt10315070               0010_the_sharks_make_contact__part_2   \n",
       "...            ...                                                ...   \n",
       "143884   tt9598594                                  üç_harfliler_adak   \n",
       "134885   tt8514766  üç_harflilerin_musallat_oldugu_büyülü_konakta_...   \n",
       "77156    tt4422510                                  üç_iki_bir_kestik   \n",
       "114079   tt6735450                üçüncü_bölgeden_hücum_varyasyonlari   \n",
       "76481    tt4373884                                       šiška_deluxe   \n",
       "\n",
       "        start_year                    genres  Action  Adult  Adventure  \\\n",
       "4642          2019            Fantasy,Sci-Fi       0      0          0   \n",
       "107424        2013         Crime,Documentary       0      0          0   \n",
       "139783        2018  Animation,Comedy,Musical       0      0          0   \n",
       "145395        2019  Animation,Comedy,Musical       0      0          0   \n",
       "3174          2020   Animation,Comedy,Sci-Fi       0      0          0   \n",
       "...            ...                       ...     ...    ...        ...   \n",
       "143884        2019           Horror,Thriller       0      0          0   \n",
       "134885        2018    Comedy,Horror,Thriller       0      0          0   \n",
       "77156         2014                    Comedy       0      0          0   \n",
       "114079        2017         Documentary,Sport       0      0          0   \n",
       "76481         2015              Comedy,Drama       0      0          0   \n",
       "\n",
       "        Animation  Biography  Comedy  ...  Reality-TV  Romance  Sci-Fi  Short  \\\n",
       "4642            0          0       0  ...           0        0       1      0   \n",
       "107424          0          0       0  ...           0        0       0      0   \n",
       "139783          1          0       1  ...           0        0       0      0   \n",
       "145395          1          0       1  ...           0        0       0      0   \n",
       "3174            1          0       1  ...           0        0       1      0   \n",
       "...           ...        ...     ...  ...         ...      ...     ...    ...   \n",
       "143884          0          0       0  ...           0        0       0      0   \n",
       "134885          0          0       1  ...           0        0       0      0   \n",
       "77156           0          0       1  ...           0        0       0      0   \n",
       "114079          0          0       0  ...           0        0       0      0   \n",
       "76481           0          0       1  ...           0        0       0      0   \n",
       "\n",
       "        Sport  Talk-Show  Thriller  Unknown  War  Western  \n",
       "4642        0          0         0        0    0        0  \n",
       "107424      0          0         0        0    0        0  \n",
       "139783      0          0         0        0    0        0  \n",
       "145395      0          0         0        0    0        0  \n",
       "3174        0          0         0        0    0        0  \n",
       "...       ...        ...       ...      ...  ...      ...  \n",
       "143884      0          0         1        0    0        0  \n",
       "134885      0          0         1        0    0        0  \n",
       "77156       0          0         0        0    0        0  \n",
       "114079      1          0         0        0    0        0  \n",
       "76481       0          0         0        0    0        0  \n",
       "\n",
       "[141854 rows x 32 columns]"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Rename \"primary_title\" column to \"movie\" to match budgets dataframe \n",
    "imdb_clean = imdb_clean.rename(columns={\"primary_title\": \"movie\"})\n",
    "imdb_clean"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>release_date</th>\n",
       "      <th>movie</th>\n",
       "      <th>production_budget</th>\n",
       "      <th>domestic_gross</th>\n",
       "      <th>worldwide_gross</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>350</th>\n",
       "      <td>51</td>\n",
       "      <td>2008-03-07</td>\n",
       "      <td>10000_bc</td>\n",
       "      <td>$105,000,000</td>\n",
       "      <td>$94,784,201</td>\n",
       "      <td>$269,065,678</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>505</th>\n",
       "      <td>6</td>\n",
       "      <td>2000-11-22</td>\n",
       "      <td>102_dalmatians</td>\n",
       "      <td>$85,000,000</td>\n",
       "      <td>$66,941,559</td>\n",
       "      <td>$66,941,559</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4253</th>\n",
       "      <td>54</td>\n",
       "      <td>2016-03-11</td>\n",
       "      <td>10_cloverfield_lane</td>\n",
       "      <td>$5,000,000</td>\n",
       "      <td>$72,082,999</td>\n",
       "      <td>$108,286,422</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3447</th>\n",
       "      <td>48</td>\n",
       "      <td>2015-11-11</td>\n",
       "      <td>10_days_in_a_madhouse</td>\n",
       "      <td>$12,000,000</td>\n",
       "      <td>$14,616</td>\n",
       "      <td>$14,616</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3262</th>\n",
       "      <td>63</td>\n",
       "      <td>1999-03-31</td>\n",
       "      <td>10_things_i_hate_about_you</td>\n",
       "      <td>$13,000,000</td>\n",
       "      <td>$38,177,966</td>\n",
       "      <td>$60,413,950</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>156</th>\n",
       "      <td>57</td>\n",
       "      <td>2016-03-04</td>\n",
       "      <td>zootopia</td>\n",
       "      <td>$150,000,000</td>\n",
       "      <td>$341,268,248</td>\n",
       "      <td>$1,019,429,616</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2981</th>\n",
       "      <td>82</td>\n",
       "      <td>2013-12-31</td>\n",
       "      <td>zulu</td>\n",
       "      <td>$16,000,000</td>\n",
       "      <td>$0</td>\n",
       "      <td>$1,844,228</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2447</th>\n",
       "      <td>48</td>\n",
       "      <td>2007-04-06</td>\n",
       "      <td>zwartboek</td>\n",
       "      <td>$22,000,000</td>\n",
       "      <td>$4,398,532</td>\n",
       "      <td>$27,238,354</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4756</th>\n",
       "      <td>57</td>\n",
       "      <td>2008-04-15</td>\n",
       "      <td>ã_lintãrieur</td>\n",
       "      <td>$3,000,000</td>\n",
       "      <td>$0</td>\n",
       "      <td>$895,932</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2701</th>\n",
       "      <td>2</td>\n",
       "      <td>2008-03-07</td>\n",
       "      <td>éæäè_cj7</td>\n",
       "      <td>$20,000,000</td>\n",
       "      <td>$206,678</td>\n",
       "      <td>$47,300,771</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5782 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      id release_date                       movie production_budget  \\\n",
       "350   51   2008-03-07                    10000_bc      $105,000,000   \n",
       "505    6   2000-11-22              102_dalmatians       $85,000,000   \n",
       "4253  54   2016-03-11         10_cloverfield_lane        $5,000,000   \n",
       "3447  48   2015-11-11       10_days_in_a_madhouse       $12,000,000   \n",
       "3262  63   1999-03-31  10_things_i_hate_about_you       $13,000,000   \n",
       "...   ..          ...                         ...               ...   \n",
       "156   57   2016-03-04                    zootopia      $150,000,000   \n",
       "2981  82   2013-12-31                        zulu       $16,000,000   \n",
       "2447  48   2007-04-06                   zwartboek       $22,000,000   \n",
       "4756  57   2008-04-15                ã_lintãrieur        $3,000,000   \n",
       "2701   2   2008-03-07                    éæäè_cj7       $20,000,000   \n",
       "\n",
       "     domestic_gross worldwide_gross  \n",
       "350     $94,784,201    $269,065,678  \n",
       "505     $66,941,559     $66,941,559  \n",
       "4253    $72,082,999    $108,286,422  \n",
       "3447        $14,616         $14,616  \n",
       "3262    $38,177,966     $60,413,950  \n",
       "...             ...             ...  \n",
       "156    $341,268,248  $1,019,429,616  \n",
       "2981             $0      $1,844,228  \n",
       "2447     $4,398,532     $27,238,354  \n",
       "4756             $0        $895,932  \n",
       "2701       $206,678     $47,300,771  \n",
       "\n",
       "[5782 rows x 6 columns]"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Repeat cleaning process for budgets dataframe: sort by titles in alphabetical order.\n",
    "budgets = budgets.sort_values(by=['movie'])\n",
    "budgets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>release_date</th>\n",
       "      <th>movie</th>\n",
       "      <th>production_budget</th>\n",
       "      <th>domestic_gross</th>\n",
       "      <th>worldwide_gross</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4270</th>\n",
       "      <td>71</td>\n",
       "      <td>1954-12-23</td>\n",
       "      <td>20000_leagues_under_the_sea</td>\n",
       "      <td>$5,000,000</td>\n",
       "      <td>$28,200,000</td>\n",
       "      <td>$28,200,000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5614</th>\n",
       "      <td>15</td>\n",
       "      <td>1916-12-24</td>\n",
       "      <td>20000_leagues_under_the_sea</td>\n",
       "      <td>$200,000</td>\n",
       "      <td>$8,000,000</td>\n",
       "      <td>$8,000,000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1648</th>\n",
       "      <td>49</td>\n",
       "      <td>2010-04-30</td>\n",
       "      <td>a_nightmare_on_elm_street</td>\n",
       "      <td>$35,000,000</td>\n",
       "      <td>$63,075,011</td>\n",
       "      <td>$117,729,621</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5016</th>\n",
       "      <td>17</td>\n",
       "      <td>1984-11-09</td>\n",
       "      <td>a_nightmare_on_elm_street</td>\n",
       "      <td>$1,800,000</td>\n",
       "      <td>$25,504,513</td>\n",
       "      <td>$25,504,513</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2032</th>\n",
       "      <td>33</td>\n",
       "      <td>1992-11-11</td>\n",
       "      <td>aladdin</td>\n",
       "      <td>$28,000,000</td>\n",
       "      <td>$217,350,219</td>\n",
       "      <td>$504,050,219</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2838</th>\n",
       "      <td>39</td>\n",
       "      <td>1996-02-23</td>\n",
       "      <td>unforgettable</td>\n",
       "      <td>$18,000,000</td>\n",
       "      <td>$2,483,790</td>\n",
       "      <td>$2,483,790</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4583</th>\n",
       "      <td>84</td>\n",
       "      <td>2006-11-03</td>\n",
       "      <td>unknown</td>\n",
       "      <td>$3,700,000</td>\n",
       "      <td>$26,403</td>\n",
       "      <td>$3,355,048</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1420</th>\n",
       "      <td>21</td>\n",
       "      <td>2011-02-18</td>\n",
       "      <td>unknown</td>\n",
       "      <td>$40,000,000</td>\n",
       "      <td>$63,686,397</td>\n",
       "      <td>$136,123,083</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>302</th>\n",
       "      <td>3</td>\n",
       "      <td>2018-10-05</td>\n",
       "      <td>venom</td>\n",
       "      <td>$116,000,000</td>\n",
       "      <td>$213,511,408</td>\n",
       "      <td>$853,628,605</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2313</th>\n",
       "      <td>14</td>\n",
       "      <td>2005-09-16</td>\n",
       "      <td>venom</td>\n",
       "      <td>$25,000,000</td>\n",
       "      <td>$881,745</td>\n",
       "      <td>$881,745</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>165 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      id release_date                        movie production_budget  \\\n",
       "4270  71   1954-12-23  20000_leagues_under_the_sea        $5,000,000   \n",
       "5614  15   1916-12-24  20000_leagues_under_the_sea          $200,000   \n",
       "1648  49   2010-04-30    a_nightmare_on_elm_street       $35,000,000   \n",
       "5016  17   1984-11-09    a_nightmare_on_elm_street        $1,800,000   \n",
       "2032  33   1992-11-11                      aladdin       $28,000,000   \n",
       "...   ..          ...                          ...               ...   \n",
       "2838  39   1996-02-23                unforgettable       $18,000,000   \n",
       "4583  84   2006-11-03                      unknown        $3,700,000   \n",
       "1420  21   2011-02-18                      unknown       $40,000,000   \n",
       "302    3   2018-10-05                        venom      $116,000,000   \n",
       "2313  14   2005-09-16                        venom       $25,000,000   \n",
       "\n",
       "     domestic_gross worldwide_gross  \n",
       "4270    $28,200,000     $28,200,000  \n",
       "5614     $8,000,000      $8,000,000  \n",
       "1648    $63,075,011    $117,729,621  \n",
       "5016    $25,504,513     $25,504,513  \n",
       "2032   $217,350,219    $504,050,219  \n",
       "...             ...             ...  \n",
       "2838     $2,483,790      $2,483,790  \n",
       "4583        $26,403      $3,355,048  \n",
       "1420    $63,686,397    $136,123,083  \n",
       "302    $213,511,408    $853,628,605  \n",
       "2313       $881,745        $881,745  \n",
       "\n",
       "[165 rows x 6 columns]"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Create a dupes dataframe to figure out how we will handle these; and create new clean_budgets dataframe. \n",
    "budgets_dupes = budgets.loc[budgets.duplicated(subset=['movie'], keep=False) == True]\n",
    "budgets_dupes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(165, 6)\n",
      "(5782, 6)\n",
      "0.02853683846419924\n"
     ]
    }
   ],
   "source": [
    "print(budgets_dupes.shape)\n",
    "print(budgets.shape)\n",
    "print(165/5782)\n",
    "# Duplicate movies in the budgets dataframe constitute less than 3% of the data, like in the imdb dataframe. \n",
    "# However, in this case the data seems to be more reliable -- most release dates appear to be different and, as seen\n",
    "# above, most of the duplicate titles seem to be remakes. For these reasons, I'll keep the duplicate data in this case. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>movie</th>\n",
       "      <th>start_year</th>\n",
       "      <th>genres</th>\n",
       "      <th>Action</th>\n",
       "      <th>Adult</th>\n",
       "      <th>Adventure</th>\n",
       "      <th>Animation</th>\n",
       "      <th>Biography</th>\n",
       "      <th>Comedy</th>\n",
       "      <th>...</th>\n",
       "      <th>Romance</th>\n",
       "      <th>Sci-Fi</th>\n",
       "      <th>Short</th>\n",
       "      <th>Sport</th>\n",
       "      <th>Talk-Show</th>\n",
       "      <th>Thriller</th>\n",
       "      <th>Unknown</th>\n",
       "      <th>War</th>\n",
       "      <th>Western</th>\n",
       "      <th>movie_year</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4642</th>\n",
       "      <td>tt10423688</td>\n",
       "      <td></td>\n",
       "      <td>2019</td>\n",
       "      <td>Fantasy,Sci-Fi</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2019</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>107424</th>\n",
       "      <td>tt6290346</td>\n",
       "      <td></td>\n",
       "      <td>2013</td>\n",
       "      <td>Crime,Documentary</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>139783</th>\n",
       "      <td>tt9046926</td>\n",
       "      <td>0000_a_shark_odyssey</td>\n",
       "      <td>2018</td>\n",
       "      <td>Animation,Comedy,Musical</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0000_a_shark_odyssey 2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>145395</th>\n",
       "      <td>tt9811798</td>\n",
       "      <td>0009_the_sharks_make_contact</td>\n",
       "      <td>2019</td>\n",
       "      <td>Animation,Comedy,Musical</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0009_the_sharks_make_contact 2019</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3174</th>\n",
       "      <td>tt10315070</td>\n",
       "      <td>0010_the_sharks_make_contact__part_2</td>\n",
       "      <td>2020</td>\n",
       "      <td>Animation,Comedy,Sci-Fi</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0010_the_sharks_make_contact__part_2 2020</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>143884</th>\n",
       "      <td>tt9598594</td>\n",
       "      <td>üç_harfliler_adak</td>\n",
       "      <td>2019</td>\n",
       "      <td>Horror,Thriller</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>üç_harfliler_adak 2019</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>134885</th>\n",
       "      <td>tt8514766</td>\n",
       "      <td>üç_harflilerin_musallat_oldugu_büyülü_konakta_...</td>\n",
       "      <td>2018</td>\n",
       "      <td>Comedy,Horror,Thriller</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>üç_harflilerin_musallat_oldugu_büyülü_konakta_...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77156</th>\n",
       "      <td>tt4422510</td>\n",
       "      <td>üç_iki_bir_kestik</td>\n",
       "      <td>2014</td>\n",
       "      <td>Comedy</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>üç_iki_bir_kestik 2014</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>114079</th>\n",
       "      <td>tt6735450</td>\n",
       "      <td>üçüncü_bölgeden_hücum_varyasyonlari</td>\n",
       "      <td>2017</td>\n",
       "      <td>Documentary,Sport</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>üçüncü_bölgeden_hücum_varyasyonlari 2017</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>76481</th>\n",
       "      <td>tt4373884</td>\n",
       "      <td>šiška_deluxe</td>\n",
       "      <td>2015</td>\n",
       "      <td>Comedy,Drama</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>šiška_deluxe 2015</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>141854 rows × 33 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            tconst                                              movie  \\\n",
       "4642    tt10423688                                                      \n",
       "107424   tt6290346                                                      \n",
       "139783   tt9046926                               0000_a_shark_odyssey   \n",
       "145395   tt9811798                       0009_the_sharks_make_contact   \n",
       "3174    tt10315070               0010_the_sharks_make_contact__part_2   \n",
       "...            ...                                                ...   \n",
       "143884   tt9598594                                  üç_harfliler_adak   \n",
       "134885   tt8514766  üç_harflilerin_musallat_oldugu_büyülü_konakta_...   \n",
       "77156    tt4422510                                  üç_iki_bir_kestik   \n",
       "114079   tt6735450                üçüncü_bölgeden_hücum_varyasyonlari   \n",
       "76481    tt4373884                                       šiška_deluxe   \n",
       "\n",
       "        start_year                    genres  Action  Adult  Adventure  \\\n",
       "4642          2019            Fantasy,Sci-Fi       0      0          0   \n",
       "107424        2013         Crime,Documentary       0      0          0   \n",
       "139783        2018  Animation,Comedy,Musical       0      0          0   \n",
       "145395        2019  Animation,Comedy,Musical       0      0          0   \n",
       "3174          2020   Animation,Comedy,Sci-Fi       0      0          0   \n",
       "...            ...                       ...     ...    ...        ...   \n",
       "143884        2019           Horror,Thriller       0      0          0   \n",
       "134885        2018    Comedy,Horror,Thriller       0      0          0   \n",
       "77156         2014                    Comedy       0      0          0   \n",
       "114079        2017         Documentary,Sport       0      0          0   \n",
       "76481         2015              Comedy,Drama       0      0          0   \n",
       "\n",
       "        Animation  Biography  Comedy  ...  Romance  Sci-Fi  Short  Sport  \\\n",
       "4642            0          0       0  ...        0       1      0      0   \n",
       "107424          0          0       0  ...        0       0      0      0   \n",
       "139783          1          0       1  ...        0       0      0      0   \n",
       "145395          1          0       1  ...        0       0      0      0   \n",
       "3174            1          0       1  ...        0       1      0      0   \n",
       "...           ...        ...     ...  ...      ...     ...    ...    ...   \n",
       "143884          0          0       0  ...        0       0      0      0   \n",
       "134885          0          0       1  ...        0       0      0      0   \n",
       "77156           0          0       1  ...        0       0      0      0   \n",
       "114079          0          0       0  ...        0       0      0      1   \n",
       "76481           0          0       1  ...        0       0      0      0   \n",
       "\n",
       "        Talk-Show  Thriller  Unknown  War  Western  \\\n",
       "4642            0         0        0    0        0   \n",
       "107424          0         0        0    0        0   \n",
       "139783          0         0        0    0        0   \n",
       "145395          0         0        0    0        0   \n",
       "3174            0         0        0    0        0   \n",
       "...           ...       ...      ...  ...      ...   \n",
       "143884          0         1        0    0        0   \n",
       "134885          0         1        0    0        0   \n",
       "77156           0         0        0    0        0   \n",
       "114079          0         0        0    0        0   \n",
       "76481           0         0        0    0        0   \n",
       "\n",
       "                                               movie_year  \n",
       "4642                                                 2019  \n",
       "107424                                               2013  \n",
       "139783                          0000_a_shark_odyssey 2018  \n",
       "145395                  0009_the_sharks_make_contact 2019  \n",
       "3174            0010_the_sharks_make_contact__part_2 2020  \n",
       "...                                                   ...  \n",
       "143884                             üç_harfliler_adak 2019  \n",
       "134885  üç_harflilerin_musallat_oldugu_büyülü_konakta_...  \n",
       "77156                              üç_iki_bir_kestik 2014  \n",
       "114079           üçüncü_bölgeden_hücum_varyasyonlari 2017  \n",
       "76481                                   šiška_deluxe 2015  \n",
       "\n",
       "[141854 rows x 33 columns]"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Before merging, create a new movie-year column to try to reduce duplicates further. \n",
    "imdb_clean['movie_year'] = imdb_clean['movie'] + \" \" + imdb_clean['start_year'].astype('str')\n",
    "imdb_clean"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>release_date</th>\n",
       "      <th>movie</th>\n",
       "      <th>production_budget</th>\n",
       "      <th>domestic_gross</th>\n",
       "      <th>worldwide_gross</th>\n",
       "      <th>year</th>\n",
       "      <th>movie_year</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>350</th>\n",
       "      <td>51</td>\n",
       "      <td>2008-03-07</td>\n",
       "      <td>10000_bc</td>\n",
       "      <td>$105,000,000</td>\n",
       "      <td>$94,784,201</td>\n",
       "      <td>$269,065,678</td>\n",
       "      <td>2008</td>\n",
       "      <td>10000_bc 2008</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>505</th>\n",
       "      <td>6</td>\n",
       "      <td>2000-11-22</td>\n",
       "      <td>102_dalmatians</td>\n",
       "      <td>$85,000,000</td>\n",
       "      <td>$66,941,559</td>\n",
       "      <td>$66,941,559</td>\n",
       "      <td>2000</td>\n",
       "      <td>102_dalmatians 2000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4253</th>\n",
       "      <td>54</td>\n",
       "      <td>2016-03-11</td>\n",
       "      <td>10_cloverfield_lane</td>\n",
       "      <td>$5,000,000</td>\n",
       "      <td>$72,082,999</td>\n",
       "      <td>$108,286,422</td>\n",
       "      <td>2016</td>\n",
       "      <td>10_cloverfield_lane 2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3447</th>\n",
       "      <td>48</td>\n",
       "      <td>2015-11-11</td>\n",
       "      <td>10_days_in_a_madhouse</td>\n",
       "      <td>$12,000,000</td>\n",
       "      <td>$14,616</td>\n",
       "      <td>$14,616</td>\n",
       "      <td>2015</td>\n",
       "      <td>10_days_in_a_madhouse 2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3262</th>\n",
       "      <td>63</td>\n",
       "      <td>1999-03-31</td>\n",
       "      <td>10_things_i_hate_about_you</td>\n",
       "      <td>$13,000,000</td>\n",
       "      <td>$38,177,966</td>\n",
       "      <td>$60,413,950</td>\n",
       "      <td>1999</td>\n",
       "      <td>10_things_i_hate_about_you 1999</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      id release_date                       movie production_budget  \\\n",
       "350   51   2008-03-07                    10000_bc      $105,000,000   \n",
       "505    6   2000-11-22              102_dalmatians       $85,000,000   \n",
       "4253  54   2016-03-11         10_cloverfield_lane        $5,000,000   \n",
       "3447  48   2015-11-11       10_days_in_a_madhouse       $12,000,000   \n",
       "3262  63   1999-03-31  10_things_i_hate_about_you       $13,000,000   \n",
       "\n",
       "     domestic_gross worldwide_gross  year                       movie_year  \n",
       "350     $94,784,201    $269,065,678  2008                    10000_bc 2008  \n",
       "505     $66,941,559     $66,941,559  2000              102_dalmatians 2000  \n",
       "4253    $72,082,999    $108,286,422  2016         10_cloverfield_lane 2016  \n",
       "3447        $14,616         $14,616  2015       10_days_in_a_madhouse 2015  \n",
       "3262    $38,177,966     $60,413,950  1999  10_things_i_hate_about_you 1999  "
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Do the same with budgets dataframe\n",
    "budgets['year'] = pd.DatetimeIndex(budgets['release_date']).year\n",
    "budgets['movie_year'] = budgets['movie'] + \" \" + budgets['year'].astype('str')\n",
    "budgets.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>movie_x</th>\n",
       "      <th>start_year</th>\n",
       "      <th>genres</th>\n",
       "      <th>Action</th>\n",
       "      <th>Adult</th>\n",
       "      <th>Adventure</th>\n",
       "      <th>Animation</th>\n",
       "      <th>Biography</th>\n",
       "      <th>Comedy</th>\n",
       "      <th>...</th>\n",
       "      <th>War</th>\n",
       "      <th>Western</th>\n",
       "      <th>movie_year</th>\n",
       "      <th>id</th>\n",
       "      <th>release_date</th>\n",
       "      <th>movie_y</th>\n",
       "      <th>production_budget</th>\n",
       "      <th>domestic_gross</th>\n",
       "      <th>worldwide_gross</th>\n",
       "      <th>year</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt1179933</td>\n",
       "      <td>10_cloverfield_lane</td>\n",
       "      <td>2016</td>\n",
       "      <td>Drama,Horror,Mystery</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>10_cloverfield_lane 2016</td>\n",
       "      <td>54</td>\n",
       "      <td>2016-03-11</td>\n",
       "      <td>10_cloverfield_lane</td>\n",
       "      <td>$5,000,000</td>\n",
       "      <td>$72,082,999</td>\n",
       "      <td>$108,286,422</td>\n",
       "      <td>2016</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt3453052</td>\n",
       "      <td>10_days_in_a_madhouse</td>\n",
       "      <td>2015</td>\n",
       "      <td>Drama</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>10_days_in_a_madhouse 2015</td>\n",
       "      <td>48</td>\n",
       "      <td>2015-11-11</td>\n",
       "      <td>10_days_in_a_madhouse</td>\n",
       "      <td>$12,000,000</td>\n",
       "      <td>$14,616</td>\n",
       "      <td>$14,616</td>\n",
       "      <td>2015</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt1542344</td>\n",
       "      <td>127_hours</td>\n",
       "      <td>2010</td>\n",
       "      <td>Adventure,Biography,Drama</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>127_hours 2010</td>\n",
       "      <td>6</td>\n",
       "      <td>2010-11-05</td>\n",
       "      <td>127_hours</td>\n",
       "      <td>$18,000,000</td>\n",
       "      <td>$18,335,230</td>\n",
       "      <td>$60,217,171</td>\n",
       "      <td>2010</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt1413492</td>\n",
       "      <td>12_strong</td>\n",
       "      <td>2018</td>\n",
       "      <td>Action,Drama,History</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>12_strong 2018</td>\n",
       "      <td>64</td>\n",
       "      <td>2018-01-19</td>\n",
       "      <td>12_strong</td>\n",
       "      <td>$35,000,000</td>\n",
       "      <td>$45,819,713</td>\n",
       "      <td>$71,118,378</td>\n",
       "      <td>2018</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt2024544</td>\n",
       "      <td>12_years_a_slave</td>\n",
       "      <td>2013</td>\n",
       "      <td>Biography,Drama,History</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>12_years_a_slave 2013</td>\n",
       "      <td>18</td>\n",
       "      <td>2013-10-18</td>\n",
       "      <td>12_years_a_slave</td>\n",
       "      <td>$20,000,000</td>\n",
       "      <td>$56,671,993</td>\n",
       "      <td>$181,025,343</td>\n",
       "      <td>2013</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 40 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "      tconst                movie_x  start_year                     genres  \\\n",
       "0  tt1179933    10_cloverfield_lane        2016       Drama,Horror,Mystery   \n",
       "1  tt3453052  10_days_in_a_madhouse        2015                      Drama   \n",
       "2  tt1542344              127_hours        2010  Adventure,Biography,Drama   \n",
       "3  tt1413492              12_strong        2018       Action,Drama,History   \n",
       "4  tt2024544       12_years_a_slave        2013    Biography,Drama,History   \n",
       "\n",
       "   Action  Adult  Adventure  Animation  Biography  Comedy  ...  War  Western  \\\n",
       "0       0      0          0          0          0       0  ...    0        0   \n",
       "1       0      0          0          0          0       0  ...    0        0   \n",
       "2       0      0          1          0          1       0  ...    0        0   \n",
       "3       1      0          0          0          0       0  ...    0        0   \n",
       "4       0      0          0          0          1       0  ...    0        0   \n",
       "\n",
       "                   movie_year  id  release_date                movie_y  \\\n",
       "0    10_cloverfield_lane 2016  54    2016-03-11    10_cloverfield_lane   \n",
       "1  10_days_in_a_madhouse 2015  48    2015-11-11  10_days_in_a_madhouse   \n",
       "2              127_hours 2010   6    2010-11-05              127_hours   \n",
       "3              12_strong 2018  64    2018-01-19              12_strong   \n",
       "4       12_years_a_slave 2013  18    2013-10-18       12_years_a_slave   \n",
       "\n",
       "   production_budget  domestic_gross  worldwide_gross  year  \n",
       "0         $5,000,000     $72,082,999     $108,286,422  2016  \n",
       "1        $12,000,000         $14,616          $14,616  2015  \n",
       "2        $18,000,000     $18,335,230      $60,217,171  2010  \n",
       "3        $35,000,000     $45,819,713      $71,118,378  2018  \n",
       "4        $20,000,000     $56,671,993     $181,025,343  2013  \n",
       "\n",
       "[5 rows x 40 columns]"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Merge\n",
    "imdb_budgets = pd.merge(\n",
    "    imdb_clean,\n",
    "    budgets,\n",
    "    how='inner',\n",
    "    on ='movie_year')\n",
    "imdb_budgets.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(141854, 33)\n",
      "(5782, 8)\n",
      "(1493, 40)\n"
     ]
    }
   ],
   "source": [
    "print(imdb_clean.shape)\n",
    "print(budgets.shape)\n",
    "print(imdb_budgets.shape)\n",
    "#Our resultant dataframe is much smaller, but still large enough to see some trends. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movie_year</th>\n",
       "      <th>production_budget</th>\n",
       "      <th>domestic_gross</th>\n",
       "      <th>worldwide_gross</th>\n",
       "      <th>Action</th>\n",
       "      <th>Adult</th>\n",
       "      <th>Adventure</th>\n",
       "      <th>Animation</th>\n",
       "      <th>Biography</th>\n",
       "      <th>Comedy</th>\n",
       "      <th>...</th>\n",
       "      <th>Reality-TV</th>\n",
       "      <th>Romance</th>\n",
       "      <th>Sci-Fi</th>\n",
       "      <th>Short</th>\n",
       "      <th>Sport</th>\n",
       "      <th>Talk-Show</th>\n",
       "      <th>Thriller</th>\n",
       "      <th>Unknown</th>\n",
       "      <th>War</th>\n",
       "      <th>Western</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10_cloverfield_lane 2016</td>\n",
       "      <td>$5,000,000</td>\n",
       "      <td>$72,082,999</td>\n",
       "      <td>$108,286,422</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>10_days_in_a_madhouse 2015</td>\n",
       "      <td>$12,000,000</td>\n",
       "      <td>$14,616</td>\n",
       "      <td>$14,616</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>127_hours 2010</td>\n",
       "      <td>$18,000,000</td>\n",
       "      <td>$18,335,230</td>\n",
       "      <td>$60,217,171</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>12_strong 2018</td>\n",
       "      <td>$35,000,000</td>\n",
       "      <td>$45,819,713</td>\n",
       "      <td>$71,118,378</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>12_years_a_slave 2013</td>\n",
       "      <td>$20,000,000</td>\n",
       "      <td>$56,671,993</td>\n",
       "      <td>$181,025,343</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1488</th>\n",
       "      <td>zombie_hunter 2013</td>\n",
       "      <td>$1,000,000</td>\n",
       "      <td>$0</td>\n",
       "      <td>$0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1489</th>\n",
       "      <td>zookeeper 2011</td>\n",
       "      <td>$80,000,000</td>\n",
       "      <td>$80,360,866</td>\n",
       "      <td>$170,805,525</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1490</th>\n",
       "      <td>zoolander_2 2016</td>\n",
       "      <td>$50,000,000</td>\n",
       "      <td>$28,848,693</td>\n",
       "      <td>$55,348,693</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1491</th>\n",
       "      <td>zootopia 2016</td>\n",
       "      <td>$150,000,000</td>\n",
       "      <td>$341,268,248</td>\n",
       "      <td>$1,019,429,616</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1492</th>\n",
       "      <td>zulu 2013</td>\n",
       "      <td>$16,000,000</td>\n",
       "      <td>$0</td>\n",
       "      <td>$1,844,228</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1493 rows × 32 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                      movie_year production_budget domestic_gross  \\\n",
       "0       10_cloverfield_lane 2016        $5,000,000    $72,082,999   \n",
       "1     10_days_in_a_madhouse 2015       $12,000,000        $14,616   \n",
       "2                 127_hours 2010       $18,000,000    $18,335,230   \n",
       "3                 12_strong 2018       $35,000,000    $45,819,713   \n",
       "4          12_years_a_slave 2013       $20,000,000    $56,671,993   \n",
       "...                          ...               ...            ...   \n",
       "1488          zombie_hunter 2013        $1,000,000             $0   \n",
       "1489              zookeeper 2011       $80,000,000    $80,360,866   \n",
       "1490            zoolander_2 2016       $50,000,000    $28,848,693   \n",
       "1491               zootopia 2016      $150,000,000   $341,268,248   \n",
       "1492                   zulu 2013       $16,000,000             $0   \n",
       "\n",
       "     worldwide_gross  Action  Adult  Adventure  Animation  Biography  Comedy  \\\n",
       "0       $108,286,422       0      0          0          0          0       0   \n",
       "1            $14,616       0      0          0          0          0       0   \n",
       "2        $60,217,171       0      0          1          0          1       0   \n",
       "3        $71,118,378       1      0          0          0          0       0   \n",
       "4       $181,025,343       0      0          0          0          1       0   \n",
       "...              ...     ...    ...        ...        ...        ...     ...   \n",
       "1488              $0       1      0          0          0          0       1   \n",
       "1489    $170,805,525       0      0          0          0          0       1   \n",
       "1490     $55,348,693       0      0          0          0          0       1   \n",
       "1491  $1,019,429,616       0      0          1          1          0       1   \n",
       "1492      $1,844,228       0      0          0          0          0       0   \n",
       "\n",
       "      ...  Reality-TV  Romance  Sci-Fi  Short  Sport  Talk-Show  Thriller  \\\n",
       "0     ...           0        0       0      0      0          0         0   \n",
       "1     ...           0        0       0      0      0          0         0   \n",
       "2     ...           0        0       0      0      0          0         0   \n",
       "3     ...           0        0       0      0      0          0         0   \n",
       "4     ...           0        0       0      0      0          0         0   \n",
       "...   ...         ...      ...     ...    ...    ...        ...       ...   \n",
       "1488  ...           0        0       0      0      0          0         0   \n",
       "1489  ...           0        1       0      0      0          0         0   \n",
       "1490  ...           0        0       0      0      0          0         0   \n",
       "1491  ...           0        0       0      0      0          0         0   \n",
       "1492  ...           0        0       0      0      0          0         1   \n",
       "\n",
       "      Unknown  War  Western  \n",
       "0           0    0        0  \n",
       "1           0    0        0  \n",
       "2           0    0        0  \n",
       "3           0    0        0  \n",
       "4           0    0        0  \n",
       "...       ...  ...      ...  \n",
       "1488        0    0        0  \n",
       "1489        0    0        0  \n",
       "1490        0    0        0  \n",
       "1491        0    0        0  \n",
       "1492        0    0        0  \n",
       "\n",
       "[1493 rows x 32 columns]"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Clean up this table a bit by dropping unnecessary columns and moving titles and earnings info to the front\n",
    "genres_and_earnings = imdb_budgets.drop(['tconst', 'movie_x', 'start_year', 'id', 'release_date', 'year', 'genres', 'movie_y'], axis=1)\n",
    "genres_and_earnings = genres_and_earnings[['movie_year', 'production_budget',\n",
    " 'domestic_gross',\n",
    " 'worldwide_gross','Action',\n",
    " 'Adult',\n",
    " 'Adventure',\n",
    " 'Animation',\n",
    " 'Biography',\n",
    " 'Comedy',\n",
    " 'Crime',\n",
    " 'Documentary',\n",
    " 'Drama',\n",
    " 'Family',\n",
    " 'Fantasy',\n",
    " 'Game-Show',\n",
    " 'History',\n",
    " 'Horror',\n",
    " 'Music',\n",
    " 'Musical',\n",
    " 'Mystery',\n",
    " 'News',\n",
    " 'Reality-TV',\n",
    " 'Romance',\n",
    " 'Sci-Fi',\n",
    " 'Short',\n",
    " 'Sport',\n",
    " 'Talk-Show',\n",
    " 'Thriller',\n",
    " 'Unknown',\n",
    " 'War',\n",
    " 'Western',\n",
    " ]]\n",
    "\n",
    "genres_and_earnings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "movie_year           object\n",
       "production_budget    object\n",
       "domestic_gross       object\n",
       "worldwide_gross      object\n",
       "Action                int64\n",
       "Adult                 int64\n",
       "Adventure             int64\n",
       "Animation             int64\n",
       "Biography             int64\n",
       "Comedy                int64\n",
       "Crime                 int64\n",
       "Documentary           int64\n",
       "Drama                 int64\n",
       "Family                int64\n",
       "Fantasy               int64\n",
       "Game-Show             int64\n",
       "History               int64\n",
       "Horror                int64\n",
       "Music                 int64\n",
       "Musical               int64\n",
       "Mystery               int64\n",
       "News                  int64\n",
       "Reality-TV            int64\n",
       "Romance               int64\n",
       "Sci-Fi                int64\n",
       "Short                 int64\n",
       "Sport                 int64\n",
       "Talk-Show             int64\n",
       "Thriller              int64\n",
       "Unknown               int64\n",
       "War                   int64\n",
       "Western               int64\n",
       "dtype: object"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "genres_and_earnings.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<class 'str'>    1493\n",
       "Name: worldwide_gross, dtype: int64"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# We're ultimately going to be concerned with worldwide gross. \n",
    "# Check the datatypes of values in the worldwide gross column: \n",
    "genres_and_earnings['worldwide_gross'].apply(type).value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "# Remove punctuation from this column because we need to convert to float\n",
    "genres_and_earnings['worldwide_gross'] = genres_and_earnings['worldwide_gross'].str.replace(',', '')\n",
    "genres_and_earnings['worldwide_gross'] = genres_and_earnings['worldwide_gross'].str.replace('$', '')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "#Convert worldwide gross column, currently strings, to numeric values \n",
    "genres_and_earnings['worldwide_gross'] = genres_and_earnings['worldwide_gross'].astype(float)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Action         457\n",
       "Adult            0\n",
       "Adventure      355\n",
       "Animation      105\n",
       "Biography      132\n",
       "Comedy         527\n",
       "Crime          230\n",
       "Documentary     37\n",
       "Drama          710\n",
       "Family          94\n",
       "Fantasy        121\n",
       "Game-Show        0\n",
       "History         39\n",
       "Horror         178\n",
       "Music           59\n",
       "Musical          9\n",
       "Mystery        124\n",
       "News             0\n",
       "Reality-TV       0\n",
       "Romance        190\n",
       "Sci-Fi         137\n",
       "Short            0\n",
       "Sport           32\n",
       "Talk-Show        0\n",
       "Thriller       249\n",
       "Unknown          0\n",
       "War             18\n",
       "Western         12\n",
       "dtype: int64"
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "genres_and_earnings[unique_genres_list].sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {
    "scrolled": false
   },
   "outputs": [],
   "source": [
    "# Get mean worldwide gross earnings per genre\n",
    "genres_dict = {}\n",
    "\n",
    "for genre in unique_genres_list:\n",
    "    genre_ww_earnings = genres_and_earnings.loc[genres_and_earnings[genre] == 1]['worldwide_gross'].mean()\n",
    "    genres_dict[genre]=genre_ww_earnings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "{'Action': 239708814.3632385,\n",
       " 'Adult': nan,\n",
       " 'Adventure': 346659105.93802816,\n",
       " 'Animation': 359782025.0761905,\n",
       " 'Biography': 82114460.20454545,\n",
       " 'Comedy': 132697702.46869071,\n",
       " 'Crime': 82623871.4,\n",
       " 'Documentary': 23952656.864864863,\n",
       " 'Drama': 73659413.27042253,\n",
       " 'Family': 177612501.1276596,\n",
       " 'Fantasy': 229206982.62809917,\n",
       " 'Game-Show': nan,\n",
       " 'History': 87796165.07692307,\n",
       " 'Horror': 68635937.09550563,\n",
       " 'Music': 98844117.94915254,\n",
       " 'Musical': 195382361.55555555,\n",
       " 'Mystery': 91867290.5483871,\n",
       " 'News': nan,\n",
       " 'Reality-TV': nan,\n",
       " 'Romance': 70667551.97894737,\n",
       " 'Sci-Fi': 341361105.95620435,\n",
       " 'Short': nan,\n",
       " 'Sport': 54138854.40625,\n",
       " 'Talk-Show': nan,\n",
       " 'Thriller': 118815474.75903614,\n",
       " 'Unknown': nan,\n",
       " 'War': 54600024.38888889,\n",
       " 'Western': 103165577.5}"
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "genres_dict"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "#Convert dictionary to series\n",
    "genres_series = pd.Series(genres_dict, name = \"Gross Earnings\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "#Convert above series to dataframe\n",
    "genres_df = genres_series.to_frame()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Drop null values to convert floats to integers\n",
    "genres_df = genres_df.dropna()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Gross Earnings</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Action</th>\n",
       "      <td>239708814</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Adventure</th>\n",
       "      <td>346659106</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Animation</th>\n",
       "      <td>359782025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Biography</th>\n",
       "      <td>82114460</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Comedy</th>\n",
       "      <td>132697702</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Crime</th>\n",
       "      <td>82623871</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Documentary</th>\n",
       "      <td>23952657</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Drama</th>\n",
       "      <td>73659413</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Family</th>\n",
       "      <td>177612501</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Fantasy</th>\n",
       "      <td>229206983</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>History</th>\n",
       "      <td>87796165</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Horror</th>\n",
       "      <td>68635937</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Music</th>\n",
       "      <td>98844118</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Musical</th>\n",
       "      <td>195382362</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mystery</th>\n",
       "      <td>91867291</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Romance</th>\n",
       "      <td>70667552</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Sci-Fi</th>\n",
       "      <td>341361106</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Sport</th>\n",
       "      <td>54138854</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Thriller</th>\n",
       "      <td>118815475</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>War</th>\n",
       "      <td>54600024</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Western</th>\n",
       "      <td>103165578</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "             Gross Earnings\n",
       "Action            239708814\n",
       "Adventure         346659106\n",
       "Animation         359782025\n",
       "Biography          82114460\n",
       "Comedy            132697702\n",
       "Crime              82623871\n",
       "Documentary        23952657\n",
       "Drama              73659413\n",
       "Family            177612501\n",
       "Fantasy           229206983\n",
       "History            87796165\n",
       "Horror             68635937\n",
       "Music              98844118\n",
       "Musical           195382362\n",
       "Mystery            91867291\n",
       "Romance            70667552\n",
       "Sci-Fi            341361106\n",
       "Sport              54138854\n",
       "Thriller          118815475\n",
       "War                54600024\n",
       "Western           103165578"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Round down gross earnings and convert to integers\n",
    "genres_df = genres_df.round(0).astype(int)\n",
    "genres_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-63-7a1c39a41f0d>:13: UserWarning: FixedFormatter should only be used together with FixedLocator\n",
      "  axes.set_yticklabels(['{:,}'.format(int(x)) for x in axes.get_yticks().tolist()])\n"
     ]
    },
    {
     "data": {
      "image/png": "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eoT33hvH4MH3JzVoL7zwLOPHjy153qzZRtx00228//57bLXV1txwwy0sX76ck046FtXJAPz88wxGjnyZBg0a8PDDg/jxxx+4776HWLRoIV26HMn//V+X1cZZe+21GTz4MUaOHMHjjw+hX79bueGGPvTseSbt23fgqaeeYMUKKy04ePD9PPzwozRqtA4DB97FjBnTSnkr8Yhsw4kndufeewfQqFEjYJVRO/vsCwBWM2jPPDMCkW3YbrsdSrW/995Yli5dyr77dkr5Oc2ZM4enn36Su+++n4suOr+kffHiRdx99x3ccssd3H//PSXt22+/aoxvvvmKSZMmctVV16/W76BB93LIIYfTrNlGqx1btGgRL774HI89NgKAmTN/YYMNmnLvvXfy1VcTWHfd9fjf/y5JqXO2lLtBU9WxIrKvqhYFo1ET855aAENC23PAdcAmQD1V/SiIDw3tiUbiEGCv8PhJYKCI1Art14Rxx4lIExFpEdpHqOpK4HsRmQHsgXlVMToBY1T1DwARGYl5lWOBH1R1amgfBhwrIpMi6uo41ZoOHfZi8OD7WblyJW+//SadOnXmjTdeB2DSpG/59dc5nH/+mQCsXLmCRo3WprCwkBtvvJX33x/PjBnT+fLLzyksXBXS32239gBsscWWLFy4IOm4qaYcO3f+D19//TVPPz2cadOmMn/+fJYs+RuATTbZlAYNGpSc27ZtO2rVqkXjxuvSqFEjFi9evcr7brvtEXRpydix77BgwXzmzJlN+/YdADjkkCN45hm7YO+5Z0d69TqVvfbah7333o+ttpK0793RRx/H5ptvyXvvjWX48MeoW7cenTt3TnruTz/9yNixYxgw4D7mzv2tpP333+fx6KMPM2DAfSnHWblyJTfffD3//e8l1KlTt9SxO+64he7dT2XddddLKjthwhdce+3lXHtt3xLDG+PTTz/i11/ncN55/0sa63v99dF07Lg3jRuvC1hhgB9+UHr0OIPzzvsfL730PDfccC333vtgSt2zoUKmHFV1uYhcB/QGnsE8tTHA2cB84GWgB/AtpbcFmA1snKTLjWLnBUO5AGgS354gn6o9aZ9x5+yaZ5+OU+4k86QqcmH1WmutRcuWW/H11xP44otPOffc80sM2sqVK9hxx9bccot5XsuWLWPJkiX8/fff9Ox5Mp07H0Tr1jux5ZYtGTXq6ZI+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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Plot by Genre and Average Gross Earnings to figure out the most profitable genres. \n",
    "genres_df.plot(kind = 'bar')\n",
    "\n",
    "#Set up the title of the graph. \n",
    "plt.title(\"Gross Worldwide Earnings by Genre\",fontsize = 14)\n",
    "\n",
    "#Setup the x-axis label and y-axis label of the graph.\n",
    "plt.xlabel('Genre',fontsize = 13)\n",
    "plt.ylabel('Worldwide Earnings (in Dollars)',fontsize = 13)\n",
    "axes = plt.gca()\n",
    "axes.yaxis.grid()\n",
    "plt.gcf().axes[0].yaxis.get_major_formatter().set_scientific(False)\n",
    "axes.set_yticklabels(['{:,}'.format(int(x)) for x in axes.get_yticks().tolist()])\n",
    "\n",
    "#Insert mean gross worldwide earning\n",
    "plt.hlines(y=genres_df['Gross Earnings'].mean(),xmin=-.5, xmax=20.5,color='red',label=f\"Mean Earnings: ${genres_df['Gross Earnings'].mean():,.0f}\") \n",
    "\n",
    "plt.legend()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Analysis and Recommendations \n",
    "As shown above, Sci-Fi, Adventure, and Animation are clearly the three genres with the highest average worldwide gross earnings (for films produced since 2010). However, these are oftentimes [the most expensive](https://www.the-numbers.com/movie/budgets) movies to produce--so Microsoft should take into account its start-up capital when deciding which genres of movies to finance first. \n",
    "\n",
    "Though the Adventure gentre is highly profitable, it also is known to eat up a [large chunk](https://www.the-numbers.com/market/genres) of the market, and thus presents more competition to a novice studio. Unless Microsoft has the budget and the wherewithall the turn one of their more popular franchises into [a guaranteed moneymaker series](https://screenrant.com/best-video-games-like-star-wars-movies/), one of the more modestly profitable genres might pose less of a financial risk. For example, Family and/or Musical films still yield above-average profitability, as shown in the above analysis. In addition, these genres are generally known to require budgets that fall within a more reasonable range and in turn would present less of a gamble for investors. Finally, genres such as Drama and Comedy occupy [smaller shares](https://www.the-numbers.com/market/genres) of the film market, so a family-oriented drama or comedy may be likely to earn above-average profits while facing less competition at the box office. \n",
    "\n",
    "Further analysis on film budgets by genre would help Microsoft gain more insight on the start-up costs that would be necessary to produce films in the most profitable genres. In addition, examining market crowding by genre, while also taking into account ticket sales by genre, would also develop a more complete picture of the degree of competition Microsoft may face as it enters the industry.  "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Analysis 3: Which actors should Microsoft prioritize for hire? \n",
    "For this analysis, actor data was cleaned and combined with a rough estimate of actor \"cost\" to generate recommendations for talent recruitment. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Data Cleaning"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(146144, 32)\n",
      "(606648, 6)\n",
      "(1028186, 6)\n"
     ]
    }
   ],
   "source": [
    "print(imdb.shape)\n",
    "print(imdb_names.shape)\n",
    "print(imdb_principals.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>nconst</th>\n",
       "      <th>primary_name</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>death_year</th>\n",
       "      <th>primary_profession</th>\n",
       "      <th>known_for_titles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>nm0061671</td>\n",
       "      <td>Mary Ellen Bauder</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>miscellaneous,production_manager,producer</td>\n",
       "      <td>tt0837562,tt2398241,tt0844471,tt0118553</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>nm0061865</td>\n",
       "      <td>Joseph Bauer</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>composer,music_department,sound_department</td>\n",
       "      <td>tt0896534,tt6791238,tt0287072,tt1682940</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>nm0062070</td>\n",
       "      <td>Bruce Baum</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>miscellaneous,actor,writer</td>\n",
       "      <td>tt1470654,tt0363631,tt0104030,tt0102898</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>nm0062195</td>\n",
       "      <td>Axel Baumann</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>camera_department,cinematographer,art_department</td>\n",
       "      <td>tt0114371,tt2004304,tt1618448,tt1224387</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>nm0062798</td>\n",
       "      <td>Pete Baxter</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>production_designer,art_department,set_decorator</td>\n",
       "      <td>tt0452644,tt0452692,tt3458030,tt2178256</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      nconst       primary_name  birth_year  death_year  \\\n",
       "0  nm0061671  Mary Ellen Bauder         NaN         NaN   \n",
       "1  nm0061865       Joseph Bauer         NaN         NaN   \n",
       "2  nm0062070         Bruce Baum         NaN         NaN   \n",
       "3  nm0062195       Axel Baumann         NaN         NaN   \n",
       "4  nm0062798        Pete Baxter         NaN         NaN   \n",
       "\n",
       "                                 primary_profession  \\\n",
       "0         miscellaneous,production_manager,producer   \n",
       "1        composer,music_department,sound_department   \n",
       "2                        miscellaneous,actor,writer   \n",
       "3  camera_department,cinematographer,art_department   \n",
       "4  production_designer,art_department,set_decorator   \n",
       "\n",
       "                          known_for_titles  \n",
       "0  tt0837562,tt2398241,tt0844471,tt0118553  \n",
       "1  tt0896534,tt6791238,tt0287072,tt1682940  \n",
       "2  tt1470654,tt0363631,tt0104030,tt0102898  \n",
       "3  tt0114371,tt2004304,tt1618448,tt1224387  \n",
       "4  tt0452644,tt0452692,tt3458030,tt2178256  "
      ]
     },
     "execution_count": 62,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Step 1: Clean up names dataframe (get rid of spaces in column titles)\n",
    "imdb_names.columns.str.replace(' ', '')\n",
    "imdb_names.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Check for null values in Names dataframe\n",
    "imdb_names['nconst'].isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Check for null values in primary_name as well\n",
    "imdb_names = imdb_names.sort_values(by=['primary_name'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>nconst</th>\n",
       "      <th>primary_name</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>death_year</th>\n",
       "      <th>primary_profession</th>\n",
       "      <th>known_for_titles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>156216</th>\n",
       "      <td>nm1701176</td>\n",
       "      <td>A. Venkatesh</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>cinematographer,camera_department,editor</td>\n",
       "      <td>tt0984177,tt0327761,tt0072026,tt4160030</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>279631</th>\n",
       "      <td>nm4062141</td>\n",
       "      <td>A. Venkatesh</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>director,actor,writer</td>\n",
       "      <td>tt4976496,tt6765648,tt4318038,tt6827080</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>387377</th>\n",
       "      <td>nm8956236</td>\n",
       "      <td>A. Venkatesh</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>producer</td>\n",
       "      <td>tt6834466</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>129377</th>\n",
       "      <td>nm10275444</td>\n",
       "      <td>A. Venkatesh</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>director</td>\n",
       "      <td>tt9319898</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30159</th>\n",
       "      <td>nm0451160</td>\n",
       "      <td>A.J. Khan</td>\n",
       "      <td>1977.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress,make_up_department,director</td>\n",
       "      <td>tt0203536,tt1651142,tt0367014,tt0323108</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>433984</th>\n",
       "      <td>nm6356309</td>\n",
       "      <td>Özgür Bakar</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>director,writer,producer</td>\n",
       "      <td>tt4368072,tt10046236,tt7717990,tt4764942</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>102820</th>\n",
       "      <td>nm2561272</td>\n",
       "      <td>Øystein Mamen</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>cinematographer,camera_department,editor</td>\n",
       "      <td>tt2713778,tt6275296,tt3541092,tt0966566</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>603769</th>\n",
       "      <td>nm8122779</td>\n",
       "      <td>Øystein Mamen</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>cinematographer</td>\n",
       "      <td>tt2660730</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>93977</th>\n",
       "      <td>nm10211575</td>\n",
       "      <td>Þórunn Lárusdóttir</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actor,writer,editor</td>\n",
       "      <td>tt9174804</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>173454</th>\n",
       "      <td>nm1800527</td>\n",
       "      <td>Þórunn Lárusdóttir</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress,director</td>\n",
       "      <td>tt9174804,tt5881406,tt0439436,tt1245694</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>50865 rows × 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            nconst        primary_name  birth_year  death_year  \\\n",
       "156216   nm1701176        A. Venkatesh         NaN         NaN   \n",
       "279631   nm4062141        A. Venkatesh         NaN         NaN   \n",
       "387377   nm8956236        A. Venkatesh         NaN         NaN   \n",
       "129377  nm10275444        A. Venkatesh         NaN         NaN   \n",
       "30159    nm0451160           A.J. Khan      1977.0         NaN   \n",
       "...            ...                 ...         ...         ...   \n",
       "433984   nm6356309         Özgür Bakar         NaN         NaN   \n",
       "102820   nm2561272       Øystein Mamen         NaN         NaN   \n",
       "603769   nm8122779       Øystein Mamen         NaN         NaN   \n",
       "93977   nm10211575  Þórunn Lárusdóttir         NaN         NaN   \n",
       "173454   nm1800527  Þórunn Lárusdóttir         NaN         NaN   \n",
       "\n",
       "                              primary_profession  \\\n",
       "156216  cinematographer,camera_department,editor   \n",
       "279631                     director,actor,writer   \n",
       "387377                                  producer   \n",
       "129377                                  director   \n",
       "30159        actress,make_up_department,director   \n",
       "...                                          ...   \n",
       "433984                  director,writer,producer   \n",
       "102820  cinematographer,camera_department,editor   \n",
       "603769                           cinematographer   \n",
       "93977                        actor,writer,editor   \n",
       "173454                          actress,director   \n",
       "\n",
       "                                known_for_titles  \n",
       "156216   tt0984177,tt0327761,tt0072026,tt4160030  \n",
       "279631   tt4976496,tt6765648,tt4318038,tt6827080  \n",
       "387377                                 tt6834466  \n",
       "129377                                 tt9319898  \n",
       "30159    tt0203536,tt1651142,tt0367014,tt0323108  \n",
       "...                                          ...  \n",
       "433984  tt4368072,tt10046236,tt7717990,tt4764942  \n",
       "102820   tt2713778,tt6275296,tt3541092,tt0966566  \n",
       "603769                                 tt2660730  \n",
       "93977                                  tt9174804  \n",
       "173454   tt9174804,tt5881406,tt0439436,tt1245694  \n",
       "\n",
       "[50865 rows x 6 columns]"
      ]
     },
     "execution_count": 66,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Look for duplicates in nconst and primary_name\n",
    "names_dupes = imdb_names.loc[imdb_names.duplicated(subset=['primary_name'],keep=False) == True]\n",
    "names_dupes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>nconst</th>\n",
       "      <th>primary_name</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>death_year</th>\n",
       "      <th>primary_profession</th>\n",
       "      <th>known_for_titles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "Empty DataFrame\n",
       "Columns: [nconst, primary_name, birth_year, death_year, primary_profession, known_for_titles]\n",
       "Index: []"
      ]
     },
     "execution_count": 67,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "id_dupes = imdb_names.loc[imdb_names.duplicated(subset=['nconst'],keep=False) == True]\n",
    "id_dupes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(50865, 6)\n",
      "(606648, 6)\n",
      "0.08384598646991336\n"
     ]
    }
   ],
   "source": [
    "print(names_dupes.shape)\n",
    "print(imdb_names.shape)\n",
    "print(50865/606648)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Duplicate names account for 8% of my data (though there are no duplicate nconst values)\n",
    "#I will drop these names since many of them must have different unique IDs as well (see A.Venkatesh, above)\n",
    "#Since it would be inefficient to go through and figure out the right unique ID for each person, \n",
    "#it makes sense to drop for now. \n",
    "imdb_names = imdb_names.drop_duplicates(subset=['primary_name'], keep=False,)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(555783, 6)\n",
      "50865\n"
     ]
    }
   ],
   "source": [
    "#Confirming new shape of dataframe; duplicates should be dropped \n",
    "print(imdb_names.shape)\n",
    "print(606648-555783)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>ordering</th>\n",
       "      <th>nconst</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt0111414</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0246005</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"The Man\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt0111414</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0398271</td>\n",
       "      <td>director</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt0111414</td>\n",
       "      <td>3</td>\n",
       "      <td>nm3739909</td>\n",
       "      <td>producer</td>\n",
       "      <td>producer</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt0323808</td>\n",
       "      <td>10</td>\n",
       "      <td>nm0059247</td>\n",
       "      <td>editor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt0323808</td>\n",
       "      <td>1</td>\n",
       "      <td>nm3579312</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Beth Boothby\"]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      tconst  ordering     nconst  category       job        characters\n",
       "0  tt0111414         1  nm0246005     actor       NaN       [\"The Man\"]\n",
       "1  tt0111414         2  nm0398271  director       NaN               NaN\n",
       "2  tt0111414         3  nm3739909  producer  producer               NaN\n",
       "3  tt0323808        10  nm0059247    editor       NaN               NaN\n",
       "4  tt0323808         1  nm3579312   actress       NaN  [\"Beth Boothby\"]"
      ]
     },
     "execution_count": 71,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Repeat cleaning process for Principals dataframe\n",
    "imdb_principals.columns.str.replace(' ', '')\n",
    "imdb_principals.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 72,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Check for null values in Principals dataframe. \n",
    "imdb_principals['nconst'].isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>ordering</th>\n",
       "      <th>nconst</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>263152</th>\n",
       "      <td>tt2053352</td>\n",
       "      <td>4</td>\n",
       "      <td>nm0000002</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15288</th>\n",
       "      <td>tt1626811</td>\n",
       "      <td>4</td>\n",
       "      <td>nm0000002</td>\n",
       "      <td>self</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself - Interviewee\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>223302</th>\n",
       "      <td>tt0858500</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0000002</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"May\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>252036</th>\n",
       "      <td>tt1368858</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000002</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Anne-Marie\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>229763</th>\n",
       "      <td>tt1714820</td>\n",
       "      <td>3</td>\n",
       "      <td>nm0000003</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           tconst  ordering     nconst         category  job  \\\n",
       "263152  tt2053352         4  nm0000002  archive_footage  NaN   \n",
       "15288   tt1626811         4  nm0000002             self  NaN   \n",
       "223302  tt0858500         2  nm0000002          actress  NaN   \n",
       "252036  tt1368858         1  nm0000002          actress  NaN   \n",
       "229763  tt1714820         3  nm0000003  archive_footage  NaN   \n",
       "\n",
       "                       characters  \n",
       "263152                [\"Herself\"]  \n",
       "15288   [\"Herself - Interviewee\"]  \n",
       "223302                    [\"May\"]  \n",
       "252036             [\"Anne-Marie\"]  \n",
       "229763                [\"Herself\"]  "
      ]
     },
     "execution_count": 73,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Sort rows by nconst number\n",
    "imdb_principals = imdb_principals.sort_values(by=['nconst'])\n",
    "imdb_principals.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(582339, 6)"
      ]
     },
     "execution_count": 74,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Assess duplicates situation - there are a lot of duplicate Unique Person IDs (\"nconst\"), but...\n",
    "principals_dupes = imdb_principals.loc[imdb_principals.duplicated(subset=['nconst'],keep=False) == True]\n",
    "principals_dupes.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>ordering</th>\n",
       "      <th>nconst</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>263152</th>\n",
       "      <td>tt2053352</td>\n",
       "      <td>4</td>\n",
       "      <td>nm0000002</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15288</th>\n",
       "      <td>tt1626811</td>\n",
       "      <td>4</td>\n",
       "      <td>nm0000002</td>\n",
       "      <td>self</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself - Interviewee\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>223302</th>\n",
       "      <td>tt0858500</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0000002</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"May\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>252036</th>\n",
       "      <td>tt1368858</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000002</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Anne-Marie\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>229763</th>\n",
       "      <td>tt1714820</td>\n",
       "      <td>3</td>\n",
       "      <td>nm0000003</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           tconst  ordering     nconst         category  job  \\\n",
       "263152  tt2053352         4  nm0000002  archive_footage  NaN   \n",
       "15288   tt1626811         4  nm0000002             self  NaN   \n",
       "223302  tt0858500         2  nm0000002          actress  NaN   \n",
       "252036  tt1368858         1  nm0000002          actress  NaN   \n",
       "229763  tt1714820         3  nm0000003  archive_footage  NaN   \n",
       "\n",
       "                       characters  \n",
       "263152                [\"Herself\"]  \n",
       "15288   [\"Herself - Interviewee\"]  \n",
       "223302                    [\"May\"]  \n",
       "252036             [\"Anne-Marie\"]  \n",
       "229763                [\"Herself\"]  "
      ]
     },
     "execution_count": 75,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Each duplicated  Person ID/(\"nconst\") seems to be associated with a Unique Move ID (\"tconst\"),\n",
    "# Which makes sense if the same person was in multiple movies. No need to drop these 582,339 duplicates. \n",
    "principals_dupes.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "38"
      ]
     },
     "execution_count": 76,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Checking this hypothesis\n",
    "imdb_principals.duplicated(subset=['tconst', 'nconst']).sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>ordering</th>\n",
       "      <th>nconst</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>646999</th>\n",
       "      <td>tt5473578</td>\n",
       "      <td>8</td>\n",
       "      <td>nm0149828</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>646994</th>\n",
       "      <td>tt5473578</td>\n",
       "      <td>3</td>\n",
       "      <td>nm0149828</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>723770</th>\n",
       "      <td>tt4537170</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0172826</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>723776</th>\n",
       "      <td>tt4537170</td>\n",
       "      <td>8</td>\n",
       "      <td>nm0172826</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>695178</th>\n",
       "      <td>tt6549064</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0244327</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Nadeen\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>695183</th>\n",
       "      <td>tt6549064</td>\n",
       "      <td>7</td>\n",
       "      <td>nm0244327</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Nadeen\"]</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>647034</th>\n",
       "      <td>tt5495582</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0406809</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>647042</th>\n",
       "      <td>tt5495582</td>\n",
       "      <td>9</td>\n",
       "      <td>nm0406809</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>765019</th>\n",
       "      <td>tt6664852</td>\n",
       "      <td>5</td>\n",
       "      <td>nm0605583</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>765016</th>\n",
       "      <td>tt6664852</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0605583</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           tconst  ordering     nconst category  job  characters\n",
       "646999  tt5473578         8  nm0149828  actress  NaN         NaN\n",
       "646994  tt5473578         3  nm0149828  actress  NaN         NaN\n",
       "723770  tt4537170         2  nm0172826    actor  NaN         NaN\n",
       "723776  tt4537170         8  nm0172826    actor  NaN         NaN\n",
       "695178  tt6549064         2  nm0244327  actress  NaN  [\"Nadeen\"]\n",
       "695183  tt6549064         7  nm0244327  actress  NaN  [\"Nadeen\"]\n",
       "647034  tt5495582         1  nm0406809    actor  NaN         NaN\n",
       "647042  tt5495582         9  nm0406809    actor  NaN         NaN\n",
       "765019  tt6664852         5  nm0605583    actor  NaN         NaN\n",
       "765016  tt6664852         2  nm0605583    actor  NaN         NaN"
      ]
     },
     "execution_count": 77,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# So there are only a small number of rows with both a duplicated Person ID and Movie ID. \n",
    "dupe_movies_and_names = imdb_principals.loc[imdb_principals.duplicated(subset=['nconst','tconst'],keep=False) == True]\n",
    "dupe_movies_and_names.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(76, 6)\n"
     ]
    }
   ],
   "source": [
    "print(dupe_movies_and_names.shape)\n",
    "# Makes sense because 38*2 = 76 "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Dropping above duplicates anyway, even though 38 duplicates out of 1,028,186 is pretty insignificant \n",
    "imdb_principals = imdb_principals.drop_duplicates(subset=['tconst','nconst'], keep='first')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 80,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(1028148, 6)\n",
      "1028186\n"
     ]
    }
   ],
   "source": [
    "print(imdb_principals.shape)\n",
    "print(1028148+38)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(1028148, 6)\n",
      "(555783, 6)\n"
     ]
    }
   ],
   "source": [
    "print(imdb_principals.shape)\n",
    "print(imdb_names.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 82,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>ordering</th>\n",
       "      <th>nconst</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "      <th>primary_name</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>death_year</th>\n",
       "      <th>primary_profession</th>\n",
       "      <th>known_for_titles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt2053352</td>\n",
       "      <td>4</td>\n",
       "      <td>nm0000002</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Lauren Bacall</td>\n",
       "      <td>1924.0</td>\n",
       "      <td>2014.0</td>\n",
       "      <td>actress,soundtrack</td>\n",
       "      <td>tt0038355,tt0117057,tt0071877,tt0037382</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt1626811</td>\n",
       "      <td>4</td>\n",
       "      <td>nm0000002</td>\n",
       "      <td>self</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself - Interviewee\"]</td>\n",
       "      <td>Lauren Bacall</td>\n",
       "      <td>1924.0</td>\n",
       "      <td>2014.0</td>\n",
       "      <td>actress,soundtrack</td>\n",
       "      <td>tt0038355,tt0117057,tt0071877,tt0037382</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt0858500</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0000002</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"May\"]</td>\n",
       "      <td>Lauren Bacall</td>\n",
       "      <td>1924.0</td>\n",
       "      <td>2014.0</td>\n",
       "      <td>actress,soundtrack</td>\n",
       "      <td>tt0038355,tt0117057,tt0071877,tt0037382</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt1368858</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000002</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Anne-Marie\"]</td>\n",
       "      <td>Lauren Bacall</td>\n",
       "      <td>1924.0</td>\n",
       "      <td>2014.0</td>\n",
       "      <td>actress,soundtrack</td>\n",
       "      <td>tt0038355,tt0117057,tt0071877,tt0037382</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt1714820</td>\n",
       "      <td>3</td>\n",
       "      <td>nm0000003</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Brigitte Bardot</td>\n",
       "      <td>1934.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress,soundtrack,producer</td>\n",
       "      <td>tt0049189,tt0057345,tt0054452,tt0059956</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>tt2004245</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000003</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Brigitte Bardot</td>\n",
       "      <td>1934.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress,soundtrack,producer</td>\n",
       "      <td>tt0049189,tt0057345,tt0054452,tt0059956</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>tt4323536</td>\n",
       "      <td>3</td>\n",
       "      <td>nm0000003</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Brigitte Bardot</td>\n",
       "      <td>1934.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress,soundtrack,producer</td>\n",
       "      <td>tt0049189,tt0057345,tt0054452,tt0059956</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>tt2327430</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0000005</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Ingmar Bergman</td>\n",
       "      <td>1918.0</td>\n",
       "      <td>2007.0</td>\n",
       "      <td>writer,director,actor</td>\n",
       "      <td>tt0069467,tt0050986,tt0083922,tt0050976</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>tt2056773</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000005</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Ingmar Bergman</td>\n",
       "      <td>1918.0</td>\n",
       "      <td>2007.0</td>\n",
       "      <td>writer,director,actor</td>\n",
       "      <td>tt0069467,tt0050986,tt0083922,tt0050976</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>tt9209768</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000005</td>\n",
       "      <td>self</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself (voice)\"]</td>\n",
       "      <td>Ingmar Bergman</td>\n",
       "      <td>1918.0</td>\n",
       "      <td>2007.0</td>\n",
       "      <td>writer,director,actor</td>\n",
       "      <td>tt0069467,tt0050986,tt0083922,tt0050976</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>tt8385142</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0000005</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Ingmar Bergman</td>\n",
       "      <td>1918.0</td>\n",
       "      <td>2007.0</td>\n",
       "      <td>writer,director,actor</td>\n",
       "      <td>tt0069467,tt0050986,tt0083922,tt0050976</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>tt6109168</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000005</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Ingmar Bergman</td>\n",
       "      <td>1918.0</td>\n",
       "      <td>2007.0</td>\n",
       "      <td>writer,director,actor</td>\n",
       "      <td>tt0069467,tt0050986,tt0083922,tt0050976</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>tt1648206</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0000006</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Ingrid Bergman</td>\n",
       "      <td>1915.0</td>\n",
       "      <td>1982.0</td>\n",
       "      <td>actress,soundtrack,producer</td>\n",
       "      <td>tt0071877,tt0036855,tt0038109,tt0038787</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>tt4621016</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000006</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Ingrid Bergman</td>\n",
       "      <td>1915.0</td>\n",
       "      <td>1982.0</td>\n",
       "      <td>actress,soundtrack,producer</td>\n",
       "      <td>tt0071877,tt0036855,tt0038109,tt0038787</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>tt2388426</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000006</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Ingrid Bergman</td>\n",
       "      <td>1915.0</td>\n",
       "      <td>1982.0</td>\n",
       "      <td>actress,soundtrack,producer</td>\n",
       "      <td>tt0071877,tt0036855,tt0038109,tt0038787</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>tt4926886</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000006</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Ingrid Bergman</td>\n",
       "      <td>1915.0</td>\n",
       "      <td>1982.0</td>\n",
       "      <td>actress,soundtrack,producer</td>\n",
       "      <td>tt0071877,tt0036855,tt0038109,tt0038787</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>tt7215006</td>\n",
       "      <td>3</td>\n",
       "      <td>nm0000007</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Humphrey Bogart</td>\n",
       "      <td>1899.0</td>\n",
       "      <td>1957.0</td>\n",
       "      <td>actor,soundtrack,producer</td>\n",
       "      <td>tt0034583,tt0033870,tt0037382,tt0043265</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>tt4145178</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000008</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Marlon Brando</td>\n",
       "      <td>1924.0</td>\n",
       "      <td>2004.0</td>\n",
       "      <td>actor,soundtrack,director</td>\n",
       "      <td>tt0078788,tt0070849,tt0047296,tt0068646</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>tt2004245</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0000008</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Marlon Brando</td>\n",
       "      <td>1924.0</td>\n",
       "      <td>2004.0</td>\n",
       "      <td>actor,soundtrack,director</td>\n",
       "      <td>tt0078788,tt0070849,tt0047296,tt0068646</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>tt5084458</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000010</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>James Cagney</td>\n",
       "      <td>1899.0</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>actor,soundtrack,director</td>\n",
       "      <td>tt0029870,tt0055256,tt0035575,tt0031867</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>tt2246829</td>\n",
       "      <td>6</td>\n",
       "      <td>nm0000016</td>\n",
       "      <td>composer</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Georges Delerue</td>\n",
       "      <td>1925.0</td>\n",
       "      <td>1992.0</td>\n",
       "      <td>composer,soundtrack,music_department</td>\n",
       "      <td>tt0091763,tt0080610,tt0069946,tt0096320</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>tt3751664</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000019</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Federico Fellini</td>\n",
       "      <td>1920.0</td>\n",
       "      <td>1993.0</td>\n",
       "      <td>writer,director,assistant_director</td>\n",
       "      <td>tt0047528,tt0053779,tt0056801,tt0071129</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>tt2074373</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0000019</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Federico Fellini</td>\n",
       "      <td>1920.0</td>\n",
       "      <td>1993.0</td>\n",
       "      <td>writer,director,assistant_director</td>\n",
       "      <td>tt0047528,tt0053779,tt0056801,tt0071129</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>tt2004245</td>\n",
       "      <td>9</td>\n",
       "      <td>nm0000019</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Federico Fellini</td>\n",
       "      <td>1920.0</td>\n",
       "      <td>1993.0</td>\n",
       "      <td>writer,director,assistant_director</td>\n",
       "      <td>tt0047528,tt0053779,tt0056801,tt0071129</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>tt3215046</td>\n",
       "      <td>3</td>\n",
       "      <td>nm0000019</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Federico Fellini</td>\n",
       "      <td>1920.0</td>\n",
       "      <td>1993.0</td>\n",
       "      <td>writer,director,assistant_director</td>\n",
       "      <td>tt0047528,tt0053779,tt0056801,tt0071129</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>tt3774110</td>\n",
       "      <td>9</td>\n",
       "      <td>nm0000022</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Clark Gable</td>\n",
       "      <td>1901.0</td>\n",
       "      <td>1960.0</td>\n",
       "      <td>actor,soundtrack,producer</td>\n",
       "      <td>tt0052278,tt0026752,tt0031381,tt0025316</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>tt10267396</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000023</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Judy Garland</td>\n",
       "      <td>1922.0</td>\n",
       "      <td>1969.0</td>\n",
       "      <td>soundtrack,actress</td>\n",
       "      <td>tt0055031,tt0037059,tt0032138,tt0047522</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>tt3169638</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0000026</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Cary Grant</td>\n",
       "      <td>1904.0</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>actor,soundtrack,producer</td>\n",
       "      <td>tt0048728,tt0053125,tt0032599,tt0056923</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>tt4926886</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0000026</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Cary Grant</td>\n",
       "      <td>1904.0</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>actor,soundtrack,producer</td>\n",
       "      <td>tt0048728,tt0053125,tt0032599,tt0056923</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>tt7171150</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000026</td>\n",
       "      <td>self</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Cary Grant</td>\n",
       "      <td>1904.0</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>actor,soundtrack,producer</td>\n",
       "      <td>tt0048728,tt0053125,tt0032599,tt0056923</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        tconst  ordering     nconst         category  job  \\\n",
       "0    tt2053352         4  nm0000002  archive_footage  NaN   \n",
       "1    tt1626811         4  nm0000002             self  NaN   \n",
       "2    tt0858500         2  nm0000002          actress  NaN   \n",
       "3    tt1368858         1  nm0000002          actress  NaN   \n",
       "4    tt1714820         3  nm0000003  archive_footage  NaN   \n",
       "5    tt2004245         1  nm0000003  archive_footage  NaN   \n",
       "6    tt4323536         3  nm0000003  archive_footage  NaN   \n",
       "7    tt2327430         2  nm0000005  archive_footage  NaN   \n",
       "8    tt2056773         1  nm0000005  archive_footage  NaN   \n",
       "9    tt9209768         1  nm0000005             self  NaN   \n",
       "10   tt8385142         2  nm0000005  archive_footage  NaN   \n",
       "11   tt6109168         1  nm0000005  archive_footage  NaN   \n",
       "12   tt1648206         2  nm0000006  archive_footage  NaN   \n",
       "13   tt4621016         1  nm0000006  archive_footage  NaN   \n",
       "14   tt2388426         1  nm0000006  archive_footage  NaN   \n",
       "15   tt4926886         1  nm0000006  archive_footage  NaN   \n",
       "16   tt7215006         3  nm0000007  archive_footage  NaN   \n",
       "17   tt4145178         1  nm0000008  archive_footage  NaN   \n",
       "18   tt2004245         2  nm0000008  archive_footage  NaN   \n",
       "19   tt5084458         1  nm0000010  archive_footage  NaN   \n",
       "20   tt2246829         6  nm0000016         composer  NaN   \n",
       "21   tt3751664         1  nm0000019  archive_footage  NaN   \n",
       "22   tt2074373         2  nm0000019  archive_footage  NaN   \n",
       "23   tt2004245         9  nm0000019  archive_footage  NaN   \n",
       "24   tt3215046         3  nm0000019  archive_footage  NaN   \n",
       "25   tt3774110         9  nm0000022  archive_footage  NaN   \n",
       "26  tt10267396         1  nm0000023  archive_footage  NaN   \n",
       "27   tt3169638         2  nm0000026  archive_footage  NaN   \n",
       "28   tt4926886         2  nm0000026  archive_footage  NaN   \n",
       "29   tt7171150         1  nm0000026             self  NaN   \n",
       "\n",
       "                   characters      primary_name  birth_year  death_year  \\\n",
       "0                 [\"Herself\"]     Lauren Bacall      1924.0      2014.0   \n",
       "1   [\"Herself - Interviewee\"]     Lauren Bacall      1924.0      2014.0   \n",
       "2                     [\"May\"]     Lauren Bacall      1924.0      2014.0   \n",
       "3              [\"Anne-Marie\"]     Lauren Bacall      1924.0      2014.0   \n",
       "4                 [\"Herself\"]   Brigitte Bardot      1934.0         NaN   \n",
       "5                 [\"Herself\"]   Brigitte Bardot      1934.0         NaN   \n",
       "6                 [\"Herself\"]   Brigitte Bardot      1934.0         NaN   \n",
       "7                 [\"Himself\"]    Ingmar Bergman      1918.0      2007.0   \n",
       "8                         NaN    Ingmar Bergman      1918.0      2007.0   \n",
       "9         [\"Himself (voice)\"]    Ingmar Bergman      1918.0      2007.0   \n",
       "10                [\"Himself\"]    Ingmar Bergman      1918.0      2007.0   \n",
       "11                [\"Himself\"]    Ingmar Bergman      1918.0      2007.0   \n",
       "12                [\"Herself\"]    Ingrid Bergman      1915.0      1982.0   \n",
       "13                [\"Herself\"]    Ingrid Bergman      1915.0      1982.0   \n",
       "14                [\"Herself\"]    Ingrid Bergman      1915.0      1982.0   \n",
       "15                [\"Herself\"]    Ingrid Bergman      1915.0      1982.0   \n",
       "16                [\"Himself\"]   Humphrey Bogart      1899.0      1957.0   \n",
       "17                [\"Himself\"]     Marlon Brando      1924.0      2004.0   \n",
       "18                [\"Himself\"]     Marlon Brando      1924.0      2004.0   \n",
       "19                [\"Himself\"]      James Cagney      1899.0      1986.0   \n",
       "20                        NaN   Georges Delerue      1925.0      1992.0   \n",
       "21                [\"Himself\"]  Federico Fellini      1920.0      1993.0   \n",
       "22                [\"Himself\"]  Federico Fellini      1920.0      1993.0   \n",
       "23                [\"Himself\"]  Federico Fellini      1920.0      1993.0   \n",
       "24                [\"Himself\"]  Federico Fellini      1920.0      1993.0   \n",
       "25                [\"Himself\"]       Clark Gable      1901.0      1960.0   \n",
       "26                [\"Herself\"]      Judy Garland      1922.0      1969.0   \n",
       "27                [\"Himself\"]        Cary Grant      1904.0      1986.0   \n",
       "28                [\"Himself\"]        Cary Grant      1904.0      1986.0   \n",
       "29                [\"Himself\"]        Cary Grant      1904.0      1986.0   \n",
       "\n",
       "                      primary_profession  \\\n",
       "0                     actress,soundtrack   \n",
       "1                     actress,soundtrack   \n",
       "2                     actress,soundtrack   \n",
       "3                     actress,soundtrack   \n",
       "4            actress,soundtrack,producer   \n",
       "5            actress,soundtrack,producer   \n",
       "6            actress,soundtrack,producer   \n",
       "7                  writer,director,actor   \n",
       "8                  writer,director,actor   \n",
       "9                  writer,director,actor   \n",
       "10                 writer,director,actor   \n",
       "11                 writer,director,actor   \n",
       "12           actress,soundtrack,producer   \n",
       "13           actress,soundtrack,producer   \n",
       "14           actress,soundtrack,producer   \n",
       "15           actress,soundtrack,producer   \n",
       "16             actor,soundtrack,producer   \n",
       "17             actor,soundtrack,director   \n",
       "18             actor,soundtrack,director   \n",
       "19             actor,soundtrack,director   \n",
       "20  composer,soundtrack,music_department   \n",
       "21    writer,director,assistant_director   \n",
       "22    writer,director,assistant_director   \n",
       "23    writer,director,assistant_director   \n",
       "24    writer,director,assistant_director   \n",
       "25             actor,soundtrack,producer   \n",
       "26                    soundtrack,actress   \n",
       "27             actor,soundtrack,producer   \n",
       "28             actor,soundtrack,producer   \n",
       "29             actor,soundtrack,producer   \n",
       "\n",
       "                           known_for_titles  \n",
       "0   tt0038355,tt0117057,tt0071877,tt0037382  \n",
       "1   tt0038355,tt0117057,tt0071877,tt0037382  \n",
       "2   tt0038355,tt0117057,tt0071877,tt0037382  \n",
       "3   tt0038355,tt0117057,tt0071877,tt0037382  \n",
       "4   tt0049189,tt0057345,tt0054452,tt0059956  \n",
       "5   tt0049189,tt0057345,tt0054452,tt0059956  \n",
       "6   tt0049189,tt0057345,tt0054452,tt0059956  \n",
       "7   tt0069467,tt0050986,tt0083922,tt0050976  \n",
       "8   tt0069467,tt0050986,tt0083922,tt0050976  \n",
       "9   tt0069467,tt0050986,tt0083922,tt0050976  \n",
       "10  tt0069467,tt0050986,tt0083922,tt0050976  \n",
       "11  tt0069467,tt0050986,tt0083922,tt0050976  \n",
       "12  tt0071877,tt0036855,tt0038109,tt0038787  \n",
       "13  tt0071877,tt0036855,tt0038109,tt0038787  \n",
       "14  tt0071877,tt0036855,tt0038109,tt0038787  \n",
       "15  tt0071877,tt0036855,tt0038109,tt0038787  \n",
       "16  tt0034583,tt0033870,tt0037382,tt0043265  \n",
       "17  tt0078788,tt0070849,tt0047296,tt0068646  \n",
       "18  tt0078788,tt0070849,tt0047296,tt0068646  \n",
       "19  tt0029870,tt0055256,tt0035575,tt0031867  \n",
       "20  tt0091763,tt0080610,tt0069946,tt0096320  \n",
       "21  tt0047528,tt0053779,tt0056801,tt0071129  \n",
       "22  tt0047528,tt0053779,tt0056801,tt0071129  \n",
       "23  tt0047528,tt0053779,tt0056801,tt0071129  \n",
       "24  tt0047528,tt0053779,tt0056801,tt0071129  \n",
       "25  tt0052278,tt0026752,tt0031381,tt0025316  \n",
       "26  tt0055031,tt0037059,tt0032138,tt0047522  \n",
       "27  tt0048728,tt0053125,tt0032599,tt0056923  \n",
       "28  tt0048728,tt0053125,tt0032599,tt0056923  \n",
       "29  tt0048728,tt0053125,tt0032599,tt0056923  "
      ]
     },
     "execution_count": 82,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Merge Principals and Names dataframes to match Unique IDs with actors names; \n",
    "#so every actor name can be matched to a unique tconst movie ID. \n",
    "principals_and_names = pd.merge(\n",
    "    imdb_principals,\n",
    "    imdb_names,\n",
    "    how='inner',\n",
    "    on ='nconst')\n",
    "principals_and_names.head(30)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(946037, 11)"
      ]
     },
     "execution_count": 83,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "principals_and_names.shape\n",
    "#Resultant dataframe smaller"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 84,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 84,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "principals_and_names.duplicated(subset=['tconst', 'nconst']).sum()\n",
    "#No duplicates"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(935020, 11)\n"
     ]
    }
   ],
   "source": [
    "#Now drop all rows that have a value in \"death_year,\" as we want to recommend actors who are still alive. \n",
    "# Get indexes where death_year column has a value\n",
    "principals_and_names = principals_and_names[principals_and_names['death_year'].isna()]\n",
    "print(principals_and_names.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "#Filter out all non-actors and actresses in \"primary_profession\" column. \n",
    "actors = principals_and_names[principals_and_names[\"primary_profession\"].str.contains('actor|actress', na=False)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(447524, 11)"
      ]
     },
     "execution_count": 87,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "actors.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>ordering</th>\n",
       "      <th>nconst</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "      <th>primary_name</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>death_year</th>\n",
       "      <th>primary_profession</th>\n",
       "      <th>known_for_titles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt1714820</td>\n",
       "      <td>3</td>\n",
       "      <td>nm0000003</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Brigitte Bardot</td>\n",
       "      <td>1934.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress,soundtrack,producer</td>\n",
       "      <td>tt0049189,tt0057345,tt0054452,tt0059956</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>tt2004245</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0000003</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Brigitte Bardot</td>\n",
       "      <td>1934.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress,soundtrack,producer</td>\n",
       "      <td>tt0049189,tt0057345,tt0054452,tt0059956</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>tt4323536</td>\n",
       "      <td>3</td>\n",
       "      <td>nm0000003</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Brigitte Bardot</td>\n",
       "      <td>1934.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress,soundtrack,producer</td>\n",
       "      <td>tt0049189,tt0057345,tt0054452,tt0059956</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>51</th>\n",
       "      <td>tt3169638</td>\n",
       "      <td>9</td>\n",
       "      <td>nm0000047</td>\n",
       "      <td>self</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Sophia Loren</td>\n",
       "      <td>1934.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress,soundtrack</td>\n",
       "      <td>tt0054749,tt0076085,tt0060121,tt0058335</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>52</th>\n",
       "      <td>tt5888614</td>\n",
       "      <td>3</td>\n",
       "      <td>nm0000047</td>\n",
       "      <td>self</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Sophia Loren</td>\n",
       "      <td>1934.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress,soundtrack</td>\n",
       "      <td>tt0054749,tt0076085,tt0060121,tt0058335</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       tconst  ordering     nconst         category  job   characters  \\\n",
       "4   tt1714820         3  nm0000003  archive_footage  NaN  [\"Herself\"]   \n",
       "5   tt2004245         1  nm0000003  archive_footage  NaN  [\"Herself\"]   \n",
       "6   tt4323536         3  nm0000003  archive_footage  NaN  [\"Herself\"]   \n",
       "51  tt3169638         9  nm0000047             self  NaN  [\"Herself\"]   \n",
       "52  tt5888614         3  nm0000047             self  NaN  [\"Herself\"]   \n",
       "\n",
       "       primary_name  birth_year  death_year           primary_profession  \\\n",
       "4   Brigitte Bardot      1934.0         NaN  actress,soundtrack,producer   \n",
       "5   Brigitte Bardot      1934.0         NaN  actress,soundtrack,producer   \n",
       "6   Brigitte Bardot      1934.0         NaN  actress,soundtrack,producer   \n",
       "51     Sophia Loren      1934.0         NaN           actress,soundtrack   \n",
       "52     Sophia Loren      1934.0         NaN           actress,soundtrack   \n",
       "\n",
       "                           known_for_titles  \n",
       "4   tt0049189,tt0057345,tt0054452,tt0059956  \n",
       "5   tt0049189,tt0057345,tt0054452,tt0059956  \n",
       "6   tt0049189,tt0057345,tt0054452,tt0059956  \n",
       "51  tt0054749,tt0076085,tt0060121,tt0058335  \n",
       "52  tt0054749,tt0076085,tt0060121,tt0058335  "
      ]
     },
     "execution_count": 88,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "actors.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>ordering</th>\n",
       "      <th>nconst</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "      <th>primary_name</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>death_year</th>\n",
       "      <th>primary_profession</th>\n",
       "      <th>known_for_titles</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>40141</th>\n",
       "      <td>tt6039872</td>\n",
       "      <td>4</td>\n",
       "      <td>nm0111232</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Tom Brokaw</td>\n",
       "      <td>1940.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>writer,producer,actor</td>\n",
       "      <td>tt0436836,tt0231035,tt4005358,tt0103396</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>174802</th>\n",
       "      <td>tt1811381</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0905147</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Narrator\"]</td>\n",
       "      <td>Jutta Wachowiak</td>\n",
       "      <td>1940.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress</td>\n",
       "      <td>tt0232146,tt0081711,tt0091367,tt0219849</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>141903</th>\n",
       "      <td>tt6400222</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0698928</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Gilles Proulx</td>\n",
       "      <td>1940.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actor</td>\n",
       "      <td>tt0832275,tt0211914,tt0070933,tt0110390</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84580</th>\n",
       "      <td>tt1650540</td>\n",
       "      <td>8</td>\n",
       "      <td>nm0359372</td>\n",
       "      <td>self</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Herbie Hancock</td>\n",
       "      <td>1940.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>soundtrack,composer,actor</td>\n",
       "      <td>tt0094894,tt0090557,tt0060176,tt0071402</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>84581</th>\n",
       "      <td>tt3088318</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0359372</td>\n",
       "      <td>self</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Himself\"]</td>\n",
       "      <td>Herbie Hancock</td>\n",
       "      <td>1940.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>soundtrack,composer,actor</td>\n",
       "      <td>tt0094894,tt0090557,tt0060176,tt0071402</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>762422</th>\n",
       "      <td>tt4100182</td>\n",
       "      <td>2</td>\n",
       "      <td>nm6446418</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Guyus\"]</td>\n",
       "      <td>Gaius Lee DuPree</td>\n",
       "      <td>2013.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actor,cinematographer</td>\n",
       "      <td>tt4041788,tt3776720,tt4648810,tt4768296</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>873540</th>\n",
       "      <td>tt6023560</td>\n",
       "      <td>3</td>\n",
       "      <td>nm8405397</td>\n",
       "      <td>archive_footage</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Herself\"]</td>\n",
       "      <td>Indiana Feek</td>\n",
       "      <td>2014.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress</td>\n",
       "      <td>tt4569878,tt8347504</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>220567</th>\n",
       "      <td>tt10360096</td>\n",
       "      <td>3</td>\n",
       "      <td>nm10708650</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Katie\"]</td>\n",
       "      <td>Nayana Niter</td>\n",
       "      <td>2014.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>201836</th>\n",
       "      <td>tt9392402</td>\n",
       "      <td>1</td>\n",
       "      <td>nm10306475</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Buny\"]</td>\n",
       "      <td>Natalye Archiles</td>\n",
       "      <td>2014.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress</td>\n",
       "      <td>tt9392402,tt6877772,tt9396174</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>201835</th>\n",
       "      <td>tt9396174</td>\n",
       "      <td>1</td>\n",
       "      <td>nm10306475</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Monica\"]</td>\n",
       "      <td>Natalye Archiles</td>\n",
       "      <td>2014.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress</td>\n",
       "      <td>tt9392402,tt6877772,tt9396174</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>143431 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            tconst  ordering      nconst         category  job    characters  \\\n",
       "40141    tt6039872         4   nm0111232            actor  NaN           NaN   \n",
       "174802   tt1811381         1   nm0905147          actress  NaN  [\"Narrator\"]   \n",
       "141903   tt6400222         2   nm0698928            actor  NaN           NaN   \n",
       "84580    tt1650540         8   nm0359372             self  NaN   [\"Himself\"]   \n",
       "84581    tt3088318         2   nm0359372             self  NaN   [\"Himself\"]   \n",
       "...            ...       ...         ...              ...  ...           ...   \n",
       "762422   tt4100182         2   nm6446418            actor  NaN     [\"Guyus\"]   \n",
       "873540   tt6023560         3   nm8405397  archive_footage  NaN   [\"Herself\"]   \n",
       "220567  tt10360096         3  nm10708650          actress  NaN     [\"Katie\"]   \n",
       "201836   tt9392402         1  nm10306475          actress  NaN      [\"Buny\"]   \n",
       "201835   tt9396174         1  nm10306475          actress  NaN    [\"Monica\"]   \n",
       "\n",
       "            primary_name  birth_year  death_year         primary_profession  \\\n",
       "40141         Tom Brokaw      1940.0         NaN      writer,producer,actor   \n",
       "174802   Jutta Wachowiak      1940.0         NaN                    actress   \n",
       "141903     Gilles Proulx      1940.0         NaN                      actor   \n",
       "84580     Herbie Hancock      1940.0         NaN  soundtrack,composer,actor   \n",
       "84581     Herbie Hancock      1940.0         NaN  soundtrack,composer,actor   \n",
       "...                  ...         ...         ...                        ...   \n",
       "762422  Gaius Lee DuPree      2013.0         NaN      actor,cinematographer   \n",
       "873540      Indiana Feek      2014.0         NaN                    actress   \n",
       "220567      Nayana Niter      2014.0         NaN                    actress   \n",
       "201836  Natalye Archiles      2014.0         NaN                    actress   \n",
       "201835  Natalye Archiles      2014.0         NaN                    actress   \n",
       "\n",
       "                               known_for_titles  \n",
       "40141   tt0436836,tt0231035,tt4005358,tt0103396  \n",
       "174802  tt0232146,tt0081711,tt0091367,tt0219849  \n",
       "141903  tt0832275,tt0211914,tt0070933,tt0110390  \n",
       "84580   tt0094894,tt0090557,tt0060176,tt0071402  \n",
       "84581   tt0094894,tt0090557,tt0060176,tt0071402  \n",
       "...                                         ...  \n",
       "762422  tt4041788,tt3776720,tt4648810,tt4768296  \n",
       "873540                      tt4569878,tt8347504  \n",
       "220567                                      NaN  \n",
       "201836            tt9392402,tt6877772,tt9396174  \n",
       "201835            tt9392402,tt6877772,tt9396174  \n",
       "\n",
       "[143431 rows x 11 columns]"
      ]
     },
     "execution_count": 89,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Filter out actors born before 1939 (sorry Clint Eastwood)\n",
    "actors = actors[actors['birth_year'] > 1939]\n",
    "actors.sort_values(by=['birth_year'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 90,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Join imdb_ratings and actors dataframe by \"tconst\" column to match movie IDs, actor, and average rating\n",
    "#First, check for duplicates in imdb_ratings\n",
    "imdb_ratings.duplicated().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>ordering</th>\n",
       "      <th>nconst</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "      <th>primary_name</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>death_year</th>\n",
       "      <th>primary_profession</th>\n",
       "      <th>known_for_titles</th>\n",
       "      <th>averagerating</th>\n",
       "      <th>numvotes</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0000084</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Baigujing\",\"White-Boned Demon\"]</td>\n",
       "      <td>Li Gong</td>\n",
       "      <td>1965.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress</td>\n",
       "      <td>tt0101640,tt0397535,tt0430357,tt0473444</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0477209</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Sun Wukong\",\"Monkey King\"]</td>\n",
       "      <td>Aaron Kwok</td>\n",
       "      <td>1965.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actor,soundtrack,music_department</td>\n",
       "      <td>tt4417522,tt0165499,tt0768114,tt1691832</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>3</td>\n",
       "      <td>nm2682046</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Tang Seng\"]</td>\n",
       "      <td>Shaofeng Feng</td>\n",
       "      <td>1978.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actor,producer,miscellaneous</td>\n",
       "      <td>tt2176668,tt2102472,tt2992146,tt2909116</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>4</td>\n",
       "      <td>nm3370295</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Zhu Bajie\"]</td>\n",
       "      <td>Shenyang Xiao</td>\n",
       "      <td>1981.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actor,director</td>\n",
       "      <td>tt1462900,tt4591310,tt5290882,tt8793220</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt1092634</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0000084</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Anna Lan-Ting\"]</td>\n",
       "      <td>Li Gong</td>\n",
       "      <td>1965.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress</td>\n",
       "      <td>tt0101640,tt0397535,tt0430357,tt0473444</td>\n",
       "      <td>6.4</td>\n",
       "      <td>8662</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112896</th>\n",
       "      <td>tt8752420</td>\n",
       "      <td>5</td>\n",
       "      <td>nm9822023</td>\n",
       "      <td>director</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Jorge Tudanca</td>\n",
       "      <td>1999.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>director,writer,actor</td>\n",
       "      <td>tt9361888,tt8752420,tt8382210,tt9784954</td>\n",
       "      <td>8.4</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112897</th>\n",
       "      <td>tt9800694</td>\n",
       "      <td>3</td>\n",
       "      <td>nm9828762</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Temmuz Gürkan Karaca</td>\n",
       "      <td>1987.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actor</td>\n",
       "      <td>tt1795096,tt2247207,tt7932896,tt9800694</td>\n",
       "      <td>5.4</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112898</th>\n",
       "      <td>tt3588492</td>\n",
       "      <td>4</td>\n",
       "      <td>nm9836604</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Serpil\"]</td>\n",
       "      <td>Ebru Ozturk</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress</td>\n",
       "      <td>tt8412590</td>\n",
       "      <td>4.1</td>\n",
       "      <td>176</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112899</th>\n",
       "      <td>tt8478058</td>\n",
       "      <td>2</td>\n",
       "      <td>nm9879092</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"James Howard\"]</td>\n",
       "      <td>Sali</td>\n",
       "      <td>1948.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actor</td>\n",
       "      <td>tt8478058</td>\n",
       "      <td>8.5</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112900</th>\n",
       "      <td>tt8622286</td>\n",
       "      <td>1</td>\n",
       "      <td>nm9936604</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Ujwal Adhikari</td>\n",
       "      <td>1999.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actor,casting_director</td>\n",
       "      <td>tt8275366,tt8622286,tt8967956</td>\n",
       "      <td>6.4</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>112901 rows × 13 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           tconst  ordering     nconst  category  job  \\\n",
       "0       tt4591310         2  nm0000084   actress  NaN   \n",
       "1       tt4591310         1  nm0477209     actor  NaN   \n",
       "2       tt4591310         3  nm2682046     actor  NaN   \n",
       "3       tt4591310         4  nm3370295     actor  NaN   \n",
       "4       tt1092634         2  nm0000084   actress  NaN   \n",
       "...           ...       ...        ...       ...  ...   \n",
       "112896  tt8752420         5  nm9822023  director  NaN   \n",
       "112897  tt9800694         3  nm9828762     actor  NaN   \n",
       "112898  tt3588492         4  nm9836604   actress  NaN   \n",
       "112899  tt8478058         2  nm9879092     actor  NaN   \n",
       "112900  tt8622286         1  nm9936604     actor  NaN   \n",
       "\n",
       "                               characters          primary_name  birth_year  \\\n",
       "0       [\"Baigujing\",\"White-Boned Demon\"]               Li Gong      1965.0   \n",
       "1            [\"Sun Wukong\",\"Monkey King\"]            Aaron Kwok      1965.0   \n",
       "2                           [\"Tang Seng\"]         Shaofeng Feng      1978.0   \n",
       "3                           [\"Zhu Bajie\"]         Shenyang Xiao      1981.0   \n",
       "4                       [\"Anna Lan-Ting\"]               Li Gong      1965.0   \n",
       "...                                   ...                   ...         ...   \n",
       "112896                                NaN         Jorge Tudanca      1999.0   \n",
       "112897                                NaN  Temmuz Gürkan Karaca      1987.0   \n",
       "112898                         [\"Serpil\"]           Ebru Ozturk      1986.0   \n",
       "112899                   [\"James Howard\"]                  Sali      1948.0   \n",
       "112900                                NaN        Ujwal Adhikari      1999.0   \n",
       "\n",
       "        death_year                 primary_profession  \\\n",
       "0              NaN                            actress   \n",
       "1              NaN  actor,soundtrack,music_department   \n",
       "2              NaN       actor,producer,miscellaneous   \n",
       "3              NaN                     actor,director   \n",
       "4              NaN                            actress   \n",
       "...            ...                                ...   \n",
       "112896         NaN              director,writer,actor   \n",
       "112897         NaN                              actor   \n",
       "112898         NaN                            actress   \n",
       "112899         NaN                              actor   \n",
       "112900         NaN             actor,casting_director   \n",
       "\n",
       "                               known_for_titles  averagerating  numvotes  \n",
       "0       tt0101640,tt0397535,tt0430357,tt0473444            6.0      2587  \n",
       "1       tt4417522,tt0165499,tt0768114,tt1691832            6.0      2587  \n",
       "2       tt2176668,tt2102472,tt2992146,tt2909116            6.0      2587  \n",
       "3       tt1462900,tt4591310,tt5290882,tt8793220            6.0      2587  \n",
       "4       tt0101640,tt0397535,tt0430357,tt0473444            6.4      8662  \n",
       "...                                         ...            ...       ...  \n",
       "112896  tt9361888,tt8752420,tt8382210,tt9784954            8.4        10  \n",
       "112897  tt1795096,tt2247207,tt7932896,tt9800694            5.4         7  \n",
       "112898                                tt8412590            4.1       176  \n",
       "112899                                tt8478058            8.5         6  \n",
       "112900            tt8275366,tt8622286,tt8967956            6.4        13  \n",
       "\n",
       "[112901 rows x 13 columns]"
      ]
     },
     "execution_count": 91,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Then, merge: \n",
    "actors_and_ratings = pd.merge(\n",
    "    actors,\n",
    "    imdb_ratings,\n",
    "    how='inner',\n",
    "    on ='tconst')\n",
    "actors_and_ratings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>ordering</th>\n",
       "      <th>nconst</th>\n",
       "      <th>category</th>\n",
       "      <th>job</th>\n",
       "      <th>characters</th>\n",
       "      <th>primary_name</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>death_year</th>\n",
       "      <th>primary_profession</th>\n",
       "      <th>known_for_titles</th>\n",
       "      <th>averagerating</th>\n",
       "      <th>numvotes</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0000084</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Baigujing\",\"White-Boned Demon\"]</td>\n",
       "      <td>Li Gong</td>\n",
       "      <td>1965.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress</td>\n",
       "      <td>tt0101640,tt0397535,tt0430357,tt0473444</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>1</td>\n",
       "      <td>nm0477209</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Sun Wukong\",\"Monkey King\"]</td>\n",
       "      <td>Aaron Kwok</td>\n",
       "      <td>1965.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actor,soundtrack,music_department</td>\n",
       "      <td>tt4417522,tt0165499,tt0768114,tt1691832</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>3</td>\n",
       "      <td>nm2682046</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Tang Seng\"]</td>\n",
       "      <td>Shaofeng Feng</td>\n",
       "      <td>1978.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actor,producer,miscellaneous</td>\n",
       "      <td>tt2176668,tt2102472,tt2992146,tt2909116</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>4</td>\n",
       "      <td>nm3370295</td>\n",
       "      <td>actor</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Zhu Bajie\"]</td>\n",
       "      <td>Shenyang Xiao</td>\n",
       "      <td>1981.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actor,director</td>\n",
       "      <td>tt1462900,tt4591310,tt5290882,tt8793220</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt1092634</td>\n",
       "      <td>2</td>\n",
       "      <td>nm0000084</td>\n",
       "      <td>actress</td>\n",
       "      <td>NaN</td>\n",
       "      <td>[\"Anna Lan-Ting\"]</td>\n",
       "      <td>Li Gong</td>\n",
       "      <td>1965.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>actress</td>\n",
       "      <td>tt0101640,tt0397535,tt0430357,tt0473444</td>\n",
       "      <td>6.4</td>\n",
       "      <td>8662</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      tconst  ordering     nconst category  job  \\\n",
       "0  tt4591310         2  nm0000084  actress  NaN   \n",
       "1  tt4591310         1  nm0477209    actor  NaN   \n",
       "2  tt4591310         3  nm2682046    actor  NaN   \n",
       "3  tt4591310         4  nm3370295    actor  NaN   \n",
       "4  tt1092634         2  nm0000084  actress  NaN   \n",
       "\n",
       "                          characters   primary_name  birth_year  death_year  \\\n",
       "0  [\"Baigujing\",\"White-Boned Demon\"]        Li Gong      1965.0         NaN   \n",
       "1       [\"Sun Wukong\",\"Monkey King\"]     Aaron Kwok      1965.0         NaN   \n",
       "2                      [\"Tang Seng\"]  Shaofeng Feng      1978.0         NaN   \n",
       "3                      [\"Zhu Bajie\"]  Shenyang Xiao      1981.0         NaN   \n",
       "4                  [\"Anna Lan-Ting\"]        Li Gong      1965.0         NaN   \n",
       "\n",
       "                  primary_profession                         known_for_titles  \\\n",
       "0                            actress  tt0101640,tt0397535,tt0430357,tt0473444   \n",
       "1  actor,soundtrack,music_department  tt4417522,tt0165499,tt0768114,tt1691832   \n",
       "2       actor,producer,miscellaneous  tt2176668,tt2102472,tt2992146,tt2909116   \n",
       "3                     actor,director  tt1462900,tt4591310,tt5290882,tt8793220   \n",
       "4                            actress  tt0101640,tt0397535,tt0430357,tt0473444   \n",
       "\n",
       "   averagerating  numvotes  \n",
       "0            6.0      2587  \n",
       "1            6.0      2587  \n",
       "2            6.0      2587  \n",
       "3            6.0      2587  \n",
       "4            6.4      8662  "
      ]
     },
     "execution_count": 92,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Clean up actors_and_ratings columns\n",
    "actors_and_ratings.columns.str.replace(' ', '')\n",
    "actors_and_ratings.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>nconst</th>\n",
       "      <th>category</th>\n",
       "      <th>primary_name</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>primary_profession</th>\n",
       "      <th>averagerating</th>\n",
       "      <th>numvotes</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>nm0000084</td>\n",
       "      <td>actress</td>\n",
       "      <td>Li Gong</td>\n",
       "      <td>1965.0</td>\n",
       "      <td>actress</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>nm0477209</td>\n",
       "      <td>actor</td>\n",
       "      <td>Aaron Kwok</td>\n",
       "      <td>1965.0</td>\n",
       "      <td>actor,soundtrack,music_department</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>nm2682046</td>\n",
       "      <td>actor</td>\n",
       "      <td>Shaofeng Feng</td>\n",
       "      <td>1978.0</td>\n",
       "      <td>actor,producer,miscellaneous</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>nm3370295</td>\n",
       "      <td>actor</td>\n",
       "      <td>Shenyang Xiao</td>\n",
       "      <td>1981.0</td>\n",
       "      <td>actor,director</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt1092634</td>\n",
       "      <td>nm0000084</td>\n",
       "      <td>actress</td>\n",
       "      <td>Li Gong</td>\n",
       "      <td>1965.0</td>\n",
       "      <td>actress</td>\n",
       "      <td>6.4</td>\n",
       "      <td>8662</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112896</th>\n",
       "      <td>tt8752420</td>\n",
       "      <td>nm9822023</td>\n",
       "      <td>director</td>\n",
       "      <td>Jorge Tudanca</td>\n",
       "      <td>1999.0</td>\n",
       "      <td>director,writer,actor</td>\n",
       "      <td>8.4</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112897</th>\n",
       "      <td>tt9800694</td>\n",
       "      <td>nm9828762</td>\n",
       "      <td>actor</td>\n",
       "      <td>Temmuz Gürkan Karaca</td>\n",
       "      <td>1987.0</td>\n",
       "      <td>actor</td>\n",
       "      <td>5.4</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112898</th>\n",
       "      <td>tt3588492</td>\n",
       "      <td>nm9836604</td>\n",
       "      <td>actress</td>\n",
       "      <td>Ebru Ozturk</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>actress</td>\n",
       "      <td>4.1</td>\n",
       "      <td>176</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112899</th>\n",
       "      <td>tt8478058</td>\n",
       "      <td>nm9879092</td>\n",
       "      <td>actor</td>\n",
       "      <td>Sali</td>\n",
       "      <td>1948.0</td>\n",
       "      <td>actor</td>\n",
       "      <td>8.5</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112900</th>\n",
       "      <td>tt8622286</td>\n",
       "      <td>nm9936604</td>\n",
       "      <td>actor</td>\n",
       "      <td>Ujwal Adhikari</td>\n",
       "      <td>1999.0</td>\n",
       "      <td>actor,casting_director</td>\n",
       "      <td>6.4</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>112901 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           tconst     nconst  category          primary_name  birth_year  \\\n",
       "0       tt4591310  nm0000084   actress               Li Gong      1965.0   \n",
       "1       tt4591310  nm0477209     actor            Aaron Kwok      1965.0   \n",
       "2       tt4591310  nm2682046     actor         Shaofeng Feng      1978.0   \n",
       "3       tt4591310  nm3370295     actor         Shenyang Xiao      1981.0   \n",
       "4       tt1092634  nm0000084   actress               Li Gong      1965.0   \n",
       "...           ...        ...       ...                   ...         ...   \n",
       "112896  tt8752420  nm9822023  director         Jorge Tudanca      1999.0   \n",
       "112897  tt9800694  nm9828762     actor  Temmuz Gürkan Karaca      1987.0   \n",
       "112898  tt3588492  nm9836604   actress           Ebru Ozturk      1986.0   \n",
       "112899  tt8478058  nm9879092     actor                  Sali      1948.0   \n",
       "112900  tt8622286  nm9936604     actor        Ujwal Adhikari      1999.0   \n",
       "\n",
       "                       primary_profession  averagerating  numvotes  \n",
       "0                                 actress            6.0      2587  \n",
       "1       actor,soundtrack,music_department            6.0      2587  \n",
       "2            actor,producer,miscellaneous            6.0      2587  \n",
       "3                          actor,director            6.0      2587  \n",
       "4                                 actress            6.4      8662  \n",
       "...                                   ...            ...       ...  \n",
       "112896              director,writer,actor            8.4        10  \n",
       "112897                              actor            5.4         7  \n",
       "112898                            actress            4.1       176  \n",
       "112899                              actor            8.5         6  \n",
       "112900             actor,casting_director            6.4        13  \n",
       "\n",
       "[112901 rows x 8 columns]"
      ]
     },
     "execution_count": 93,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Drop distracting columns\n",
    "actors_and_ratings = actors_and_ratings.drop(['ordering', 'job', 'characters', 'death_year', 'known_for_titles'], axis=1)\n",
    "actors_and_ratings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "object\n"
     ]
    }
   ],
   "source": [
    "print(actors_and_ratings['category'].dtype)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>nconst</th>\n",
       "      <th>category</th>\n",
       "      <th>primary_name</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>primary_profession</th>\n",
       "      <th>averagerating</th>\n",
       "      <th>numvotes</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>nm0000084</td>\n",
       "      <td>actress</td>\n",
       "      <td>Li Gong</td>\n",
       "      <td>1965.0</td>\n",
       "      <td>actress</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>nm0477209</td>\n",
       "      <td>actor</td>\n",
       "      <td>Aaron Kwok</td>\n",
       "      <td>1965.0</td>\n",
       "      <td>actor,soundtrack,music_department</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>nm2682046</td>\n",
       "      <td>actor</td>\n",
       "      <td>Shaofeng Feng</td>\n",
       "      <td>1978.0</td>\n",
       "      <td>actor,producer,miscellaneous</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>tt4591310</td>\n",
       "      <td>nm3370295</td>\n",
       "      <td>actor</td>\n",
       "      <td>Shenyang Xiao</td>\n",
       "      <td>1981.0</td>\n",
       "      <td>actor,director</td>\n",
       "      <td>6.0</td>\n",
       "      <td>2587</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>tt1092634</td>\n",
       "      <td>nm0000084</td>\n",
       "      <td>actress</td>\n",
       "      <td>Li Gong</td>\n",
       "      <td>1965.0</td>\n",
       "      <td>actress</td>\n",
       "      <td>6.4</td>\n",
       "      <td>8662</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112895</th>\n",
       "      <td>tt8262666</td>\n",
       "      <td>nm9758704</td>\n",
       "      <td>actress</td>\n",
       "      <td>Jamie Leo</td>\n",
       "      <td>1999.0</td>\n",
       "      <td>actress</td>\n",
       "      <td>9.1</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112897</th>\n",
       "      <td>tt9800694</td>\n",
       "      <td>nm9828762</td>\n",
       "      <td>actor</td>\n",
       "      <td>Temmuz Gürkan Karaca</td>\n",
       "      <td>1987.0</td>\n",
       "      <td>actor</td>\n",
       "      <td>5.4</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112898</th>\n",
       "      <td>tt3588492</td>\n",
       "      <td>nm9836604</td>\n",
       "      <td>actress</td>\n",
       "      <td>Ebru Ozturk</td>\n",
       "      <td>1986.0</td>\n",
       "      <td>actress</td>\n",
       "      <td>4.1</td>\n",
       "      <td>176</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112899</th>\n",
       "      <td>tt8478058</td>\n",
       "      <td>nm9879092</td>\n",
       "      <td>actor</td>\n",
       "      <td>Sali</td>\n",
       "      <td>1948.0</td>\n",
       "      <td>actor</td>\n",
       "      <td>8.5</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>112900</th>\n",
       "      <td>tt8622286</td>\n",
       "      <td>nm9936604</td>\n",
       "      <td>actor</td>\n",
       "      <td>Ujwal Adhikari</td>\n",
       "      <td>1999.0</td>\n",
       "      <td>actor,casting_director</td>\n",
       "      <td>6.4</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>91402 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           tconst     nconst category          primary_name  birth_year  \\\n",
       "0       tt4591310  nm0000084  actress               Li Gong      1965.0   \n",
       "1       tt4591310  nm0477209    actor            Aaron Kwok      1965.0   \n",
       "2       tt4591310  nm2682046    actor         Shaofeng Feng      1978.0   \n",
       "3       tt4591310  nm3370295    actor         Shenyang Xiao      1981.0   \n",
       "4       tt1092634  nm0000084  actress               Li Gong      1965.0   \n",
       "...           ...        ...      ...                   ...         ...   \n",
       "112895  tt8262666  nm9758704  actress             Jamie Leo      1999.0   \n",
       "112897  tt9800694  nm9828762    actor  Temmuz Gürkan Karaca      1987.0   \n",
       "112898  tt3588492  nm9836604  actress           Ebru Ozturk      1986.0   \n",
       "112899  tt8478058  nm9879092    actor                  Sali      1948.0   \n",
       "112900  tt8622286  nm9936604    actor        Ujwal Adhikari      1999.0   \n",
       "\n",
       "                       primary_profession  averagerating  numvotes  \n",
       "0                                 actress            6.0      2587  \n",
       "1       actor,soundtrack,music_department            6.0      2587  \n",
       "2            actor,producer,miscellaneous            6.0      2587  \n",
       "3                          actor,director            6.0      2587  \n",
       "4                                 actress            6.4      8662  \n",
       "...                                   ...            ...       ...  \n",
       "112895                            actress            9.1         8  \n",
       "112897                              actor            5.4         7  \n",
       "112898                            actress            4.1       176  \n",
       "112899                              actor            8.5         6  \n",
       "112900             actor,casting_director            6.4        13  \n",
       "\n",
       "[91402 rows x 8 columns]"
      ]
     },
     "execution_count": 95,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Filter out rows with anything other than \"actor\" or \"actress\" in \"category\" column. \n",
    "actors_and_ratings = actors_and_ratings[actors_and_ratings[\"category\"].str.contains('actor|actress', na=False)]\n",
    "actors_and_ratings"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Data Modeling"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>nconst</th>\n",
       "      <th>category</th>\n",
       "      <th>primary_name</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>primary_profession</th>\n",
       "      <th>averagerating</th>\n",
       "      <th>numvotes</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1451</th>\n",
       "      <td>tt1375666</td>\n",
       "      <td>nm0330687</td>\n",
       "      <td>actor</td>\n",
       "      <td>Joseph Gordon-Levitt</td>\n",
       "      <td>1981.0</td>\n",
       "      <td>actor,producer,soundtrack</td>\n",
       "      <td>8.8</td>\n",
       "      <td>1841066</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1450</th>\n",
       "      <td>tt1375666</td>\n",
       "      <td>nm0000138</td>\n",
       "      <td>actor</td>\n",
       "      <td>Leonardo DiCaprio</td>\n",
       "      <td>1974.0</td>\n",
       "      <td>actor,producer,writer</td>\n",
       "      <td>8.8</td>\n",
       "      <td>1841066</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1452</th>\n",
       "      <td>tt1375666</td>\n",
       "      <td>nm0680983</td>\n",
       "      <td>actress</td>\n",
       "      <td>Ellen Page</td>\n",
       "      <td>1987.0</td>\n",
       "      <td>actress,producer,soundtrack</td>\n",
       "      <td>8.8</td>\n",
       "      <td>1841066</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3341</th>\n",
       "      <td>tt1345836</td>\n",
       "      <td>nm0004266</td>\n",
       "      <td>actress</td>\n",
       "      <td>Anne Hathaway</td>\n",
       "      <td>1982.0</td>\n",
       "      <td>actress,soundtrack,producer</td>\n",
       "      <td>8.4</td>\n",
       "      <td>1387769</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3339</th>\n",
       "      <td>tt1345836</td>\n",
       "      <td>nm0000198</td>\n",
       "      <td>actor</td>\n",
       "      <td>Gary Oldman</td>\n",
       "      <td>1958.0</td>\n",
       "      <td>actor,soundtrack,producer</td>\n",
       "      <td>8.4</td>\n",
       "      <td>1387769</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45010</th>\n",
       "      <td>tt5592728</td>\n",
       "      <td>nm1560523</td>\n",
       "      <td>actress</td>\n",
       "      <td>Mythili</td>\n",
       "      <td>1990.0</td>\n",
       "      <td>actress,soundtrack</td>\n",
       "      <td>4.6</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45009</th>\n",
       "      <td>tt5592728</td>\n",
       "      <td>nm0558593</td>\n",
       "      <td>actor</td>\n",
       "      <td>Joy Mathew</td>\n",
       "      <td>1961.0</td>\n",
       "      <td>actor,writer,director</td>\n",
       "      <td>4.6</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31981</th>\n",
       "      <td>tt2017703</td>\n",
       "      <td>nm0048273</td>\n",
       "      <td>actress</td>\n",
       "      <td>Blanche Baker</td>\n",
       "      <td>1956.0</td>\n",
       "      <td>actress,writer,producer</td>\n",
       "      <td>8.4</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>111867</th>\n",
       "      <td>tt3546868</td>\n",
       "      <td>nm5658430</td>\n",
       "      <td>actor</td>\n",
       "      <td>Jake Bass</td>\n",
       "      <td>1991.0</td>\n",
       "      <td>actor</td>\n",
       "      <td>9.2</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103300</th>\n",
       "      <td>tt5931020</td>\n",
       "      <td>nm2457083</td>\n",
       "      <td>actress</td>\n",
       "      <td>Elisabeth Baulitz</td>\n",
       "      <td>1973.0</td>\n",
       "      <td>actress</td>\n",
       "      <td>7.8</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>91402 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           tconst     nconst category          primary_name  birth_year  \\\n",
       "1451    tt1375666  nm0330687    actor  Joseph Gordon-Levitt      1981.0   \n",
       "1450    tt1375666  nm0000138    actor     Leonardo DiCaprio      1974.0   \n",
       "1452    tt1375666  nm0680983  actress            Ellen Page      1987.0   \n",
       "3341    tt1345836  nm0004266  actress         Anne Hathaway      1982.0   \n",
       "3339    tt1345836  nm0000198    actor           Gary Oldman      1958.0   \n",
       "...           ...        ...      ...                   ...         ...   \n",
       "45010   tt5592728  nm1560523  actress               Mythili      1990.0   \n",
       "45009   tt5592728  nm0558593    actor            Joy Mathew      1961.0   \n",
       "31981   tt2017703  nm0048273  actress         Blanche Baker      1956.0   \n",
       "111867  tt3546868  nm5658430    actor             Jake Bass      1991.0   \n",
       "103300  tt5931020  nm2457083  actress     Elisabeth Baulitz      1973.0   \n",
       "\n",
       "                 primary_profession  averagerating  numvotes  \n",
       "1451      actor,producer,soundtrack            8.8   1841066  \n",
       "1450          actor,producer,writer            8.8   1841066  \n",
       "1452    actress,producer,soundtrack            8.8   1841066  \n",
       "3341    actress,soundtrack,producer            8.4   1387769  \n",
       "3339      actor,soundtrack,producer            8.4   1387769  \n",
       "...                             ...            ...       ...  \n",
       "45010            actress,soundtrack            4.6         5  \n",
       "45009         actor,writer,director            4.6         5  \n",
       "31981       actress,writer,producer            8.4         5  \n",
       "111867                        actor            9.2         5  \n",
       "103300                      actress            7.8         5  \n",
       "\n",
       "[91402 rows x 8 columns]"
      ]
     },
     "execution_count": 96,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Average rating is not the only metric of concern. We have some very highly rated performances \n",
    "#that probably won't draw as many crowds because the actors are not popular (for example, Jake Bass, below). \n",
    "#I'll create a new column called rating-popularity that multiplies the average rating x the number of votes \n",
    "#the performance received, thus serving as a primitive metric for how popular AND how highly rated the performance was. \n",
    "actors_and_ratings.sort_values(by=['numvotes'],ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 97,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-97-b3585c45e334>:1: SettingWithCopyWarning: \n",
      "A value is trying to be set on a copy of a slice from a DataFrame.\n",
      "Try using .loc[row_indexer,col_indexer] = value instead\n",
      "\n",
      "See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy\n",
      "  actors_and_ratings['popularity_&_rating'] = actors_and_ratings['averagerating'] * actors_and_ratings['numvotes']\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>tconst</th>\n",
       "      <th>nconst</th>\n",
       "      <th>category</th>\n",
       "      <th>primary_name</th>\n",
       "      <th>birth_year</th>\n",
       "      <th>primary_profession</th>\n",
       "      <th>averagerating</th>\n",
       "      <th>numvotes</th>\n",
       "      <th>popularity_&amp;_rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1450</th>\n",
       "      <td>tt1375666</td>\n",
       "      <td>nm0000138</td>\n",
       "      <td>actor</td>\n",
       "      <td>Leonardo DiCaprio</td>\n",
       "      <td>1974.0</td>\n",
       "      <td>actor,producer,writer</td>\n",
       "      <td>8.8</td>\n",
       "      <td>1841066</td>\n",
       "      <td>16201380.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1452</th>\n",
       "      <td>tt1375666</td>\n",
       "      <td>nm0680983</td>\n",
       "      <td>actress</td>\n",
       "      <td>Ellen Page</td>\n",
       "      <td>1987.0</td>\n",
       "      <td>actress,producer,soundtrack</td>\n",
       "      <td>8.8</td>\n",
       "      <td>1841066</td>\n",
       "      <td>16201380.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1451</th>\n",
       "      <td>tt1375666</td>\n",
       "      <td>nm0330687</td>\n",
       "      <td>actor</td>\n",
       "      <td>Joseph Gordon-Levitt</td>\n",
       "      <td>1981.0</td>\n",
       "      <td>actor,producer,soundtrack</td>\n",
       "      <td>8.8</td>\n",
       "      <td>1841066</td>\n",
       "      <td>16201380.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3340</th>\n",
       "      <td>tt1345836</td>\n",
       "      <td>nm0000288</td>\n",
       "      <td>actor</td>\n",
       "      <td>Christian Bale</td>\n",
       "      <td>1974.0</td>\n",
       "      <td>actor,editorial_department,producer</td>\n",
       "      <td>8.4</td>\n",
       "      <td>1387769</td>\n",
       "      <td>11657259.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3339</th>\n",
       "      <td>tt1345836</td>\n",
       "      <td>nm0000198</td>\n",
       "      <td>actor</td>\n",
       "      <td>Gary Oldman</td>\n",
       "      <td>1958.0</td>\n",
       "      <td>actor,soundtrack,producer</td>\n",
       "      <td>8.4</td>\n",
       "      <td>1387769</td>\n",
       "      <td>11657259.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77524</th>\n",
       "      <td>tt6792126</td>\n",
       "      <td>nm2511348</td>\n",
       "      <td>actress</td>\n",
       "      <td>Anna Kulovaná</td>\n",
       "      <td>1981.0</td>\n",
       "      <td>actress</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77525</th>\n",
       "      <td>tt6792126</td>\n",
       "      <td>nm4153825</td>\n",
       "      <td>actor</td>\n",
       "      <td>Petr Batek</td>\n",
       "      <td>1972.0</td>\n",
       "      <td>actor</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42531</th>\n",
       "      <td>tt8446392</td>\n",
       "      <td>nm0129648</td>\n",
       "      <td>actress</td>\n",
       "      <td>Nathalie Caldonazzo</td>\n",
       "      <td>1969.0</td>\n",
       "      <td>actress</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77522</th>\n",
       "      <td>tt6792126</td>\n",
       "      <td>nm0603184</td>\n",
       "      <td>actress</td>\n",
       "      <td>Dana Morávková</td>\n",
       "      <td>1971.0</td>\n",
       "      <td>actress,soundtrack,miscellaneous</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77523</th>\n",
       "      <td>tt6792126</td>\n",
       "      <td>nm1551077</td>\n",
       "      <td>actor</td>\n",
       "      <td>Ladislav Ondrej</td>\n",
       "      <td>1991.0</td>\n",
       "      <td>actor</td>\n",
       "      <td>1.0</td>\n",
       "      <td>5</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>91402 rows × 9 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          tconst     nconst category          primary_name  birth_year  \\\n",
       "1450   tt1375666  nm0000138    actor     Leonardo DiCaprio      1974.0   \n",
       "1452   tt1375666  nm0680983  actress            Ellen Page      1987.0   \n",
       "1451   tt1375666  nm0330687    actor  Joseph Gordon-Levitt      1981.0   \n",
       "3340   tt1345836  nm0000288    actor        Christian Bale      1974.0   \n",
       "3339   tt1345836  nm0000198    actor           Gary Oldman      1958.0   \n",
       "...          ...        ...      ...                   ...         ...   \n",
       "77524  tt6792126  nm2511348  actress         Anna Kulovaná      1981.0   \n",
       "77525  tt6792126  nm4153825    actor            Petr Batek      1972.0   \n",
       "42531  tt8446392  nm0129648  actress   Nathalie Caldonazzo      1969.0   \n",
       "77522  tt6792126  nm0603184  actress        Dana Morávková      1971.0   \n",
       "77523  tt6792126  nm1551077    actor       Ladislav Ondrej      1991.0   \n",
       "\n",
       "                        primary_profession  averagerating  numvotes  \\\n",
       "1450                 actor,producer,writer            8.8   1841066   \n",
       "1452           actress,producer,soundtrack            8.8   1841066   \n",
       "1451             actor,producer,soundtrack            8.8   1841066   \n",
       "3340   actor,editorial_department,producer            8.4   1387769   \n",
       "3339             actor,soundtrack,producer            8.4   1387769   \n",
       "...                                    ...            ...       ...   \n",
       "77524                              actress            1.0         5   \n",
       "77525                                actor            1.0         5   \n",
       "42531                              actress            1.0         5   \n",
       "77522     actress,soundtrack,miscellaneous            1.0         5   \n",
       "77523                                actor            1.0         5   \n",
       "\n",
       "       popularity_&_rating  \n",
       "1450            16201380.8  \n",
       "1452            16201380.8  \n",
       "1451            16201380.8  \n",
       "3340            11657259.6  \n",
       "3339            11657259.6  \n",
       "...                    ...  \n",
       "77524                  5.0  \n",
       "77525                  5.0  \n",
       "42531                  5.0  \n",
       "77522                  5.0  \n",
       "77523                  5.0  \n",
       "\n",
       "[91402 rows x 9 columns]"
      ]
     },
     "execution_count": 97,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "actors_and_ratings['popularity_&_rating'] = actors_and_ratings['averagerating'] * actors_and_ratings['numvotes']\n",
    "actors_and_ratings.sort_values(by=['popularity_&_rating'],ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 98,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>primary_name</th>\n",
       "      <th>popularity_&amp;_rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1450</th>\n",
       "      <td>Leonardo DiCaprio</td>\n",
       "      <td>16201380.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1452</th>\n",
       "      <td>Ellen Page</td>\n",
       "      <td>16201380.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1451</th>\n",
       "      <td>Joseph Gordon-Levitt</td>\n",
       "      <td>16201380.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3340</th>\n",
       "      <td>Christian Bale</td>\n",
       "      <td>11657259.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3339</th>\n",
       "      <td>Gary Oldman</td>\n",
       "      <td>11657259.6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77524</th>\n",
       "      <td>Anna Kulovaná</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77525</th>\n",
       "      <td>Petr Batek</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42531</th>\n",
       "      <td>Nathalie Caldonazzo</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77522</th>\n",
       "      <td>Dana Morávková</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>77523</th>\n",
       "      <td>Ladislav Ondrej</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>91402 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "               primary_name  popularity_&_rating\n",
       "1450      Leonardo DiCaprio           16201380.8\n",
       "1452             Ellen Page           16201380.8\n",
       "1451   Joseph Gordon-Levitt           16201380.8\n",
       "3340         Christian Bale           11657259.6\n",
       "3339            Gary Oldman           11657259.6\n",
       "...                     ...                  ...\n",
       "77524         Anna Kulovaná                  5.0\n",
       "77525            Petr Batek                  5.0\n",
       "42531   Nathalie Caldonazzo                  5.0\n",
       "77522        Dana Morávková                  5.0\n",
       "77523       Ladislav Ondrej                  5.0\n",
       "\n",
       "[91402 rows x 2 columns]"
      ]
     },
     "execution_count": 98,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Drop unnecessary columns to prepare to groupby\n",
    "simple_actors_and_ratings = actors_and_ratings.drop(['tconst','nconst','category','birth_year','primary_profession','averagerating','numvotes'], axis=1)\n",
    "simple_actors_and_ratings.sort_values(by=['popularity_&_rating'],ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 102,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pop_and_reviews</th>\n",
       "      <th>count</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>primary_name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Leonardo DiCaprio</th>\n",
       "      <td>5199703.07</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Idina Menzel</th>\n",
       "      <td>3877485.00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Robert Downey Jr.</th>\n",
       "      <td>3751983.99</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Lucy Davis</th>\n",
       "      <td>3656452.50</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Daniel Kaluuya</th>\n",
       "      <td>3083649.80</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ying-Hsuan Kao</th>\n",
       "      <td>6.00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Nathalie Caldonazzo</th>\n",
       "      <td>5.00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ladislav Ondrej</th>\n",
       "      <td>5.00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Petr Batek</th>\n",
       "      <td>5.00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Anna Kulovaná</th>\n",
       "      <td>5.00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>31868 rows × 2 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                     pop_and_reviews  count\n",
       "primary_name                               \n",
       "Leonardo DiCaprio         5199703.07     10\n",
       "Idina Menzel              3877485.00      1\n",
       "Robert Downey Jr.         3751983.99     13\n",
       "Lucy Davis                3656452.50      1\n",
       "Daniel Kaluuya            3083649.80      1\n",
       "...                              ...    ...\n",
       "Ying-Hsuan Kao                  6.00      1\n",
       "Nathalie Caldonazzo             5.00      1\n",
       "Ladislav Ondrej                 5.00      1\n",
       "Petr Batek                      5.00      1\n",
       "Anna Kulovaná                   5.00      1\n",
       "\n",
       "[31868 rows x 2 columns]"
      ]
     },
     "execution_count": 102,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#The top 5 actors above are most likely all at the top because they were in Inception \n",
    "#We need to aggregate by average rating to take into account number of movies an actor has been in, \n",
    "#So the data is not skewed towards actors who have been in a single megahit movie like Inception. \n",
    "# Group by nconst and then get name later on; merge on nconst \n",
    "actors_ranking = simple_actors_and_ratings.groupby(by=['primary_name']).agg(['mean','count'],as_index=False)\n",
    "actors_ranking = actors_ranking.rename(columns={'mean':'pop_and_reviews','count':'count'})\n",
    "actors_ranking.columns = actors_ranking.columns.droplevel(0)\n",
    "actors_ranking = actors_ranking.sort_values(by=['pop_and_reviews'],ascending=False)\n",
    "actors_ranking"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 103,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Our list above is now aggregated by average rating and popular rating. Truncating to two bullets:  \n",
    "pd.set_option('display.float_format', lambda x: '%.2f' % x)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>pop_and_reviews</th>\n",
       "      <th>count</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>primary_name</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Leonardo DiCaprio</th>\n",
       "      <td>5199703.07</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Idina Menzel</th>\n",
       "      <td>3877485.00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Robert Downey Jr.</th>\n",
       "      <td>3751983.99</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Lucy Davis</th>\n",
       "      <td>3656452.50</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Daniel Kaluuya</th>\n",
       "      <td>3083649.80</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Donna Murphy</th>\n",
       "      <td>2857654.80</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ben Hardy</th>\n",
       "      <td>2763728.00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Alison Sudol</th>\n",
       "      <td>2667076.90</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Kerry Washington</th>\n",
       "      <td>2605709.48</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Kieran Culkin</th>\n",
       "      <td>2545035.00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Scarlett Johansson</th>\n",
       "      <td>2506390.70</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Jeremy Renner</th>\n",
       "      <td>2438556.91</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Vin Diesel</th>\n",
       "      <td>2415180.42</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Amanda Bynes</th>\n",
       "      <td>2343887.50</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Tyrese Gibson</th>\n",
       "      <td>2271735.80</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Rosie Huntington-Whiteley</th>\n",
       "      <td>2271735.80</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Chris Hemsworth</th>\n",
       "      <td>2263450.31</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Lena Waithe</th>\n",
       "      <td>2262450.00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Joseph Gordon-Levitt</th>\n",
       "      <td>2258167.17</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mark Ruffalo</th>\n",
       "      <td>2226894.24</td>\n",
       "      <td>17</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Andy Serkis</th>\n",
       "      <td>2184118.14</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ruby Rose</th>\n",
       "      <td>2175397.50</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Jared Leto</th>\n",
       "      <td>2173015.00</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Bradley Cooper</th>\n",
       "      <td>2135746.14</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Jamie Foxx</th>\n",
       "      <td>2135107.41</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Christian Bale</th>\n",
       "      <td>2129516.09</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Jenna Elfman</th>\n",
       "      <td>2094430.80</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Albert Brooks</th>\n",
       "      <td>2059102.40</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Mark Rylance</th>\n",
       "      <td>2042862.80</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Annika Wedderkopp</th>\n",
       "      <td>2014949.50</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                           pop_and_reviews  count\n",
       "primary_name                                     \n",
       "Leonardo DiCaprio               5199703.07     10\n",
       "Idina Menzel                    3877485.00      1\n",
       "Robert Downey Jr.               3751983.99     13\n",
       "Lucy Davis                      3656452.50      1\n",
       "Daniel Kaluuya                  3083649.80      1\n",
       "Donna Murphy                    2857654.80      1\n",
       "Ben Hardy                       2763728.00      1\n",
       "Alison Sudol                    2667076.90      1\n",
       "Kerry Washington                2605709.48      4\n",
       "Kieran Culkin                   2545035.00      1\n",
       "Scarlett Johansson              2506390.70     13\n",
       "Jeremy Renner                   2438556.91     11\n",
       "Vin Diesel                      2415180.42      9\n",
       "Amanda Bynes                    2343887.50      1\n",
       "Tyrese Gibson                   2271735.80      1\n",
       "Rosie Huntington-Whiteley       2271735.80      1\n",
       "Chris Hemsworth                 2263450.31     16\n",
       "Lena Waithe                     2262450.00      1\n",
       "Joseph Gordon-Levitt            2258167.17     13\n",
       "Mark Ruffalo                    2226894.24     17\n",
       "Andy Serkis                     2184118.14      7\n",
       "Ruby Rose                       2175397.50      1\n",
       "Jared Leto                      2173015.00      3\n",
       "Bradley Cooper                  2135746.14     16\n",
       "Jamie Foxx                      2135107.41      8\n",
       "Christian Bale                  2129516.09     11\n",
       "Jenna Elfman                    2094430.80      1\n",
       "Albert Brooks                   2059102.40      3\n",
       "Mark Rylance                    2042862.80      3\n",
       "Annika Wedderkopp               2014949.50      1"
      ]
     },
     "execution_count": 105,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Selecting only the top 30 actors based on our performance rating above (average reviews x popularity)\n",
    "top_30 = actors_ranking.head(30)\n",
    "top_30"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Importing CSV of net worth for 30 top actors - this will be our rough stand-in for the relative \"cost\" of hiring an actor. \n",
    "top30_networth = pd.read_csv('data/zippedData/top30_networth.csv')\n",
    "top30_networth = top30_networth.drop(columns = ['Unnamed: 2'], axis = 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 115,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>primary_name</th>\n",
       "      <th>pop_and_reviews</th>\n",
       "      <th>est_net_worth</th>\n",
       "      <th>performance_rating</th>\n",
       "      <th>cost_rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Leonardo DiCaprio</td>\n",
       "      <td>5199703.07</td>\n",
       "      <td>260000000</td>\n",
       "      <td>5.20</td>\n",
       "      <td>260</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Idina Menzel</td>\n",
       "      <td>3877485.00</td>\n",
       "      <td>16000000</td>\n",
       "      <td>3.88</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Robert Downey Jr.</td>\n",
       "      <td>3751983.99</td>\n",
       "      <td>300000000</td>\n",
       "      <td>3.75</td>\n",
       "      <td>300</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Lucy Davis</td>\n",
       "      <td>3656452.50</td>\n",
       "      <td>3000000</td>\n",
       "      <td>3.66</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Daniel Kaluuya</td>\n",
       "      <td>3083649.80</td>\n",
       "      <td>1000000</td>\n",
       "      <td>3.08</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>Donna Murphy</td>\n",
       "      <td>2857654.80</td>\n",
       "      <td>3000000</td>\n",
       "      <td>2.86</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>Ben Hardy</td>\n",
       "      <td>2763728.00</td>\n",
       "      <td>4000000</td>\n",
       "      <td>2.76</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Alison Sudol</td>\n",
       "      <td>2667076.90</td>\n",
       "      <td>2000000</td>\n",
       "      <td>2.67</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>Kerry Washington</td>\n",
       "      <td>2605709.48</td>\n",
       "      <td>55000000</td>\n",
       "      <td>2.61</td>\n",
       "      <td>55</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>Kieran Culkin</td>\n",
       "      <td>2545035.00</td>\n",
       "      <td>5000000</td>\n",
       "      <td>2.55</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>Scarlett Johansson</td>\n",
       "      <td>2506390.70</td>\n",
       "      <td>165000000</td>\n",
       "      <td>2.51</td>\n",
       "      <td>165</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>Jeremy Renner</td>\n",
       "      <td>2438556.91</td>\n",
       "      <td>80000000</td>\n",
       "      <td>2.44</td>\n",
       "      <td>80</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>Vin Diesel</td>\n",
       "      <td>2415180.42</td>\n",
       "      <td>225000000</td>\n",
       "      <td>2.42</td>\n",
       "      <td>225</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>Amanda Bynes</td>\n",
       "      <td>2343887.50</td>\n",
       "      <td>3000000</td>\n",
       "      <td>2.34</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>Tyrese Gibson</td>\n",
       "      <td>2271735.80</td>\n",
       "      <td>3000000</td>\n",
       "      <td>2.27</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Rosie Huntington-Whiteley</td>\n",
       "      <td>2271735.80</td>\n",
       "      <td>30000000</td>\n",
       "      <td>2.27</td>\n",
       "      <td>30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>Chris Hemsworth</td>\n",
       "      <td>2263450.31</td>\n",
       "      <td>130000000</td>\n",
       "      <td>2.26</td>\n",
       "      <td>130</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>Lena Waithe</td>\n",
       "      <td>2262450.00</td>\n",
       "      <td>9000000</td>\n",
       "      <td>2.26</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>Joseph Gordon-Levitt</td>\n",
       "      <td>2258167.17</td>\n",
       "      <td>35000000</td>\n",
       "      <td>2.26</td>\n",
       "      <td>35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Mark Ruffalo</td>\n",
       "      <td>2226894.24</td>\n",
       "      <td>35000000</td>\n",
       "      <td>2.23</td>\n",
       "      <td>35</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Andy Serkis</td>\n",
       "      <td>2184118.14</td>\n",
       "      <td>28000000</td>\n",
       "      <td>2.18</td>\n",
       "      <td>28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Ruby Rose</td>\n",
       "      <td>2175397.50</td>\n",
       "      <td>2000000</td>\n",
       "      <td>2.18</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Jared Leto</td>\n",
       "      <td>2173015.00</td>\n",
       "      <td>90000000</td>\n",
       "      <td>2.17</td>\n",
       "      <td>90</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>Bradley Cooper</td>\n",
       "      <td>2135746.14</td>\n",
       "      <td>100000000</td>\n",
       "      <td>2.14</td>\n",
       "      <td>100</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>Jamie Foxx</td>\n",
       "      <td>2135107.41</td>\n",
       "      <td>150000000</td>\n",
       "      <td>2.14</td>\n",
       "      <td>150</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Christian Bale</td>\n",
       "      <td>2129516.09</td>\n",
       "      <td>120000000</td>\n",
       "      <td>2.13</td>\n",
       "      <td>120</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>Jenna Elfman</td>\n",
       "      <td>2094430.80</td>\n",
       "      <td>12000000</td>\n",
       "      <td>2.09</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>Albert Brooks</td>\n",
       "      <td>2059102.40</td>\n",
       "      <td>28000000</td>\n",
       "      <td>2.06</td>\n",
       "      <td>28</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>Mark Rylance</td>\n",
       "      <td>2042862.80</td>\n",
       "      <td>10000000</td>\n",
       "      <td>2.04</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>Annika Wedderkopp</td>\n",
       "      <td>2014949.50</td>\n",
       "      <td>100000</td>\n",
       "      <td>2.01</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                 primary_name  pop_and_reviews  est_net_worth  \\\n",
       "0           Leonardo DiCaprio       5199703.07      260000000   \n",
       "1                Idina Menzel       3877485.00       16000000   \n",
       "2           Robert Downey Jr.       3751983.99      300000000   \n",
       "3                  Lucy Davis       3656452.50        3000000   \n",
       "4              Daniel Kaluuya       3083649.80        1000000   \n",
       "5                Donna Murphy       2857654.80        3000000   \n",
       "6                   Ben Hardy       2763728.00        4000000   \n",
       "7                Alison Sudol       2667076.90        2000000   \n",
       "8            Kerry Washington       2605709.48       55000000   \n",
       "9               Kieran Culkin       2545035.00        5000000   \n",
       "10         Scarlett Johansson       2506390.70      165000000   \n",
       "11              Jeremy Renner       2438556.91       80000000   \n",
       "12                 Vin Diesel       2415180.42      225000000   \n",
       "13               Amanda Bynes       2343887.50        3000000   \n",
       "14              Tyrese Gibson       2271735.80        3000000   \n",
       "15  Rosie Huntington-Whiteley       2271735.80       30000000   \n",
       "16            Chris Hemsworth       2263450.31      130000000   \n",
       "17                Lena Waithe       2262450.00        9000000   \n",
       "18       Joseph Gordon-Levitt       2258167.17       35000000   \n",
       "19               Mark Ruffalo       2226894.24       35000000   \n",
       "20                Andy Serkis       2184118.14       28000000   \n",
       "21                  Ruby Rose       2175397.50        2000000   \n",
       "22                 Jared Leto       2173015.00       90000000   \n",
       "23             Bradley Cooper       2135746.14      100000000   \n",
       "24                 Jamie Foxx       2135107.41      150000000   \n",
       "25             Christian Bale       2129516.09      120000000   \n",
       "26               Jenna Elfman       2094430.80       12000000   \n",
       "27              Albert Brooks       2059102.40       28000000   \n",
       "28               Mark Rylance       2042862.80       10000000   \n",
       "29          Annika Wedderkopp       2014949.50         100000   \n",
       "\n",
       "    performance_rating  cost_rating  \n",
       "0                 5.20          260  \n",
       "1                 3.88           16  \n",
       "2                 3.75          300  \n",
       "3                 3.66            3  \n",
       "4                 3.08            1  \n",
       "5                 2.86            3  \n",
       "6                 2.76            4  \n",
       "7                 2.67            2  \n",
       "8                 2.61           55  \n",
       "9                 2.55            5  \n",
       "10                2.51          165  \n",
       "11                2.44           80  \n",
       "12                2.42          225  \n",
       "13                2.34            3  \n",
       "14                2.27            3  \n",
       "15                2.27           30  \n",
       "16                2.26          130  \n",
       "17                2.26            9  \n",
       "18                2.26           35  \n",
       "19                2.23           35  \n",
       "20                2.18           28  \n",
       "21                2.18            2  \n",
       "22                2.17           90  \n",
       "23                2.14          100  \n",
       "24                2.14          150  \n",
       "25                2.13          120  \n",
       "26                2.09           12  \n",
       "27                2.06           28  \n",
       "28                2.04           10  \n",
       "29                2.01            0  "
      ]
     },
     "execution_count": 115,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Joining actor performance dataframe to net worth dataframe\n",
    "top_30_join = pd.merge(\n",
    "    top_30,\n",
    "    top30_networth,\n",
    "    how='inner',\n",
    "    on ='primary_name')\n",
    "top_30_join = top_30_join.drop(columns = ['count'], axis =1)\n",
    "top_30_join['performance_rating'] = top_30_join['pop_and_reviews']/1000000\n",
    "top_30_join['cost_rating'] = top_30_join['est_net_worth']/1000000\n",
    "top_30_join['cost_rating'] = top_30_join['cost_rating'].astype(int)\n",
    "top_30_join = top_30_join.round({'performance_rating':2})\n",
    "top_30_join"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "application/vnd.plotly.v1+json": {
       "config": {
        "plotlyServerURL": "https://plot.ly"
       },
       "data": [
        {
         "hovertemplate": "<b>%{hovertext}</b><br><br>Cost Rating=%{x}<br>Performance Rating=%{y}<extra></extra>",
         "hovertext": [
          "Leonardo DiCaprio",
          "Idina Menzel",
          "Robert Downey Jr.",
          "Lucy Davis",
          "Daniel Kaluuya",
          "Donna Murphy",
          "Ben Hardy",
          "Alison Sudol",
          "Kerry Washington",
          "Kieran Culkin",
          "Scarlett Johansson",
          "Jeremy Renner",
          "Vin Diesel",
          "Amanda Bynes",
          "Tyrese Gibson",
          "Rosie Huntington-Whiteley",
          "Chris Hemsworth",
          "Lena Waithe",
          "Joseph Gordon-Levitt",
          "Mark Ruffalo",
          "Andy Serkis",
          "Ruby Rose",
          "Jared Leto",
          "Bradley Cooper",
          "Jamie Foxx",
          "Christian Bale",
          "Jenna Elfman",
          "Albert Brooks",
          "Mark Rylance",
          "Annika Wedderkopp"
         ],
         "legendgroup": "",
         "marker": {
          "color": "#636efa",
          "size": 9,
          "symbol": "circle"
         },
         "mode": "markers",
         "name": "",
         "orientation": "v",
         "showlegend": false,
         "type": "scatter",
         "x": [
          260,
          16,
          300,
          3,
          1,
          3,
          4,
          2,
          55,
          5,
          165,
          80,
          225,
          3,
          3,
          30,
          130,
          9,
          35,
          35,
          28,
          2,
          90,
          100,
          150,
          120,
          12,
          28,
          10,
          0
         ],
         "xaxis": "x",
         "y": [
          5.2,
          3.88,
          3.75,
          3.66,
          3.08,
          2.86,
          2.76,
          2.67,
          2.61,
          2.55,
          2.51,
          2.44,
          2.42,
          2.34,
          2.27,
          2.27,
          2.26,
          2.26,
          2.26,
          2.23,
          2.18,
          2.18,
          2.17,
          2.14,
          2.14,
          2.13,
          2.09,
          2.06,
          2.04,
          2.01
         ],
         "yaxis": "y"
        }
       ],
       "layout": {
        "grid": {
         "ygap": 0.2
        },
        "legend": {
         "tracegroupgap": 0
        },
        "margin": {
         "t": 60
        },
        "template": {
         "data": {
          "bar": [
           {
            "error_x": {
             "color": "#2a3f5f"
            },
            "error_y": {
             "color": "#2a3f5f"
            },
            "marker": {
             "line": {
              "color": "#E5ECF6",
              "width": 0.5
             }
            },
            "type": "bar"
           }
          ],
          "barpolar": [
           {
            "marker": {
             "line": {
              "color": "#E5ECF6",
              "width": 0.5
             }
            },
            "type": "barpolar"
           }
          ],
          "carpet": [
           {
            "aaxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "white",
             "linecolor": "white",
             "minorgridcolor": "white",
             "startlinecolor": "#2a3f5f"
            },
            "baxis": {
             "endlinecolor": "#2a3f5f",
             "gridcolor": "white",
             "linecolor": "white",
             "minorgridcolor": "white",
             "startlinecolor": "#2a3f5f"
            },
            "type": "carpet"
           }
          ],
          "choropleth": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "choropleth"
           }
          ],
          "contour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "contour"
           }
          ],
          "contourcarpet": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "contourcarpet"
           }
          ],
          "heatmap": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmap"
           }
          ],
          "heatmapgl": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "heatmapgl"
           }
          ],
          "histogram": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "histogram"
           }
          ],
          "histogram2d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2d"
           }
          ],
          "histogram2dcontour": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "histogram2dcontour"
           }
          ],
          "mesh3d": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "type": "mesh3d"
           }
          ],
          "parcoords": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "parcoords"
           }
          ],
          "pie": [
           {
            "automargin": true,
            "type": "pie"
           }
          ],
          "scatter": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatter"
           }
          ],
          "scatter3d": [
           {
            "line": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatter3d"
           }
          ],
          "scattercarpet": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattercarpet"
           }
          ],
          "scattergeo": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergeo"
           }
          ],
          "scattergl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattergl"
           }
          ],
          "scattermapbox": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scattermapbox"
           }
          ],
          "scatterpolar": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolar"
           }
          ],
          "scatterpolargl": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterpolargl"
           }
          ],
          "scatterternary": [
           {
            "marker": {
             "colorbar": {
              "outlinewidth": 0,
              "ticks": ""
             }
            },
            "type": "scatterternary"
           }
          ],
          "surface": [
           {
            "colorbar": {
             "outlinewidth": 0,
             "ticks": ""
            },
            "colorscale": [
             [
              0,
              "#0d0887"
             ],
             [
              0.1111111111111111,
              "#46039f"
             ],
             [
              0.2222222222222222,
              "#7201a8"
             ],
             [
              0.3333333333333333,
              "#9c179e"
             ],
             [
              0.4444444444444444,
              "#bd3786"
             ],
             [
              0.5555555555555556,
              "#d8576b"
             ],
             [
              0.6666666666666666,
              "#ed7953"
             ],
             [
              0.7777777777777778,
              "#fb9f3a"
             ],
             [
              0.8888888888888888,
              "#fdca26"
             ],
             [
              1,
              "#f0f921"
             ]
            ],
            "type": "surface"
           }
          ],
          "table": [
           {
            "cells": {
             "fill": {
              "color": "#EBF0F8"
             },
             "line": {
              "color": "white"
             }
            },
            "header": {
             "fill": {
              "color": "#C8D4E3"
             },
             "line": {
              "color": "white"
             }
            },
            "type": "table"
           }
          ]
         },
         "layout": {
          "annotationdefaults": {
           "arrowcolor": "#2a3f5f",
           "arrowhead": 0,
           "arrowwidth": 1
          },
          "coloraxis": {
           "colorbar": {
            "outlinewidth": 0,
            "ticks": ""
           }
          },
          "colorscale": {
           "diverging": [
            [
             0,
             "#8e0152"
            ],
            [
             0.1,
             "#c51b7d"
            ],
            [
             0.2,
             "#de77ae"
            ],
            [
             0.3,
             "#f1b6da"
            ],
            [
             0.4,
             "#fde0ef"
            ],
            [
             0.5,
             "#f7f7f7"
            ],
            [
             0.6,
             "#e6f5d0"
            ],
            [
             0.7,
             "#b8e186"
            ],
            [
             0.8,
             "#7fbc41"
            ],
            [
             0.9,
             "#4d9221"
            ],
            [
             1,
             "#276419"
            ]
           ],
           "sequential": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ],
           "sequentialminus": [
            [
             0,
             "#0d0887"
            ],
            [
             0.1111111111111111,
             "#46039f"
            ],
            [
             0.2222222222222222,
             "#7201a8"
            ],
            [
             0.3333333333333333,
             "#9c179e"
            ],
            [
             0.4444444444444444,
             "#bd3786"
            ],
            [
             0.5555555555555556,
             "#d8576b"
            ],
            [
             0.6666666666666666,
             "#ed7953"
            ],
            [
             0.7777777777777778,
             "#fb9f3a"
            ],
            [
             0.8888888888888888,
             "#fdca26"
            ],
            [
             1,
             "#f0f921"
            ]
           ]
          },
          "colorway": [
           "#636efa",
           "#EF553B",
           "#00cc96",
           "#ab63fa",
           "#FFA15A",
           "#19d3f3",
           "#FF6692",
           "#B6E880",
           "#FF97FF",
           "#FECB52"
          ],
          "font": {
           "color": "#2a3f5f"
          },
          "geo": {
           "bgcolor": "white",
           "lakecolor": "white",
           "landcolor": "#E5ECF6",
           "showlakes": true,
           "showland": true,
           "subunitcolor": "white"
          },
          "hoverlabel": {
           "align": "left"
          },
          "hovermode": "closest",
          "mapbox": {
           "style": "light"
          },
          "paper_bgcolor": "white",
          "plot_bgcolor": "#E5ECF6",
          "polar": {
           "angularaxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           },
           "bgcolor": "#E5ECF6",
           "radialaxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           }
          },
          "scene": {
           "xaxis": {
            "backgroundcolor": "#E5ECF6",
            "gridcolor": "white",
            "gridwidth": 2,
            "linecolor": "white",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "white"
           },
           "yaxis": {
            "backgroundcolor": "#E5ECF6",
            "gridcolor": "white",
            "gridwidth": 2,
            "linecolor": "white",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "white"
           },
           "zaxis": {
            "backgroundcolor": "#E5ECF6",
            "gridcolor": "white",
            "gridwidth": 2,
            "linecolor": "white",
            "showbackground": true,
            "ticks": "",
            "zerolinecolor": "white"
           }
          },
          "shapedefaults": {
           "line": {
            "color": "#2a3f5f"
           }
          },
          "ternary": {
           "aaxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           },
           "baxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           },
           "bgcolor": "#E5ECF6",
           "caxis": {
            "gridcolor": "white",
            "linecolor": "white",
            "ticks": ""
           }
          },
          "title": {
           "x": 0.05
          },
          "xaxis": {
           "automargin": true,
           "gridcolor": "white",
           "linecolor": "white",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "white",
           "zerolinewidth": 2
          },
          "yaxis": {
           "automargin": true,
           "gridcolor": "white",
           "linecolor": "white",
           "ticks": "",
           "title": {
            "standoff": 15
           },
           "zerolinecolor": "white",
           "zerolinewidth": 2
          }
         }
        },
        "title": {
         "text": "Performance vs. Cost, for Top 30 Actors",
         "x": 0.5,
         "xanchor": "center",
         "y": 0.95,
         "yanchor": "top"
        },
        "xaxis": {
         "anchor": "y",
         "domain": [
          0,
          1
         ],
         "title": {
          "text": "Cost Rating"
         }
        },
        "yaxis": {
         "anchor": "x",
         "domain": [
          0,
          1
         ],
         "title": {
          "text": "Performance Rating"
         }
        }
       }
      },
      "text/html": [
       "<div>                            <div id=\"afdb074e-98ec-4a15-a9ad-82633c01a695\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"afdb074e-98ec-4a15-a9ad-82633c01a695\")) {                    Plotly.newPlot(                        \"afdb074e-98ec-4a15-a9ad-82633c01a695\",                        [{\"hovertemplate\": \"<b>%{hovertext}</b><br><br>Cost Rating=%{x}<br>Performance Rating=%{y}<extra></extra>\", \"hovertext\": [\"Leonardo DiCaprio\", \"Idina Menzel\", \"Robert Downey Jr.\", \"Lucy Davis\", \"Daniel Kaluuya\", \"Donna Murphy\", \"Ben Hardy\", \"Alison Sudol\", \"Kerry Washington\", \"Kieran Culkin\", \"Scarlett Johansson\", \"Jeremy Renner\", \"Vin Diesel\", \"Amanda Bynes\", \"Tyrese Gibson\", \"Rosie Huntington-Whiteley\", \"Chris Hemsworth\", \"Lena Waithe\", \"Joseph Gordon-Levitt\", \"Mark Ruffalo\", \"Andy Serkis\", \"Ruby Rose\", \"Jared Leto\", \"Bradley Cooper\", \"Jamie Foxx\", \"Christian Bale\", \"Jenna Elfman\", \"Albert Brooks\", \"Mark Rylance\", \"Annika Wedderkopp\"], \"legendgroup\": \"\", \"marker\": {\"color\": \"#636efa\", \"size\": 9, \"symbol\": \"circle\"}, \"mode\": \"markers\", \"name\": \"\", \"orientation\": \"v\", \"showlegend\": false, \"type\": \"scatter\", \"x\": [260, 16, 300, 3, 1, 3, 4, 2, 55, 5, 165, 80, 225, 3, 3, 30, 130, 9, 35, 35, 28, 2, 90, 100, 150, 120, 12, 28, 10, 0], \"xaxis\": \"x\", \"y\": [5.2, 3.88, 3.75, 3.66, 3.08, 2.86, 2.76, 2.67, 2.61, 2.55, 2.51, 2.44, 2.42, 2.34, 2.27, 2.27, 2.26, 2.26, 2.26, 2.23, 2.18, 2.18, 2.17, 2.14, 2.14, 2.13, 2.09, 2.06, 2.04, 2.01], \"yaxis\": \"y\"}],                        {\"grid\": {\"ygap\": 0.2}, \"legend\": {\"tracegroupgap\": 0}, \"margin\": {\"t\": 60}, \"template\": {\"data\": {\"bar\": [{\"error_x\": {\"color\": \"#2a3f5f\"}, \"error_y\": {\"color\": \"#2a3f5f\"}, \"marker\": {\"line\": {\"color\": \"#E5ECF6\", \"width\": 0.5}}, \"type\": \"bar\"}], \"barpolar\": [{\"marker\": {\"line\": {\"color\": \"#E5ECF6\", \"width\": 0.5}}, \"type\": \"barpolar\"}], \"carpet\": [{\"aaxis\": {\"endlinecolor\": \"#2a3f5f\", \"gridcolor\": \"white\", \"linecolor\": \"white\", \"minorgridcolor\": \"white\", \"startlinecolor\": \"#2a3f5f\"}, \"baxis\": {\"endlinecolor\": \"#2a3f5f\", \"gridcolor\": \"white\", \"linecolor\": \"white\", \"minorgridcolor\": \"white\", \"startlinecolor\": \"#2a3f5f\"}, \"type\": \"carpet\"}], \"choropleth\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"type\": \"choropleth\"}], \"contour\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"contour\"}], \"contourcarpet\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"type\": \"contourcarpet\"}], \"heatmap\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"heatmap\"}], \"heatmapgl\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"heatmapgl\"}], \"histogram\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"histogram\"}], \"histogram2d\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"histogram2d\"}], \"histogram2dcontour\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"histogram2dcontour\"}], \"mesh3d\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"type\": \"mesh3d\"}], \"parcoords\": [{\"line\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"parcoords\"}], \"pie\": [{\"automargin\": true, \"type\": \"pie\"}], \"scatter\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatter\"}], \"scatter3d\": [{\"line\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatter3d\"}], \"scattercarpet\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scattercarpet\"}], \"scattergeo\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scattergeo\"}], \"scattergl\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scattergl\"}], \"scattermapbox\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scattermapbox\"}], \"scatterpolar\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatterpolar\"}], \"scatterpolargl\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatterpolargl\"}], \"scatterternary\": [{\"marker\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"type\": \"scatterternary\"}], \"surface\": [{\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}, \"colorscale\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"type\": \"surface\"}], \"table\": [{\"cells\": {\"fill\": {\"color\": \"#EBF0F8\"}, \"line\": {\"color\": \"white\"}}, \"header\": {\"fill\": {\"color\": \"#C8D4E3\"}, \"line\": {\"color\": \"white\"}}, \"type\": \"table\"}]}, \"layout\": {\"annotationdefaults\": {\"arrowcolor\": \"#2a3f5f\", \"arrowhead\": 0, \"arrowwidth\": 1}, \"coloraxis\": {\"colorbar\": {\"outlinewidth\": 0, \"ticks\": \"\"}}, \"colorscale\": {\"diverging\": [[0, \"#8e0152\"], [0.1, \"#c51b7d\"], [0.2, \"#de77ae\"], [0.3, \"#f1b6da\"], [0.4, \"#fde0ef\"], [0.5, \"#f7f7f7\"], [0.6, \"#e6f5d0\"], [0.7, \"#b8e186\"], [0.8, \"#7fbc41\"], [0.9, \"#4d9221\"], [1, \"#276419\"]], \"sequential\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]], \"sequentialminus\": [[0.0, \"#0d0887\"], [0.1111111111111111, \"#46039f\"], [0.2222222222222222, \"#7201a8\"], [0.3333333333333333, \"#9c179e\"], [0.4444444444444444, \"#bd3786\"], [0.5555555555555556, \"#d8576b\"], [0.6666666666666666, \"#ed7953\"], [0.7777777777777778, \"#fb9f3a\"], [0.8888888888888888, \"#fdca26\"], [1.0, \"#f0f921\"]]}, \"colorway\": [\"#636efa\", \"#EF553B\", \"#00cc96\", \"#ab63fa\", \"#FFA15A\", \"#19d3f3\", \"#FF6692\", \"#B6E880\", \"#FF97FF\", \"#FECB52\"], \"font\": {\"color\": \"#2a3f5f\"}, \"geo\": {\"bgcolor\": \"white\", \"lakecolor\": \"white\", \"landcolor\": \"#E5ECF6\", \"showlakes\": true, \"showland\": true, \"subunitcolor\": \"white\"}, \"hoverlabel\": {\"align\": \"left\"}, \"hovermode\": \"closest\", \"mapbox\": {\"style\": \"light\"}, \"paper_bgcolor\": \"white\", \"plot_bgcolor\": \"#E5ECF6\", \"polar\": {\"angularaxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}, \"bgcolor\": \"#E5ECF6\", \"radialaxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}}, \"scene\": {\"xaxis\": {\"backgroundcolor\": \"#E5ECF6\", \"gridcolor\": \"white\", \"gridwidth\": 2, \"linecolor\": \"white\", \"showbackground\": true, \"ticks\": \"\", \"zerolinecolor\": \"white\"}, \"yaxis\": {\"backgroundcolor\": \"#E5ECF6\", \"gridcolor\": \"white\", \"gridwidth\": 2, \"linecolor\": \"white\", \"showbackground\": true, \"ticks\": \"\", \"zerolinecolor\": \"white\"}, \"zaxis\": {\"backgroundcolor\": \"#E5ECF6\", \"gridcolor\": \"white\", \"gridwidth\": 2, \"linecolor\": \"white\", \"showbackground\": true, \"ticks\": \"\", \"zerolinecolor\": \"white\"}}, \"shapedefaults\": {\"line\": {\"color\": \"#2a3f5f\"}}, \"ternary\": {\"aaxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}, \"baxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}, \"bgcolor\": \"#E5ECF6\", \"caxis\": {\"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\"}}, \"title\": {\"x\": 0.05}, \"xaxis\": {\"automargin\": true, \"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\", \"title\": {\"standoff\": 15}, \"zerolinecolor\": \"white\", \"zerolinewidth\": 2}, \"yaxis\": {\"automargin\": true, \"gridcolor\": \"white\", \"linecolor\": \"white\", \"ticks\": \"\", \"title\": {\"standoff\": 15}, \"zerolinecolor\": \"white\", \"zerolinewidth\": 2}}}, \"title\": {\"text\": \"Performance vs. Cost, for Top 30 Actors\", \"x\": 0.5, \"xanchor\": \"center\", \"y\": 0.95, \"yanchor\": \"top\"}, \"xaxis\": {\"anchor\": \"y\", \"domain\": [0.0, 1.0], \"title\": {\"text\": \"Cost Rating\"}}, \"yaxis\": {\"anchor\": \"x\", \"domain\": [0.0, 1.0], \"title\": {\"text\": \"Performance Rating\"}}},                        {\"responsive\": true}                    ).then(function(){\n",
       "                            \n",
       "var gd = document.getElementById('afdb074e-98ec-4a15-a9ad-82633c01a695');\n",
       "var x = new MutationObserver(function (mutations, observer) {{\n",
       "        var display = window.getComputedStyle(gd).display;\n",
       "        if (!display || display === 'none') {{\n",
       "            console.log([gd, 'removed!']);\n",
       "            Plotly.purge(gd);\n",
       "            observer.disconnect();\n",
       "        }}\n",
       "}});\n",
       "\n",
       "// Listen for the removal of the full notebook cells\n",
       "var notebookContainer = gd.closest('#notebook-container');\n",
       "if (notebookContainer) {{\n",
       "    x.observe(notebookContainer, {childList: true});\n",
       "}}\n",
       "\n",
       "// Listen for the clearing of the current output cell\n",
       "var outputEl = gd.closest('.output');\n",
       "if (outputEl) {{\n",
       "    x.observe(outputEl, {childList: true});\n",
       "}}\n",
       "\n",
       "                        })                };                });            </script>        </div>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "#Plotting cost vs. performance ratings for top 30 actors. \n",
    "import plotly.express as px\n",
    "\n",
    "fig = px.scatter(top_30_join, x=\"cost_rating\", y=\"performance_rating\",\n",
    "                 hover_name=\"primary_name\",labels=dict(performance_rating=\"Performance Rating\", cost_rating=\"Cost Rating\"))\n",
    "\n",
    "fig.update_layout(\n",
    "    title={\n",
    "        'text': \"Performance vs. Cost, for Top 30 Actors\",\n",
    "        'y':0.95,\n",
    "        'x':0.5,\n",
    "        'xanchor': 'center',\n",
    "        'yanchor': 'top'})\n",
    "\n",
    "fig.update_layout(grid_ygap=0.2)\n",
    "\n",
    "#fig.update_xaxes(\n",
    "    #constrain=\"domain\",  # meanwhile compresses the xaxis by decreasing its \"domain\"\n",
    "\n",
    "\n",
    "#fig.update_yaxes(\n",
    "    #scaleanchor = \"x\",\n",
    "    #scaleratio = 1\n",
    "                \n",
    "fig.update_traces(marker_size=9, selector=dict(type='scatter'))\n",
    "\n",
    "fig.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Analysis and Recommendations \n",
    "As displayed in the above plot, there are indeed several prominent, \"big name\" celebrities--also highly rated--that Microsoft, if name recognition is a priority, could opt to hire. Leonardo DiCaprio is the most highly-rated actor in the Top 30 with a performance rating of 5.20 and Robert Downey, Jr. at 3.75. If Microsoft is intending to produce a big-budget Adventure or Sci-Fi blockbuster (as discussed in Recommendation 2), and cost is a secondary consideration, hiring one of these more high-profile actors, both of whom have previous experience completing work in the Adventure genre. \n",
    "\n",
    "However, if budget remains an important factor, I would encourage Microsoft to consider those actors whom are perhaps not as high-profile, but nevertheless whom rated fairly highly in our model. For example, the actress Idina Menzel was rated a 3.88 on our performance scale (almost as high as Leo, and higher than Robert Downey, Jr.), while having a cost rating of 16, versus DiCaprio's and Downey's ratings of 300+. Lucy Davis' performances were rated as near-comparable at 3.66, and her cost rating of 3 is even more budget-friendly. Daniel Kuluuya's performances were rated higher than both Vin Diesel and Scarlett Johansson, while maintaining one of the lowest cost ratings at 1 (by comparison, Scarlett Johannson and Vin Diesel's cost ratings were both over 100). Donna Murphy, Ben Hardy, Alison Sudol, Kieran Culkin were also identified in the model as having performances that were more highly-rated and popular than prominent actors such as Jamie Foxx, Chris Hemsworth, and Christian Bale. \n",
    "\n",
    "I recommend that Microsoft consider actors like the above, who, although less prominent, may represent better \"return-on-investment\" than more prominent actors who may be far more costly to hire. \n",
    "\n",
    "Further analysis would help identify a broader pool of actors (such as the top 50 or 100) that would help Microsoft diversity its talent pool to accommodate different film genres. In addition, the model could be refined to further take into account the advantage of some actors' starring in several highly popular movies, which could have an outsize affect on their popularity ratings. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Conclusions and Recommendations\n",
    "This analysis leads to three recommendations for Microsoft executives: \n",
    "* **Consider timing releases for off-peak months that still show signs of above-average audience turnout,** such as the months of February and September. This will help Microsoft circumvent some of the competition from other studios during the \"cluster\" months, while also providing opportunities for their products to enjoy above-average popularity. \n",
    "* **If startup funding is a significant pain point, consider lower-budget movie genres such as family and musical films,** which tend to earn above-average worldwide gross earnings and are generally known to be cheaper to produce. \n",
    "* **Look beyond big-name actors** and engage in recruiting from a pool of lesser-known talent that have the potential to appeal to both mainstream audiences and film critics. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Evaluation and Next Steps\n",
    "The above models utilized the most wide-ranging film-related datasets publicly available, and the results would most likely generalize beyond the data used in this particular dataset. \n",
    "\n",
    "These models are reliable because they  reflect widely-accepted trends in the film industry (e.g., films released during the holidays are more popular; adventure films are higher-grossing than documentaries; Leonardo DiCaprio is a highly-rated actor). \n",
    "\n",
    "However, these models are also useful for Microsoft because they also uncover windows of opportunity for executives to maximize profit and/or minimize cost--for example, releasing movies in the promising month of February, or hiring lower-profile but high-potential actors. \n",
    "\n",
    "As stated in each of the three analysis sections, further analysis could provide opportunities for:\n",
    "1. More insight into seasonal release trends and their potential impacts on films' popularity;\n",
    "2. Deeper understanding of the start-up costs and competitition related to each film genre;\n",
    "3. A wider pool of high-potential actors for Microsoft producers to consider. "
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
